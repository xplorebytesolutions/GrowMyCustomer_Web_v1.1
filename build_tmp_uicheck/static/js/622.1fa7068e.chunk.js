"use strict";(self.webpackChunkxbytechat_ui=self.webpackChunkxbytechat_ui||[]).push([[622],{59622:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var a=s(65043),l=s(29350),r=s(40614),n=s(57488),d=s(35870),o=s(89379),i=s(70579);function c(e){let{selectedTag:t,onSaveComplete:s,onCancel:r}=e;const[c,m]=(0,a.useState)(!1),[x,u]=(0,a.useState)({id:null,name:"",colorHex:"",category:"",notes:"",isSystemTag:!1,isActive:!0}),g=!!t;(0,a.useEffect)((()=>{u(t?{id:t.id,name:t.name||"",colorHex:t.colorHex||"",category:t.category||"",notes:t.notes||"",isSystemTag:!!t.isSystemTag,isActive:!1!==t.isActive}:{id:null,name:"",colorHex:"",category:"",notes:"",isSystemTag:!1,isActive:!0})}),[t]);const h=e=>{const{name:t,value:s,type:a,checked:l}=e.target;u((e=>(0,o.A)((0,o.A)({},e),{},{[t]:"checkbox"===a?l:s})))},p=x.name.trim().length>0;return(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!x.name.trim())return void n.oR.warn("Tag name is required.");const t={name:x.name.trim(),colorHex:x.colorHex||null,category:x.category||null,notes:x.notes||null,isSystemTag:x.isSystemTag,isActive:x.isActive};try{m(!0),x.id?(await d.default.put("/tags/".concat(x.id),t),null===s||void 0===s||s(!0,"Tag updated successfully.")):(await d.default.post("/tags",t),null===s||void 0===s||s(!0,"Tag created successfully."))}catch(a){console.error("\u274c Failed to save tag",a),n.oR.error("Failed to save tag. Please try again."),null===s||void 0===s||s(!1,"Failed to save tag.")}finally{m(!1)}},className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[(0,i.jsx)("div",{className:"bg-emerald-50 text-emerald-700 rounded-xl p-2",children:(0,i.jsx)(l.A,{size:20})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-sm font-semibold text-emerald-900",children:g?"Edit tag":"Create new tag"}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:"Tags help you group contacts for campaigns, CRM, and inbox filters."})]})]}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{className:"text-xs font-medium text-gray-700 mb-1 block",children:["Tag name ",(0,i.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,i.jsx)("input",{type:"text",name:"name",value:x.name,onChange:h,placeholder:'e.g. "Promotional", "Hot Lead", "College"',className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-1 block",children:"Tag colour (hex)"}),(0,i.jsx)("input",{type:"text",name:"colorHex",value:x.colorHex,onChange:h,placeholder:"#22C55E",className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-emerald-400"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-1 block",children:"Category"}),(0,i.jsx)("input",{type:"text",name:"category",value:x.category,onChange:h,placeholder:'e.g. "Journey", "Priority"',className:"w-full px-3 py-2 border rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-emerald-400"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-1 block",children:"Notes (internal)"}),(0,i.jsx)("textarea",{name:"notes",value:x.notes,onChange:h,rows:3,placeholder:"Short note for your team...",className:"w-full px-3 py-2 border rounded-md text-sm resize-none focus:outline-none focus:ring-1 focus:ring-emerald-400"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[(0,i.jsxs)("label",{className:"flex items-center gap-2",children:[(0,i.jsx)("input",{type:"checkbox",name:"isSystemTag",checked:x.isSystemTag,onChange:h}),"System tag"]}),(0,i.jsxs)("label",{className:"flex items-center gap-2",children:[(0,i.jsx)("input",{type:"checkbox",name:"isActive",checked:x.isActive,onChange:h}),"Active"]})]})]}),(0,i.jsxs)("div",{className:"pt-3 mt-1 border-t border-gray-100 flex justify-end gap-2",children:[(0,i.jsx)("button",{type:"button",onClick:r,className:"px-3 py-1.5 rounded-md text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200",children:"Cancel"}),(0,i.jsx)("button",{type:"submit",disabled:!p||c,className:"px-4 py-1.5 rounded-md text-xs font-semibold text-white inline-flex items-center justify-center ".concat(p&&!c?"bg-emerald-600 hover:bg-emerald-700":"bg-emerald-300 cursor-not-allowed"),children:c?"Saving...":g?"Save changes":"Create tag"})]})]})}var m=s(71360),x=s(65505),u=s(9855);function g(e){if(!e)return"-";try{return new Date(e).toLocaleDateString()}catch(t){return"-"}}function h(e){if(!e)return"rgba(16,185,129,0.12)";return/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(e)?"".concat(e,"22"):"rgba(16,185,129,0.12)"}function p(e){let{tags:t=null,loading:s=null,searchTerm:o="",refreshKey:p,onDeleteComplete:b,showHeader:f=!0,noContainer:y=!1,containerClassName:j="max-w-4xl mx-auto"}=e;const[v,N]=(0,a.useState)([]),[w,C]=(0,a.useState)(!1),[S,A]=(0,a.useState)(!1),[T,k]=(0,a.useState)(null),R="boolean"===typeof s?s:w,H=Array.isArray(t)?t:v,L=async()=>{if(!Array.isArray(t)){C(!0);try{const e=function(e){var t;return Array.isArray(null===e||void 0===e?void 0:e.data)?e.data:Array.isArray(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data)?e.data.data:[]}(await d.default.get("/tags"));N(e)}catch(e){console.error(e),n.oR.error("Failed to load tags"),N([])}finally{C(!1)}}};(0,a.useEffect)((()=>{L()}),[p]);const z=(0,a.useMemo)((()=>{const e=(o||"").toLowerCase().trim();return e?H.filter((t=>{const s=(t.name||"").toLowerCase(),a=(t.category||"").toLowerCase();return s.includes(e)||a.includes(e)})):H}),[H,o]),F=()=>{k(null),A(!0)},D=()=>{A(!1),k(null)},E=e=>{let{label:t="Create"}=e;return(0,i.jsxs)("button",{type:"button",onClick:F,className:"inline-flex items-center gap-2 px-4 py-2.5 rounded-md text-sm font-semibold\r bg-emerald-700 text-white hover:bg-emerald-800 shadow-sm",children:[(0,i.jsx)(m.A,{size:16}),t]})},M=f&&!y,P=R?(0,i.jsx)("div",{className:"px-6 py-10 text-sm text-slate-500",children:"Loading tags\u2026"}):z.length?(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"w-full text-sm table-fixed",children:[(0,i.jsx)("thead",{className:"bg-emerald-50 text-[11px] uppercase tracking-wide text-emerald-700",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-6 py-3 text-left font-semibold w-[34%]",children:"Tag"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left font-semibold w-[20%]",children:"Category"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left font-semibold w-[16%]",children:"Type"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left font-semibold w-[18%]",children:"Created"}),(0,i.jsx)("th",{className:"px-6 py-3 text-right font-semibold w-[12%]",children:"Actions"})]})}),(0,i.jsx)("tbody",{className:"divide-y divide-slate-100",children:z.map((e=>(0,i.jsxs)("tr",{className:"hover:bg-emerald-50/30 transition-colors",children:[(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold",style:{background:h(e.colorHex),color:"#0f172a",border:"1px solid rgba(15,23,42,0.06)"},children:e.name})})}),(0,i.jsx)("td",{className:"px-6 py-4",children:e.category?(0,i.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-md text-[11px] font-semibold bg-slate-100 text-slate-700",children:e.category}):(0,i.jsx)("span",{className:"text-slate-400",children:"\u2014"})}),(0,i.jsx)("td",{className:"px-6 py-4",children:e.isSystemTag?(0,i.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-md text-[11px] font-semibold bg-amber-50 text-amber-700 border border-amber-200",children:"System"}):(0,i.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-md text-[11px] font-semibold bg-emerald-50 text-emerald-700 border border-emerald-200",children:"Custom"})}),(0,i.jsx)("td",{className:"px-6 py-4 text-slate-700",children:g(e.createdAt)}),(0,i.jsx)("td",{className:"px-6 py-4",children:(0,i.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,i.jsx)("button",{type:"button",title:"Edit",onClick:()=>(e=>{k(e),A(!0)})(e),className:"p-2 rounded-md text-emerald-700 hover:bg-emerald-50",children:(0,i.jsx)(x.A,{size:16})}),(0,i.jsx)("button",{type:"button",title:"Delete",onClick:()=>(async e=>{if(window.confirm("Delete this tag?"))try{await d.default.delete("/tags/".concat(e)),n.oR.success("Tag deleted"),L(),null===b||void 0===b||b(!0)}catch(t){console.error(t),n.oR.error("Failed to delete tag"),null===b||void 0===b||b(!1)}})(e.id),className:"p-2 rounded-md text-red-600 hover:bg-red-50",children:(0,i.jsx)(u.A,{size:16})})]})})]},e.id)))})]})}):(0,i.jsxs)("div",{className:"px-6 py-14 flex flex-col items-center text-center",children:[(0,i.jsx)("div",{className:"w-12 h-12 rounded-md bg-emerald-50 text-emerald-700 flex items-center justify-center mb-3",children:(0,i.jsx)(l.A,{size:20})}),(0,i.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"No tags created yet"}),(0,i.jsx)("p",{className:"text-xs text-slate-500 mt-1 max-w-sm",children:"Create your first tag to segment contacts and power Inbox CRM actions."}),(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsx)(E,{label:"Create your first tag"})})]}),I=y?P:(0,i.jsxs)("div",{className:"bg-white rounded-md border border-slate-100 shadow-sm overflow-hidden",children:[M&&(0,i.jsx)("div",{className:"px-6 py-5 border-b border-slate-100",children:(0,i.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,i.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"Tag Library"}),(0,i.jsx)("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-[11px] font-semibold bg-emerald-50 text-emerald-700 border border-emerald-200",children:"Guide"})]}),(0,i.jsx)("p",{className:"text-xs text-slate-500 mt-1 max-w-2xl",children:"Keep tags short and consistent. You\u2019ll reuse them in Contacts and the Inbox CRM side panel."}),(0,i.jsx)("div",{className:"mt-3 text-xs text-slate-500",children:R?"Loading\u2026":"".concat(z.length," tag(s)")})]}),(0,i.jsx)(E,{})]})}),P]});return(0,i.jsxs)("div",{className:j,children:[I,S&&(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm",children:(0,i.jsxs)("div",{className:"bg-white rounded-md shadow-xl w-full max-w-md mx-4 relative",children:[(0,i.jsx)("button",{type:"button",onClick:D,className:"absolute right-3 top-3 text-slate-400 hover:text-slate-600","aria-label":"Close",children:(0,i.jsx)(r.A,{size:18})}),(0,i.jsx)("div",{className:"p-5",children:(0,i.jsx)(c,{selectedTag:T,onSaveComplete:function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?(L(),n.oR.success(e||(T?"Tag updated":"Tag created"))):n.oR.error(e||"Failed to save tag"),D()},onCancel:D})})]})})]})}function b(){const[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(!1),[m,x]=(0,a.useState)(""),[u,g]=(0,a.useState)("all"),[h,b]=(0,a.useState)(""),[f,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null),N=async()=>{o(!0);try{const e=await d.default.get("/tags");t(function(e){var t;return Array.isArray(null===e||void 0===e?void 0:e.data)?e.data:Array.isArray(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data)?e.data.data:[]}(e))}catch(e){console.error(e),n.oR.error("Failed to load tags"),t([])}finally{o(!1)}};(0,a.useEffect)((()=>{N()}),[]);const w=(0,a.useMemo)((()=>{const t=new Set;return e.forEach((e=>{e.category&&t.add(e.category)})),Array.from(t).sort()}),[e]),C=(0,a.useMemo)((()=>{const t=m.trim().toLowerCase();return e.filter((e=>{if("system"===u&&!e.isSystemTag)return!1;if("custom"===u&&e.isSystemTag)return!1;if(h&&(e.category||"")!==h)return!1;const s=(e.name||"").toLowerCase(),a=(e.category||"").toLowerCase();return!t||(s.includes(t)||a.includes(t))}))}),[e,m,u,h]),S=()=>{v(null),y(!0)},A=()=>{y(!1),v(null)};return(0,i.jsxs)("div",{className:"min-h-[calc(100vh-80px)] bg-[#f5f6f7]",children:[(0,i.jsxs)("div",{className:"max-w-6xl mx-auto px-6 pt-10 pb-8",children:[(0,i.jsx)("div",{className:"mb-4 flex items-center justify-between gap-4",children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-9 h-9 rounded-md bg-emerald-50 text-emerald-700 flex items-center justify-center",children:(0,i.jsx)(l.A,{size:17})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Tags"}),(0,i.jsx)("p",{className:"text-xs text-slate-600 mt-0.5",children:"Create reusable labels to segment contacts and automate WhatsApp journeys."})]})]})}),(0,i.jsxs)("div",{className:"mb-5 bg-emerald-50/70 border border-emerald-100 rounded-md px-5 py-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,i.jsxs)("div",{className:"text-sm text-slate-800",children:[(0,i.jsx)("div",{className:"font-semibold text-emerald-900",children:"Pro tip: keep tags simple and reusable"}),(0,i.jsxs)("div",{className:"mt-1 text-xs text-slate-700 space-y-0.5",children:[(0,i.jsx)("div",{children:"Use tags to capture intent and journeys (e.g. \u201cHigh\u2011intent\u201d, \u201cPayment pending\u201d, \u201cVIP\u201d)."}),(0,i.jsx)("div",{children:"Short names work best across Contacts, Inbox CRM, Campaigns and automations."})]})]}),(0,i.jsx)("button",{type:"button",onClick:S,className:"inline-flex items-center justify-center px-4 py-2 rounded-md text-xs font-semibold bg-emerald-700 text-white border border-emerald-700 hover:bg-emerald-800 whitespace-nowrap",children:"Create a tag"})]}),(0,i.jsxs)("div",{className:"bg-white rounded-md border border-slate-100 shadow-sm px-6 py-5",children:[(0,i.jsxs)("div",{className:"mb-3 flex flex-col gap-2",children:[(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:["all","system","custom"].map((e=>(0,i.jsx)("button",{type:"button",onClick:()=>g(e),className:"px-3 py-1.5 rounded-md text-xs font-semibold border transition ".concat(u===e?"bg-emerald-600 text-white border-emerald-600":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:"all"===e?"All":"system"===e?"System":"Custom"},e)))}),(0,i.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)("input",{value:m,onChange:e=>x(e.target.value),placeholder:"Search by name or category",className:"w-full px-4 py-2 text-sm rounded-md border border-slate-200 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})}),w.length>0&&(0,i.jsxs)("select",{value:h,onChange:e=>b(e.target.value),className:"border border-slate-200 rounded-md px-3 py-2 text-sm bg-white",children:[(0,i.jsx)("option",{value:"",children:"All categories"}),w.map((e=>(0,i.jsx)("option",{value:e,children:e},e)))]}),(0,i.jsx)("div",{className:"text-xs text-slate-500 whitespace-nowrap",children:s?"Loading\u2026":"".concat(C.length," tag(s)")})]})]}),(0,i.jsx)(p,{tags:C,loading:s,onCreate:S,onEdit:e=>{v(e),y(!0)},onDelete:async e=>{if(window.confirm('Delete tag "'.concat(null===e||void 0===e?void 0:e.name,'"?')))try{await d.default.delete("/tags/".concat(e.id)),n.oR.success("Tag deleted"),N()}catch(t){console.error(t),n.oR.error("Failed to delete")}},showHeader:!1,noContainer:!0,containerClassName:""})]})]}),f&&(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 backdrop-blur-sm",children:(0,i.jsxs)("div",{className:"bg-white rounded-md shadow-xl w-full max-w-md mx-4 relative",children:[(0,i.jsx)("button",{type:"button",onClick:A,className:"absolute right-3 top-3 text-slate-400 hover:text-slate-600","aria-label":"Close",children:(0,i.jsx)(r.A,{size:18})}),(0,i.jsx)("div",{className:"p-5",children:(0,i.jsx)(c,{selectedTag:j,onSaveComplete:(e,t)=>{e?(N(),n.oR.success(t||(j?"Tag updated":"Tag created"))):n.oR.error(t||"Failed to save"),A()},onCancel:A})})]})})]})}}}]);
//# sourceMappingURL=622.1fa7068e.chunk.js.map