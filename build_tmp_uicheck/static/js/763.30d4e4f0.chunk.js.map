{"version":3,"file":"static/js/763.30d4e4f0.chunk.js","mappings":"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","sources":["../node_modules/react-confirm-alert/lib/index.js","pages/Campaigns/components/MessagePreviewModal.jsx","pages/Campaigns/components/CampaignSummaryBar.jsx","../node_modules/lucide-react/src/icons/share-2.ts","pages/Campaigns/components/ContactJourneyModal.jsx","pages/Campaigns/CampaignSendLogs.jsx"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _class, _temp2;\n\nexports.confirmAlert = confirmAlert;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _client = require('react-dom/client');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ReactConfirmAlert = (_temp2 = _class = function (_Component) {\n  _inherits(ReactConfirmAlert, _Component);\n\n  function ReactConfirmAlert() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, ReactConfirmAlert);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = ReactConfirmAlert.__proto__ || Object.getPrototypeOf(ReactConfirmAlert)).call.apply(_ref, [this].concat(args))), _this), _this.handleClickButton = function (button) {\n      if (button.onClick) button.onClick();\n      _this.close();\n    }, _this.handleClickOverlay = function (e) {\n      var _this$props = _this.props,\n          closeOnClickOutside = _this$props.closeOnClickOutside,\n          onClickOutside = _this$props.onClickOutside;\n\n      var isClickOutside = e.target === _this.overlay;\n\n      if (closeOnClickOutside && isClickOutside) {\n        onClickOutside();\n        _this.close();\n      }\n\n      e.stopPropagation();\n    }, _this.close = function () {\n      var afterClose = _this.props.afterClose;\n\n      removeBodyClass();\n      removeElementReconfirm(_this.props);\n      removeSVGBlurReconfirm(afterClose);\n    }, _this.keyboard = function (event) {\n      var _this$props2 = _this.props,\n          closeOnEscape = _this$props2.closeOnEscape,\n          onKeypressEscape = _this$props2.onKeypressEscape,\n          onkeyPress = _this$props2.onkeyPress,\n          keyCodeForClose = _this$props2.keyCodeForClose;\n\n      var keyCode = event.keyCode;\n      var isKeyCodeEscape = keyCode === 27;\n\n      if (keyCodeForClose.includes(keyCode)) {\n        _this.close();\n      }\n\n      if (closeOnEscape && isKeyCodeEscape) {\n        onKeypressEscape(event);\n        _this.close();\n      }\n\n      if (onkeyPress) {\n        onkeyPress();\n      }\n    }, _this.componentDidMount = function () {\n      document.addEventListener('keydown', _this.keyboard, false);\n    }, _this.componentWillUnmount = function () {\n      document.removeEventListener('keydown', _this.keyboard, false);\n      _this.props.willUnmount();\n    }, _this.renderCustomUI = function () {\n      var _this$props3 = _this.props,\n          title = _this$props3.title,\n          message = _this$props3.message,\n          buttons = _this$props3.buttons,\n          customUI = _this$props3.customUI;\n\n      var dataCustomUI = {\n        title: title,\n        message: message,\n        buttons: buttons,\n        onClose: _this.close\n      };\n\n      return customUI(dataCustomUI);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(ReactConfirmAlert, [{\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          title = _props.title,\n          message = _props.message,\n          buttons = _props.buttons,\n          childrenElement = _props.childrenElement,\n          customUI = _props.customUI,\n          overlayClassName = _props.overlayClassName;\n\n\n      return _react2.default.createElement(\n        'div',\n        {\n          className: 'react-confirm-alert-overlay ' + overlayClassName,\n          ref: function ref(dom) {\n            return _this2.overlay = dom;\n          },\n          onClick: this.handleClickOverlay\n        },\n        _react2.default.createElement(\n          'div',\n          { className: 'react-confirm-alert' },\n          customUI ? this.renderCustomUI() : _react2.default.createElement(\n            'div',\n            { className: 'react-confirm-alert-body' },\n            title && _react2.default.createElement(\n              'h1',\n              null,\n              title\n            ),\n            message,\n            childrenElement(),\n            _react2.default.createElement(\n              'div',\n              { className: 'react-confirm-alert-button-group' },\n              buttons.map(function (button, i) {\n                return _react2.default.createElement(\n                  'button',\n                  _extends({\n                    key: i,\n                    className: button.className\n                  }, button, {\n                    onClick: function onClick(e) {\n                      return _this2.handleClickButton(button);\n                    }\n                  }),\n                  button.label\n                );\n              })\n            )\n          )\n        )\n      );\n    }\n  }]);\n\n  return ReactConfirmAlert;\n}(_react.Component), _class.propTypes = {\n  title: _propTypes2.default.string,\n  message: _propTypes2.default.string,\n  buttons: _propTypes2.default.array.isRequired,\n  childrenElement: _propTypes2.default.func,\n  customUI: _propTypes2.default.func,\n  closeOnClickOutside: _propTypes2.default.bool,\n  closeOnEscape: _propTypes2.default.bool,\n  keyCodeForClose: _propTypes2.default.arrayOf(_propTypes2.default.number),\n  willUnmount: _propTypes2.default.func,\n  afterClose: _propTypes2.default.func,\n  onClickOutside: _propTypes2.default.func,\n  onKeypressEscape: _propTypes2.default.func,\n  onkeyPress: _propTypes2.default.func,\n  overlayClassName: _propTypes2.default.string\n}, _class.defaultProps = {\n  buttons: [{\n    label: 'Cancel',\n    onClick: function onClick() {\n      return null;\n    },\n    className: null\n  }, {\n    label: 'Confirm',\n    onClick: function onClick() {\n      return null;\n    },\n    className: null\n  }],\n  childrenElement: function childrenElement() {\n    return null;\n  },\n  closeOnClickOutside: true,\n  closeOnEscape: true,\n  keyCodeForClose: [],\n  willUnmount: function willUnmount() {\n    return null;\n  },\n  afterClose: function afterClose() {\n    return null;\n  },\n  onClickOutside: function onClickOutside() {\n    return null;\n  },\n  onKeypressEscape: function onKeypressEscape() {\n    return null;\n  }\n}, _temp2);\nexports.default = ReactConfirmAlert;\n\n\nvar root = null;\nvar targetId = 'react-confirm-alert';\n\nfunction createSVGBlurReconfirm() {\n  // If has svg ignore to create the svg\n  var svg = document.getElementById('react-confirm-alert-firm-svg');\n  if (svg) return;\n  var svgNS = 'http://www.w3.org/2000/svg';\n  var feGaussianBlur = document.createElementNS(svgNS, 'feGaussianBlur');\n  feGaussianBlur.setAttribute('stdDeviation', '0.3');\n\n  var filter = document.createElementNS(svgNS, 'filter');\n  filter.setAttribute('id', 'gaussian-blur');\n  filter.appendChild(feGaussianBlur);\n\n  var svgElem = document.createElementNS(svgNS, 'svg');\n  svgElem.setAttribute('id', 'react-confirm-alert-firm-svg');\n  svgElem.setAttribute('class', 'react-confirm-alert-svg');\n  svgElem.appendChild(filter);\n\n  document.body.appendChild(svgElem);\n}\n\nfunction removeSVGBlurReconfirm(afterClose) {\n  var svg = document.getElementById('react-confirm-alert-firm-svg');\n  if (svg) {\n    svg.parentNode.removeChild(svg);\n  }\n  document.body.children[0].classList.remove('react-confirm-alert-blur');\n  afterClose();\n}\n\nfunction createElementReconfirm(properties) {\n  var divTarget = document.getElementById(properties.targetId || targetId);\n\n  if (properties.targetId && !divTarget) {\n    console.error('React Confirm Alert:', 'Can not get element id (#' + properties.targetId + ')');\n  }\n\n  if (divTarget) {\n    root = (0, _client.createRoot)(divTarget);\n    root.render(_react2.default.createElement(ReactConfirmAlert, properties));\n  } else {\n    document.body.children[0].classList.add('react-confirm-alert-blur');\n    divTarget = document.createElement('div');\n    divTarget.id = targetId;\n    document.body.appendChild(divTarget);\n    root = (0, _client.createRoot)(divTarget);\n    root.render(_react2.default.createElement(ReactConfirmAlert, properties));\n  }\n}\n\nfunction removeElementReconfirm(properties) {\n  var target = document.getElementById(properties.targetId || targetId);\n  if (target) {\n    root.unmount(target);\n  }\n}\n\nfunction addBodyClass() {\n  document.body.classList.add('react-confirm-alert-body-element');\n}\n\nfunction removeBodyClass() {\n  document.body.classList.remove('react-confirm-alert-body-element');\n}\n\nfunction confirmAlert(properties) {\n  addBodyClass();\n  createSVGBlurReconfirm();\n  createElementReconfirm(properties);\n}","import React from \"react\";\r\nimport { Dialog } from \"@headlessui/react\";\r\n\r\nconst MessagePreviewModal = ({ isOpen, onClose, messageLog }) => {\r\n  if (!messageLog) return null;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div\r\n        className=\"fixed inset-0 bg-black bg-opacity-30\"\r\n        aria-hidden=\"true\"\r\n      />\r\n\r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"w-full max-w-lg rounded-lg bg-white p-6 shadow-xl border border-gray-200\">\r\n          <Dialog.Title className=\"text-lg font-semibold text-purple-700 mb-3\">\r\n            ðŸ“¨ Sent Message Preview\r\n          </Dialog.Title>\r\n\r\n          <div className=\"text-sm bg-gray-50 p-4 border rounded-md whitespace-pre-wrap text-gray-800 mb-4\">\r\n            {messageLog.finalMessage || \"No message available\"}\r\n          </div>\r\n\r\n          <div className=\"text-xs text-gray-500 space-y-1\">\r\n            <p>\r\n              <strong>Channel:</strong> {messageLog.sourceChannel || \"-\"}\r\n            </p>\r\n            <p>\r\n              <strong>Sent At:</strong>{\" \"}\r\n              {messageLog.sentAt\r\n                ? new Date(messageLog.sentAt).toLocaleString()\r\n                : \"-\"}\r\n            </p>\r\n            {messageLog.clickType && (\r\n              <p>\r\n                <strong>Click Type:</strong> {messageLog.clickType}\r\n              </p>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"mt-5 text-right\">\r\n            <button\r\n              onClick={onClose}\r\n              className=\"px-4 py-2 text-sm bg-purple-600 text-white rounded hover:bg-purple-700\"\r\n            >\r\n              Close\r\n            </button>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default MessagePreviewModal;\r\n","import React from \"react\";\r\nimport { PieChart, Pie, Cell, ResponsiveContainer, Tooltip } from \"recharts\";\r\nimport {\r\n  Send,\r\n  CheckCircle2,\r\n  Eye,\r\n  XCircle,\r\n  MousePointerClick,\r\n} from \"lucide-react\";\r\n\r\nfunction CampaignSummaryBar({ summary }) {\r\n  if (!summary) {\r\n    return (\r\n      <div className=\"bg-white border rounded-lg shadow-sm p-4 mb-4\">\r\n        <p className=\"text-gray-500\">Loading summary...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // --- Calculations for Rates ---\r\n  const deliveryRate =\r\n    summary.sent > 0 // Use 'sent' as the base for delivery rate\r\n      ? ((summary.delivered / summary.sent) * 100).toFixed(1)\r\n      : 0;\r\n  const readRate =\r\n    summary.delivered > 0\r\n      ? ((summary.read / summary.delivered) * 100).toFixed(1)\r\n      : 0;\r\n\r\n  // --- Data for the Chart ---\r\n  const chartData = [\r\n    { name: \"Read\", value: summary.read || 0 },\r\n    {\r\n      name: \"Delivered (Unread)\",\r\n      value: (summary.delivered || 0) - (summary.read || 0),\r\n    },\r\n    // Show 'Sent' but not yet delivered\r\n    {\r\n      name: \"Sent (Pending Delivery)\",\r\n      value:\r\n        (summary.sent || 0) -\r\n        (summary.delivered || 0) -\r\n        (summary.failedCount || 0),\r\n    },\r\n    { name: \"Failed\", value: summary.failedCount || 0 },\r\n  ];\r\n  const COLORS = [\"#10B981\", \"#3B82F6\", \"#F59E0B\", \"#EF4444\"]; // Green, Blue, Amber, Red\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6\">\r\n      <div className=\"lg:col-span-2 grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-5\">\r\n        <KpiCard\r\n          title=\"Total Recipients\"\r\n          value={summary.totalSent || 0} // This is the total number of messages attempted\r\n          icon={<Send size={40} />}\r\n          gradient=\"from-slate-500 to-slate-600\"\r\n        />\r\n        {/* NEW \"Sent\" CARD */}\r\n        <KpiCard\r\n          title=\"Sent\"\r\n          value={summary.sent || 0}\r\n          subText=\"Successfully sent to provider\"\r\n          icon={<Send size={40} />}\r\n          gradient=\"from-pink-500 to-purple-600\"\r\n          decoration=\"wave\"\r\n        />\r\n        <KpiCard\r\n          title=\"Delivered\"\r\n          value={summary.delivered || 0}\r\n          subText={`${deliveryRate}% Delivery Rate`}\r\n          icon={<CheckCircle2 size={40} />}\r\n          gradient=\"from-purple-500 to-indigo-600\"\r\n          decoration=\"graph\"\r\n        />\r\n        <KpiCard\r\n          title=\"Read\"\r\n          value={summary.read || 0}\r\n          subText={`${readRate}% Read Rate`}\r\n          icon={<Eye size={40} />}\r\n          gradient=\"from-blue-400 to-cyan-500\"\r\n          decoration=\"bars\"\r\n        />\r\n        <KpiCard\r\n          title=\"Failed\"\r\n          value={summary.failedCount || 0}\r\n          subText=\"Could not be sent\"\r\n          icon={<XCircle size={40} />}\r\n          gradient=\"from-orange-400 to-red-500\"\r\n        />\r\n        <KpiCard\r\n          title=\"Clicked\"\r\n          value={summary.clickedCount || 0}\r\n          icon={<MousePointerClick size={40} />}\r\n          gradient=\"from-green-400 to-teal-500\"\r\n        />\r\n      </div>\r\n\r\n      {/* Chart Section */}\r\n      <div className=\"bg-white p-4 rounded-lg border border-gray-200 shadow-sm flex flex-col justify-center items-center\">\r\n        <h3 className=\"font-semibold text-gray-700 mb-2\">\r\n          Message Status Funnel\r\n        </h3>\r\n        <div className=\"w-full h-48 relative\">\r\n          <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n            <PieChart>\r\n              <Pie\r\n                data={chartData.filter(d => d.value > 0)}\r\n                dataKey=\"value\"\r\n                nameKey=\"name\"\r\n                cx=\"50%\"\r\n                cy=\"50%\"\r\n                innerRadius={50}\r\n                outerRadius={70}\r\n                fill=\"#8884d8\"\r\n                paddingAngle={5}\r\n              >\r\n                {chartData\r\n                  .filter(d => d.value > 0)\r\n                  .map((entry, index) => (\r\n                    <Cell\r\n                      key={`cell-${index}`}\r\n                      fill={COLORS[chartData.indexOf(entry)]}\r\n                    />\r\n                  ))}\r\n              </Pie>\r\n              <Tooltip formatter={(value, name) => [value, name]} />\r\n            </PieChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n// A new, redesigned component for the KPI cards to match your example\r\nconst KpiCard = ({\r\n  icon,\r\n  title,\r\n  value,\r\n  subText = null,\r\n  gradient,\r\n  decoration = null,\r\n}) => {\r\n  const decorations = {\r\n    wave: (\r\n      <svg\r\n        className=\"absolute bottom-0 left-0 w-full h-16 text-white opacity-10\"\r\n        fill=\"currentColor\"\r\n        viewBox=\"0 0 100 100\"\r\n        preserveAspectRatio=\"none\"\r\n      >\r\n        <path d=\"M0,50 C25,100 75,0 100,50 L100,100 L0,100 Z\" />\r\n      </svg>\r\n    ),\r\n    graph: (\r\n      <svg\r\n        className=\"absolute bottom-0 right-0 h-20 text-white opacity-10\"\r\n        fill=\"none\"\r\n        viewBox=\"0 0 100 100\"\r\n        preserveAspectRatio=\"none\"\r\n      >\r\n        <path\r\n          d=\"M0 80 C20 40, 40 90, 60 50, 80 10, 100 60\"\r\n          stroke=\"currentColor\"\r\n          strokeWidth=\"4\"\r\n        />\r\n      </svg>\r\n    ),\r\n    bars: (\r\n      <svg\r\n        className=\"absolute bottom-0 right-4 h-16 text-white opacity-10\"\r\n        fill=\"currentColor\"\r\n        viewBox=\"0 0 50 100\"\r\n        preserveAspectRatio=\"none\"\r\n      >\r\n        <rect x=\"0\" y=\"60\" width=\"8\" height=\"40\" />\r\n        <rect x=\"12\" y=\"40\" width=\"8\" height=\"60\" />\r\n        <rect x=\"24\" y=\"20\" width=\"8\" height=\"80\" />\r\n        <rect x=\"36\" y=\"50\" width=\"8\" height=\"50\" />\r\n      </svg>\r\n    ),\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`relative overflow-hidden rounded-xl shadow-lg p-5 text-white bg-gradient-to-r ${gradient}`}\r\n    >\r\n      {decoration && decorations[decoration]}\r\n      <div className=\"relative flex items-center gap-5\">\r\n        <div className=\"opacity-80\">{icon}</div>\r\n        <div className=\"flex-grow\">\r\n          <p className=\"text-sm font-medium text-white/80\">{title}</p>\r\n          <p className=\"text-3xl font-bold tracking-tight\">{value}</p>\r\n          {subText && <p className=\"text-xs text-white/70\">{subText}</p>}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CampaignSummaryBar;\r\n\r\n// import React from \"react\";\r\n// import { PieChart, Pie, Cell, ResponsiveContainer, Tooltip } from \"recharts\";\r\n// import {\r\n//   Send,\r\n//   CheckCircle2,\r\n//   Eye,\r\n//   XCircle,\r\n//   MousePointerClick,\r\n// } from \"lucide-react\"; // Modern icons\r\n\r\n// function CampaignSummaryBar({ summary }) {\r\n//   if (!summary) {\r\n//     return (\r\n//       <div className=\"bg-white border rounded-lg shadow-sm p-4 mb-4\">\r\n//         <p className=\"text-gray-500\">Loading summary...</p>\r\n//       </div>\r\n//     );\r\n//   }\r\n\r\n//   // --- Calculations for Rates ---\r\n//   const deliveryRate =\r\n//     summary.totalSent > 0\r\n//       ? ((summary.delivered / summary.totalSent) * 100).toFixed(1)\r\n//       : 0;\r\n//   const readRate =\r\n//     summary.delivered > 0\r\n//       ? ((summary.read / summary.delivered) * 100).toFixed(1)\r\n//       : 0;\r\n//   const clickRate =\r\n//     summary.delivered > 0\r\n//       ? ((summary.clickedCount / summary.delivered) * 100).toFixed(1)\r\n//       : 0;\r\n\r\n//   // --- Data for the Chart ---\r\n//   const chartData = [\r\n//     { name: \"Read\", value: summary.read || 0 },\r\n//     {\r\n//       name: \"Delivered (Not Read)\",\r\n//       value: (summary.delivered || 0) - (summary.read || 0),\r\n//     },\r\n//     { name: \"Failed\", value: summary.failedCount || 0 },\r\n//   ];\r\n//   const COLORS = [\"#10B981\", \"#3B82F6\", \"#EF4444\"]; // Emerald, Blue, Red\r\n\r\n//   return (\r\n//     <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6\">\r\n//       {/* KPI Cards Section */}\r\n//       <div className=\"lg:col-span-2 grid grid-cols-2 md:grid-cols-3 gap-4\">\r\n//         {/* Total Sent Card */}\r\n//         <KpiCard\r\n//           icon={<Send size={24} className=\"text-gray-400\" />}\r\n//           title=\"Total Sent\"\r\n//           value={summary.totalSent || 0}\r\n//         />\r\n\r\n//         {/* Delivered Card */}\r\n//         <KpiCard\r\n//           icon={<CheckCircle2 size={24} className=\"text-blue-500\" />}\r\n//           title=\"Delivered\"\r\n//           value={summary.delivered || 0}\r\n//           subText={`${deliveryRate}% Delivery Rate`}\r\n//         />\r\n\r\n//         {/* Read Card */}\r\n//         <KpiCard\r\n//           icon={<Eye size={24} className=\"text-emerald-500\" />}\r\n//           title=\"Read\"\r\n//           value={summary.read || 0}\r\n//           subText={`${readRate}% Read Rate`}\r\n//         />\r\n\r\n//         {/* Failed Card */}\r\n//         <KpiCard\r\n//           icon={<XCircle size={24} className=\"text-red-500\" />}\r\n//           title=\"Failed\"\r\n//           value={summary.failedCount || 0}\r\n//         />\r\n\r\n//         {/* Clicked Card */}\r\n//         <KpiCard\r\n//           icon={<MousePointerClick size={24} className=\"text-pink-500\" />}\r\n//           title=\"Clicked\"\r\n//           value={summary.clickedCount || 0}\r\n//           subText={`${clickRate}% Click Rate`}\r\n//         />\r\n//       </div>\r\n\r\n//       {/* Chart Section */}\r\n//       <div className=\"bg-white p-4 rounded-lg border border-gray-200 shadow-sm flex flex-col justify-center items-center\">\r\n//         <h3 className=\"font-semibold text-gray-700 mb-2\">Delivery Funnel</h3>\r\n//         <div className=\"w-full h-48 relative\">\r\n//           <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n//             <PieChart>\r\n//               <Pie\r\n//                 data={chartData}\r\n//                 dataKey=\"value\"\r\n//                 nameKey=\"name\"\r\n//                 cx=\"50%\"\r\n//                 cy=\"50%\"\r\n//                 innerRadius={50}\r\n//                 outerRadius={70}\r\n//                 fill=\"#8884d8\"\r\n//                 paddingAngle={5}\r\n//               >\r\n//                 {chartData.map((entry, index) => (\r\n//                   <Cell\r\n//                     key={`cell-${index}`}\r\n//                     fill={COLORS[index % COLORS.length]}\r\n//                   />\r\n//                 ))}\r\n//               </Pie>\r\n//               <Tooltip formatter={(value, name) => [value, name]} />\r\n//             </PieChart>\r\n//           </ResponsiveContainer>\r\n//           <div className=\"absolute inset-0 flex flex-col items-center justify-center pointer-events-none\">\r\n//             <span className=\"text-3xl font-bold text-gray-800\">\r\n//               {deliveryRate}%\r\n//             </span>\r\n//             <span className=\"text-sm text-gray-500\">Delivered</span>\r\n//           </div>\r\n//         </div>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// // A reusable component for the KPI cards to keep the main component clean\r\n// const KpiCard = ({ icon, title, value, subText = null }) => (\r\n//   <div className=\"bg-white p-4 rounded-lg border border-gray-200 shadow-sm\">\r\n//     <div className=\"flex items-center gap-4\">\r\n//       {icon}\r\n//       <div>\r\n//         <p className=\"text-gray-500 text-sm font-medium\">{title}</p>\r\n//         <p className=\"text-2xl font-bold text-gray-800\">{value}</p>\r\n//         {subText && <p className=\"text-xs text-gray-400\">{subText}</p>}\r\n//       </div>\r\n//     </div>\r\n//   </div>\r\n// );\r\n\r\n// export default CampaignSummaryBar;\r\n\r\n// import React from \"react\";\r\n// import { PieChart, Pie, Cell, ResponsiveContainer, Tooltip } from \"recharts\";\r\n// import {\r\n//   Send,\r\n//   CheckCircle2,\r\n//   Eye,\r\n//   XCircle,\r\n//   MousePointerClick,\r\n// } from \"lucide-react\";\r\n\r\n// function CampaignSummaryBar({ summary }) {\r\n//   if (!summary) {\r\n//     return (\r\n//       <div className=\"bg-slate-800 border border-slate-700 rounded-xl p-6 mb-6 text-center text-slate-400\">\r\n//         Loading Summary...\r\n//       </div>\r\n//     );\r\n//   }\r\n\r\n//   // --- Calculations for Rates ---\r\n//   const deliveryRate =\r\n//     summary.totalSent > 0 ? (summary.delivered / summary.totalSent) * 100 : 0;\r\n//   const readRate =\r\n//     summary.delivered > 0 ? (summary.read / summary.delivered) * 100 : 0;\r\n//   const failureRate =\r\n//     summary.totalSent > 0 ? (summary.failedCount / summary.totalSent) * 100 : 0;\r\n\r\n//   // --- Data for the Chart ---\r\n//   const chartData = [\r\n//     { name: \"Read\", value: summary.read || 0 },\r\n//     {\r\n//       name: \"Delivered\",\r\n//       value: (summary.delivered || 0) - (summary.read || 0),\r\n//     },\r\n//     { name: \"Failed\", value: summary.failedCount || 0 },\r\n//   ];\r\n//   // Vibrant, neon-like colors for the dark theme\r\n//   const COLORS = [\"#22d3ee\", \"#38bdf8\", \"#fb7185\"]; // Cyan, Sky Blue, Rose\r\n\r\n//   return (\r\n//     <div className=\"bg-slate-900 p-6 rounded-2xl border border-slate-800/80 mb-6\">\r\n//       <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6 items-center\">\r\n//         {/* KPI Cards Section */}\r\n//         <div className=\"lg:col-span-8 grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-5\">\r\n//           <KpiCard\r\n//             title=\"Total Sent\"\r\n//             value={summary.totalSent || 0}\r\n//             icon={<Send />}\r\n//             gradient=\"from-slate-700 to-slate-800\"\r\n//           />\r\n//           <KpiCard\r\n//             title=\"Delivered\"\r\n//             value={summary.delivered || 0}\r\n//             subText={`${deliveryRate.toFixed(1)}% Delivery Rate`}\r\n//             icon={<CheckCircle2 />}\r\n//             gradient=\"from-blue-500 to-cyan-500\"\r\n//           />\r\n//           <KpiCard\r\n//             title=\"Read\"\r\n//             value={summary.read || 0}\r\n//             subText={`${readRate.toFixed(1)}% Read Rate`}\r\n//             icon={<Eye />}\r\n//             gradient=\"from-emerald-500 to-green-500\"\r\n//           />\r\n//           <KpiCard\r\n//             title=\"Failed\"\r\n//             value={summary.failedCount || 0}\r\n//             subText={`${failureRate.toFixed(1)}% Failure Rate`}\r\n//             icon={<XCircle />}\r\n//             gradient=\"from-rose-500 to-red-600\"\r\n//           />\r\n//           <KpiCard\r\n//             title=\"Clicked\"\r\n//             value={summary.clickedCount || 0}\r\n//             icon={<MousePointerClick />}\r\n//             gradient=\"from-violet-500 to-fuchsia-500\"\r\n//           />\r\n//         </div>\r\n\r\n//         {/* Central Chart Section */}\r\n//         <div className=\"lg:col-span-4 flex flex-col items-center justify-center p-4 bg-slate-800/50 backdrop-blur-sm border border-slate-700/80 rounded-xl h-full\">\r\n//           <h3 className=\"font-semibold text-slate-300 text-base mb-2\">\r\n//             Delivery Status\r\n//           </h3>\r\n//           <div\r\n//             className=\"w-full h-48\"\r\n//             style={{ filter: `drop-shadow(0 0 12px ${COLORS[1]}40)` }}\r\n//           >\r\n//             <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n//               <PieChart>\r\n//                 <Pie\r\n//                   data={chartData}\r\n//                   dataKey=\"value\"\r\n//                   nameKey=\"name\"\r\n//                   cx=\"50%\"\r\n//                   cy=\"50%\"\r\n//                   innerRadius={60}\r\n//                   outerRadius={75}\r\n//                   fill=\"#8884d8\"\r\n//                   paddingAngle={5}\r\n//                 >\r\n//                   {chartData.map((entry, index) => (\r\n//                     <Cell\r\n//                       key={`cell-${index}`}\r\n//                       fill={COLORS[index % COLORS.length]}\r\n//                       stroke={COLORS[index % COLORS.length]}\r\n//                     />\r\n//                   ))}\r\n//                 </Pie>\r\n//                 <Tooltip\r\n//                   cursor={false}\r\n//                   contentStyle={{\r\n//                     background: \"rgba(20, 30, 48, 0.8)\",\r\n//                     backdropFilter: \"blur(4px)\",\r\n//                     border: \"1px solid rgba(255,255,255,0.1)\",\r\n//                     borderRadius: \"0.75rem\",\r\n//                     color: \"#fff\",\r\n//                   }}\r\n//                 />\r\n//               </PieChart>\r\n//             </ResponsiveContainer>\r\n//           </div>\r\n//         </div>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// // A new, redesigned component for the gradient KPI cards\r\n// const KpiCard = ({ title, value, subText, icon, gradient }) => (\r\n//   <div\r\n//     className={`bg-gradient-to-br ${gradient} p-5 rounded-xl shadow-lg text-white relative overflow-hidden`}\r\n//   >\r\n//     <div className=\"flex justify-between items-start\">\r\n//       <div className=\"flex flex-col\">\r\n//         <p className=\"text-sm font-medium text-white/80\">{title}</p>\r\n//         <span className=\"text-4xl font-bold tracking-tight mt-1\">{value}</span>\r\n//       </div>\r\n//       <div className=\"opacity-70\">{React.cloneElement(icon, { size: 24 })}</div>\r\n//     </div>\r\n//     {subText && <p className=\"text-xs text-white/70 mt-2\">{subText}</p>}\r\n//   </div>\r\n// );\r\n\r\n// export default CampaignSummaryBar;\r\n\r\n// import React from \"react\";\r\n// import {\r\n//   PieChart,\r\n//   Pie,\r\n//   Cell,\r\n//   ResponsiveContainer,\r\n//   Legend,\r\n//   Tooltip,\r\n// } from \"recharts\";\r\n\r\n// function CampaignSummaryBar({ summary }) {\r\n//   if (!summary) {\r\n//     return (\r\n//       <div className=\"bg-white border rounded-md shadow p-4 mb-4\">\r\n//         <p className=\"text-gray-500\">Loading summary...</p>\r\n//       </div>\r\n//     );\r\n//   }\r\n\r\n//   const chartData = [\r\n//     { name: \"Read\", value: summary.read || 0 },\r\n//     {\r\n//       name: \"Delivered (Not Read)\",\r\n//       value: (summary.delivered || 0) - (summary.read || 0),\r\n//     },\r\n//     { name: \"Failed\", value: summary.failedCount || 0 },\r\n//   ];\r\n//   const COLORS = [\"#00C49F\", \"#0088FE\", \"#FF8042\"];\r\n\r\n//   const formatDate = datetime =>\r\n//     datetime ? new Date(datetime).toLocaleString() : \"-\";\r\n\r\n//   return (\r\n//     <div className=\"bg-white border rounded-md shadow p-4 mb-4\">\r\n//       <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4\">\r\n//         {/* KPI Section */}\r\n//         <div className=\"lg:col-span-5 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 text-sm text-gray-800\">\r\n//           <div>\r\n//             <p className=\"font-semibold text-purple-700\">ðŸ“¬ Total Sent</p>\r\n//             <p className=\"text-2xl font-bold\">{summary.totalSent || 0}</p>\r\n//           </div>\r\n//           <div>\r\n//             <p className=\"font-semibold text-blue-600\">ðŸšš Delivered</p>\r\n//             <p className=\"text-2xl font-bold\">{summary.delivered || 0}</p>\r\n//           </div>\r\n//           <div>\r\n//             <p className=\"font-semibold text-teal-600\">ðŸ‘€ Read</p>\r\n//             <p className=\"text-2xl font-bold\">{summary.read || 0}</p>\r\n//           </div>\r\n//           <div>\r\n//             <p className=\"font-semibold text-red-600\">âŒ Failed</p>\r\n//             <p className=\"text-2xl font-bold\">{summary.failedCount || 0}</p>\r\n//           </div>\r\n//           <div>\r\n//             <p className=\"font-semibold text-green-700\">âœ… Clicked</p>\r\n//             <p className=\"text-2xl font-bold\">{summary.clickedCount || 0}</p>\r\n//           </div>\r\n//         </div>\r\n//         {/* Chart Section */}\r\n//         <div className=\"col-span-2 h-48\">\r\n//           <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n//             <PieChart>\r\n//               <Pie\r\n//                 data={chartData}\r\n//                 dataKey=\"value\"\r\n//                 nameKey=\"name\"\r\n//                 cx=\"50%\"\r\n//                 cy=\"50%\"\r\n//                 innerRadius={40}\r\n//                 outerRadius={60}\r\n//                 fill=\"#8884d8\"\r\n//               >\r\n//                 {chartData.map((entry, index) => (\r\n//                   <Cell\r\n//                     key={`cell-${index}`}\r\n//                     fill={COLORS[index % COLORS.length]}\r\n//                   />\r\n//                 ))}\r\n//               </Pie>\r\n//               <Tooltip />\r\n//               <Legend iconSize={10} />\r\n//             </PieChart>\r\n//           </ResponsiveContainer>\r\n//         </div>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default CampaignSummaryBar;\r\n// import React from \"react\";\r\n\r\n// function CampaignSummaryBar({ summary }) {\r\n//   if (!summary) return null;\r\n\r\n//   const formatDate = datetime =>\r\n//     datetime ? new Date(datetime).toLocaleString() : \"-\";\r\n\r\n//   return (\r\n//     <div className=\"bg-white border rounded-md shadow p-4 mb-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-800\">\r\n//       <div>\r\n//         <p className=\"font-semibold text-purple-700\">ðŸ“¬ Total Sent</p>\r\n//         <p>{summary.totalSent}</p>\r\n//       </div>\r\n//       <div>\r\n//         <p className=\"font-semibold text-red-600\">âŒ Failed</p>\r\n//         <p>{summary.failedCount}</p>\r\n//       </div>\r\n//       <div>\r\n//         <p className=\"font-semibold text-green-700\">âœ… Clicked</p>\r\n//         <p>{summary.clickedCount}</p>\r\n//       </div>\r\n//       <div>\r\n//         <p className=\"font-semibold text-blue-600\">ðŸ•’ Last Sent</p>\r\n//         <p>{formatDate(summary.lastSentAt)}</p>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default CampaignSummaryBar;\r\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['circle', { cx: '18', cy: '5', r: '3', key: 'gq8acd' }],\n  ['circle', { cx: '6', cy: '12', r: '3', key: 'w7nqdw' }],\n  ['circle', { cx: '18', cy: '19', r: '3', key: '1xt0gg' }],\n  ['line', { x1: '8.59', x2: '15.42', y1: '13.51', y2: '17.49', key: '47mynk' }],\n  ['line', { x1: '15.41', x2: '8.59', y1: '6.51', y2: '10.49', key: '1n3mei' }],\n];\n\n/**\n * @component @name Share2\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxOCIgY3k9IjUiIHI9IjMiIC8+CiAgPGNpcmNsZSBjeD0iNiIgY3k9IjEyIiByPSIzIiAvPgogIDxjaXJjbGUgY3g9IjE4IiBjeT0iMTkiIHI9IjMiIC8+CiAgPGxpbmUgeDE9IjguNTkiIHgyPSIxNS40MiIgeTE9IjEzLjUxIiB5Mj0iMTcuNDkiIC8+CiAgPGxpbmUgeDE9IjE1LjQxIiB4Mj0iOC41OSIgeTE9IjYuNTEiIHkyPSIxMC40OSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/share-2\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Share2 = createLucideIcon('share-2', __iconNode);\n\nexport default Share2;\n","// import React, { useEffect, useState, Fragment } from \"react\";\r\n// import { Dialog, Transition } from \"@headlessui/react\";\r\n// import axiosClient from \"../../../api/axiosClient\";\r\n// import { Send, MousePointerClick, Hourglass } from \"lucide-react\";\r\n\r\n// // Helper function to format dates\r\n// const formatDate = dt => (dt ? new Date(dt).toLocaleString() : \"N/A\");\r\n\r\n// // The main modal component\r\n// function ContactJourneyModal({ isOpen, onClose, log }) {\r\n//   const [journey, setJourney] = useState([]);\r\n//   const [loading, setLoading] = useState(false);\r\n\r\n//   useEffect(() => {\r\n//     if (isOpen && log?.id) {\r\n//       const fetchJourney = async () => {\r\n//         setLoading(true);\r\n//         try {\r\n//           const res = await axiosClient.get(`/tracking/journeys/${log.id}`);\r\n//           setJourney(res.data || []);\r\n//         } catch (error) {\r\n//           console.error(\"Failed to fetch contact journey\", error);\r\n//         } finally {\r\n//           setLoading(false);\r\n//         }\r\n//       };\r\n//       fetchJourney();\r\n//     }\r\n//   }, [isOpen, log]);\r\n\r\n//   if (!log) return null;\r\n\r\n//   return (\r\n//     <Transition appear show={isOpen} as={Fragment}>\r\n//       <Dialog as=\"div\" className=\"relative z-50\" onClose={onClose}>\r\n//         <Transition.Child\r\n//           as={Fragment}\r\n//           enter=\"ease-out duration-300\"\r\n//           enterFrom=\"opacity-0\"\r\n//           enterTo=\"opacity-100\"\r\n//           leave=\"ease-in duration-200\"\r\n//           leaveFrom=\"opacity-100\"\r\n//           leaveTo=\"opacity-0\"\r\n//         >\r\n//           <div className=\"fixed inset-0 bg-black bg-opacity-40\" />\r\n//         </Transition.Child>\r\n\r\n//         <div className=\"fixed inset-0 overflow-y-hidden\">\r\n//           <div className=\"flex items-center justify-center min-h-full p-4\">\r\n//             <Transition.Child\r\n//               as={Fragment}\r\n//               enter=\"ease-out duration-300\"\r\n//               enterFrom=\"opacity-0 scale-95\"\r\n//               enterTo=\"opacity-100 scale-100\"\r\n//               leave=\"ease-in duration-200\"\r\n//               leaveFrom=\"opacity-100 scale-100\"\r\n//               leaveTo=\"opacity-0 scale-95\"\r\n//             >\r\n//               {/* FIX: Panel is now a flex column with a max height */}\r\n//               <Dialog.Panel className=\"w-full max-w-2xl flex flex-col max-h-[85vh] transform overflow-hidden rounded-xl bg-white shadow-xl transition-all\">\r\n//                 {/* Header: Now a static flex item */}\r\n//                 <Dialog.Title className=\"flex-shrink-0 px-6 pt-6 pb-4 text-xl font-bold text-gray-800 flex items-center gap-2 border-b border-gray-200\">\r\n//                   <span className=\"text-purple-600\">ðŸ§­</span> Contact Journey\r\n//                   for {log.contactName}\r\n//                 </Dialog.Title>\r\n\r\n//                 {/* Content: This area is now scrollable */}\r\n//                 <div className=\"flex-grow overflow-y-auto px-6\">\r\n//                   {loading ? (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       Loading journey...\r\n//                     </p>\r\n//                   ) : journey.length > 0 ? (\r\n//                     <div className=\"border-l-2 border-slate-200 ml-3 py-8 space-y-8\">\r\n//                       {journey.map((event, idx) => (\r\n//                         <JourneyEvent key={idx} event={event} />\r\n//                       ))}\r\n//                     </div>\r\n//                   ) : (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       No journey events found for this message.\r\n//                     </p>\r\n//                   )}\r\n//                 </div>\r\n\r\n//                 {/* Footer: Now a static flex item */}\r\n//                 <div className=\"flex-shrink-0 px-6 pt-4 pb-6 flex justify-end gap-3 border-t border-gray-200\">\r\n//                   <button\r\n//                     onClick={onClose}\r\n//                     className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm font-semibold\"\r\n//                   >\r\n//                     Close\r\n//                   </button>\r\n//                 </div>\r\n//               </Dialog.Panel>\r\n//             </Transition.Child>\r\n//           </div>\r\n//         </div>\r\n//       </Dialog>\r\n//     </Transition>\r\n//   );\r\n// }\r\n\r\n// // A sub-component to render each event in the timeline (no changes needed here)\r\n// const JourneyEvent = ({ event }) => {\r\n//   const ICONS = {\r\n//     MessageSent: <Send size={16} className=\"text-white\" />,\r\n//     ButtonClicked: <MousePointerClick size={16} className=\"text-white\" />,\r\n//   };\r\n\r\n//   const COLORS = {\r\n//     MessageSent: \"bg-blue-500\",\r\n//     ButtonClicked: \"bg-green-500\",\r\n//   };\r\n\r\n//   return (\r\n//     <div className=\"relative pl-10\">\r\n//       <div\r\n//         className={`absolute -left-4 top-0.5 w-8 h-8 rounded-full flex items-center justify-center ring-4 ring-white ${\r\n//           COLORS[event.eventType] || \"bg-gray-400\"\r\n//         }`}\r\n//       >\r\n//         {ICONS[event.eventType] || (\r\n//           <Hourglass size={16} className=\"text-white\" />\r\n//         )}\r\n//       </div>\r\n//       <p className=\"font-semibold text-gray-800\">{event.title}</p>\r\n//       <p className=\"text-sm text-gray-500 truncate\">{event.details}</p>\r\n//       <p className=\"text-xs text-gray-400 mt-1\">\r\n//         {formatDate(event.timestamp)}\r\n//       </p>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default ContactJourneyModal;\r\n\r\n// import React, { useEffect, useState, Fragment } from \"react\";\r\n// import { Dialog, Transition } from \"@headlessui/react\";\r\n// import axiosClient from \"../../../api/axiosClient\";\r\n// import {\r\n//   Send,\r\n//   MousePointerClick,\r\n//   Hourglass,\r\n//   CheckCircle2,\r\n//   Eye,\r\n//   Share2,\r\n// } from \"lucide-react\";\r\n\r\n// const formatDate = dt => (dt ? new Date(dt).toLocaleString() : \"N/A\");\r\n\r\n// function ContactJourneyModal({ isOpen, onClose, log }) {\r\n//   const [journey, setJourney] = useState({ events: [] });\r\n//   const [loading, setLoading] = useState(false);\r\n\r\n//   useEffect(() => {\r\n//     if (isOpen && log?.id) {\r\n//       (async () => {\r\n//         setLoading(true);\r\n//         try {\r\n//           const res = await axiosClient.get(`/tracking/journeys/${log.id}`);\r\n//           const data = res.data;\r\n//           // Back-compat: if server returns an array, wrap it\r\n//           if (Array.isArray(data)) setJourney({ events: data });\r\n//           else setJourney(data || { events: [] });\r\n//         } catch (e) {\r\n//           console.error(\"Failed to fetch contact journey\", e);\r\n//           setJourney({ events: [] });\r\n//         } finally {\r\n//           setLoading(false);\r\n//         }\r\n//       })();\r\n//     }\r\n//   }, [isOpen, log]);\r\n\r\n//   if (!log) return null;\r\n\r\n//   const typeBadge =\r\n//     journey.campaignType === \"flow\" ? (\r\n//       <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-emerald-100 text-emerald-700 text-xs font-semibold\">\r\n//         Flow\r\n//       </span>\r\n//     ) : (\r\n//       <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-blue-100 text-blue-700 text-xs font-semibold\">\r\n//         Dynamic URL\r\n//       </span>\r\n//     );\r\n\r\n//   return (\r\n//     <Transition appear show={isOpen} as={Fragment}>\r\n//       <Dialog as=\"div\" className=\"relative z-50\" onClose={onClose}>\r\n//         <Transition.Child\r\n//           as={Fragment}\r\n//           enter=\"ease-out duration-300\"\r\n//           enterFrom=\"opacity-0\"\r\n//           enterTo=\"opacity-100\"\r\n//           leave=\"ease-in duration-200\"\r\n//           leaveFrom=\"opacity-100\"\r\n//           leaveTo=\"opacity-0\"\r\n//         >\r\n//           <div className=\"fixed inset-0 bg-black/40\" />\r\n//         </Transition.Child>\r\n\r\n//         <div className=\"fixed inset-0 overflow-y-hidden\">\r\n//           <div className=\"flex items-center justify-center min-h-full p-4\">\r\n//             <Transition.Child\r\n//               as={Fragment}\r\n//               enter=\"ease-out duration-300\"\r\n//               enterFrom=\"opacity-0 scale-95\"\r\n//               enterTo=\"opacity-100 scale-100\"\r\n//               leave=\"ease-in duration-200\"\r\n//               leaveFrom=\"opacity-100 scale-100\"\r\n//               leaveTo=\"opacity-0 scale-95\"\r\n//             >\r\n//               <Dialog.Panel className=\"w-full max-w-2xl flex flex-col max-h-[85vh] transform overflow-hidden rounded-xl bg-white shadow-xl transition-all\">\r\n//                 <Dialog.Title className=\"flex-shrink-0 px-6 pt-6 pb-4 text-xl font-bold text-gray-800 flex items-center gap-2 border-b border-gray-200\">\r\n//                   <span className=\"text-purple-600\">ðŸ§­</span>\r\n//                   Contact Journey for {log.contactName}\r\n//                   {typeBadge}\r\n//                 </Dialog.Title>\r\n\r\n//                 <div className=\"flex-grow overflow-y-auto px-6\">\r\n//                   {loading ? (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       Loading journey...\r\n//                     </p>\r\n//                   ) : (journey?.events?.length || 0) > 0 ? (\r\n//                     <>\r\n//                       {journey?.leftOffAt && (\r\n//                         <div className=\"mt-4 mb-2 text-xs text-gray-500\">\r\n//                           Left off at:{\" \"}\r\n//                           <span className=\"font-semibold\">\r\n//                             {journey.leftOffAt}\r\n//                           </span>\r\n//                           {journey.flowName ? (\r\n//                             <span>\r\n//                               {\" \"}\r\n//                               in{\" \"}\r\n//                               <span className=\"font-semibold\">\r\n//                                 {journey.flowName}\r\n//                               </span>\r\n//                             </span>\r\n//                           ) : null}\r\n//                         </div>\r\n//                       )}\r\n//                       <div className=\"border-l-2 border-slate-200 ml-3 py-8 space-y-8\">\r\n//                         {journey.events.map((event, idx) => (\r\n//                           <JourneyEvent key={idx} event={event} />\r\n//                         ))}\r\n//                       </div>\r\n//                     </>\r\n//                   ) : (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       No journey events found for this message.\r\n//                     </p>\r\n//                   )}\r\n//                 </div>\r\n\r\n//                 <div className=\"flex-shrink-0 px-6 pt-4 pb-6 flex justify-end gap-3 border-t border-gray-200\">\r\n//                   <button\r\n//                     onClick={onClose}\r\n//                     className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm font-semibold\"\r\n//                   >\r\n//                     Close\r\n//                   </button>\r\n//                 </div>\r\n//               </Dialog.Panel>\r\n//             </Transition.Child>\r\n//           </div>\r\n//         </div>\r\n//       </Dialog>\r\n//     </Transition>\r\n//   );\r\n// }\r\n\r\n// const ICONS = {\r\n//   MessageSent: <Send size={16} className=\"text-white\" />,\r\n//   Delivered: <CheckCircle2 size={16} className=\"text-white\" />,\r\n//   Read: <Eye size={16} className=\"text-white\" />,\r\n//   ButtonClicked: <MousePointerClick size={16} className=\"text-white\" />,\r\n//   FlowSend: <Send size={16} className=\"text-white\" />,\r\n//   Redirect: <Share2 size={16} className=\"text-white\" />,\r\n// };\r\n\r\n// const COLORS = {\r\n//   MessageSent: \"bg-blue-500\",\r\n//   Delivered: \"bg-emerald-500\",\r\n//   Read: \"bg-cyan-500\",\r\n//   ButtonClicked: \"bg-green-500\",\r\n//   FlowSend: \"bg-indigo-500\",\r\n//   Redirect: \"bg-amber-500\",\r\n// };\r\n\r\n// const JourneyEvent = ({ event }) => {\r\n//   const icon = ICONS[event.eventType] || (\r\n//     <Hourglass size={16} className=\"text-white\" />\r\n//   );\r\n//   const color = COLORS[event.eventType] || \"bg-gray-400\";\r\n\r\n//   return (\r\n//     <div className=\"relative pl-10\">\r\n//       <div\r\n//         className={`absolute -left-4 top-0.5 w-8 h-8 rounded-full flex items-center justify-center ring-4 ring-white ${color}`}\r\n//       >\r\n//         {icon}\r\n//       </div>\r\n//       <p className=\"font-semibold text-gray-800\">{event.title}</p>\r\n//       <p className=\"text-sm text-gray-500 break-words\">\r\n//         {event.details}\r\n//         {event.url ? (\r\n//           <>\r\n//             <br />\r\n//             <a\r\n//               className=\"text-blue-600 underline\"\r\n//               href={event.url}\r\n//               target=\"_blank\"\r\n//               rel=\"noreferrer\"\r\n//             >\r\n//               {event.url}\r\n//             </a>\r\n//           </>\r\n//         ) : null}\r\n//       </p>\r\n//       <p className=\"text-xs text-gray-400 mt-1\">\r\n//         {formatDate(event.timestamp)}\r\n//       </p>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default ContactJourneyModal;\r\n// ðŸ“„ src/pages/campaigns/components/ContactJourneyModal.jsx\r\n// import React, { useEffect, useMemo, useState, Fragment } from \"react\";\r\n// import { Dialog, Transition } from \"@headlessui/react\";\r\n// import axiosClient from \"../../../api/axiosClient\";\r\n// import {\r\n//   Send,\r\n//   MousePointerClick,\r\n//   Hourglass,\r\n//   CheckCircle2,\r\n//   Eye,\r\n//   Share2,\r\n//   Link2,\r\n//   Copy,\r\n//   Filter,\r\n//   X,\r\n// } from \"lucide-react\";\r\n\r\n// const formatDate = dt => (dt ? new Date(dt).toLocaleString() : \"N/A\");\r\n\r\n// // ---- helpers ----\r\n// const relTime = iso => {\r\n//   if (!iso) return \"\";\r\n//   const diff = Date.now() - new Date(iso).getTime();\r\n//   const abs = Math.abs(diff);\r\n//   const mins = Math.floor(abs / (60 * 1000));\r\n//   if (mins < 1) return \"just now\";\r\n//   if (mins < 60) return `${mins}m ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n//   const hrs = Math.floor(mins / 60);\r\n//   if (hrs < 24) return `${hrs}h ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n//   const days = Math.floor(hrs / 24);\r\n//   return `${days}d ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n// };\r\n\r\n// const displayUrl = raw => {\r\n//   try {\r\n//     const u = new URL(raw);\r\n//     const tail =\r\n//       u.pathname.length > 1 ? u.pathname.split(\"/\").slice(-1)[0] : \"\";\r\n//     return `${u.hostname}${tail ? `/${tail}` : \"\"}`;\r\n//   } catch {\r\n//     return raw?.slice(0, 60) || \"\";\r\n//   }\r\n// };\r\n\r\n// const ICONS = {\r\n//   MessageSent: <Send size={16} className=\"text-white\" />,\r\n//   Delivered: <CheckCircle2 size={16} className=\"text-white\" />,\r\n//   Read: <Eye size={16} className=\"text-white\" />,\r\n//   ButtonClicked: <MousePointerClick size={16} className=\"text-white\" />,\r\n//   FlowSend: <Send size={16} className=\"text-white\" />,\r\n//   Redirect: <Share2 size={16} className=\"text-white\" />,\r\n// };\r\n\r\n// const COLORS = {\r\n//   MessageSent: \"bg-blue-500\",\r\n//   Delivered: \"bg-emerald-500\",\r\n//   Read: \"bg-cyan-500\",\r\n//   ButtonClicked: \"bg-green-500\",\r\n//   FlowSend: \"bg-indigo-500\",\r\n//   Redirect: \"bg-amber-500\",\r\n// };\r\n\r\n// const isClickEvent = t => t === \"ButtonClicked\" || t === \"Redirect\";\r\n// const isMessageEvent = t =>\r\n//   t === \"MessageSent\" || t === \"Delivered\" || t === \"Read\" || t === \"FlowSend\";\r\n\r\n// function ContactJourneyModal({ isOpen, onClose, log }) {\r\n//   const [journey, setJourney] = useState({ events: [] });\r\n//   const [loading, setLoading] = useState(false);\r\n//   const [filter, setFilter] = useState(\"all\"); // all | messages | clicks\r\n//   const [expanded, setExpanded] = useState(false);\r\n\r\n//   // âœ… safe fallback to avoid conditional return before hooks\r\n//   const safeLog = log || { contactName: \"Unknown\" };\r\n\r\n//   useEffect(() => {\r\n//     if (isOpen && log?.id) {\r\n//       (async () => {\r\n//         setLoading(true);\r\n//         try {\r\n//           const res = await axiosClient.get(`/tracking/journeys/${log.id}`);\r\n//           const data = res.data;\r\n//           if (Array.isArray(data)) setJourney({ events: data });\r\n//           else setJourney(data || { events: [] });\r\n//         } catch (e) {\r\n//           console.error(\"Failed to fetch contact journey\", e);\r\n//           setJourney({ events: [] });\r\n//         } finally {\r\n//           setLoading(false);\r\n//         }\r\n//       })();\r\n//     }\r\n//   }, [isOpen, log]);\r\n\r\n//   useEffect(() => {\r\n//     if (isOpen) setExpanded(false);\r\n//   }, [isOpen]);\r\n\r\n//   const typeBadge =\r\n//     journey.campaignType === \"flow\" ? (\r\n//       <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-emerald-100 text-emerald-700 text-xs font-semibold\">\r\n//         Flow\r\n//       </span>\r\n//     ) : (\r\n//       <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-blue-100 text-blue-700 text-xs font-semibold\">\r\n//         Dynamic URL\r\n//       </span>\r\n//     );\r\n\r\n//   // filter view\r\n//   const eventsFiltered = useMemo(() => {\r\n//     const all = journey?.events || [];\r\n//     if (filter === \"messages\")\r\n//       return all.filter(e => isMessageEvent(e.eventType));\r\n//     if (filter === \"clicks\") return all.filter(e => isClickEvent(e.eventType));\r\n//     return all;\r\n//   }, [journey, filter]);\r\n\r\n//   // collapse logic\r\n//   const COLLAPSE_AFTER = 6;\r\n//   const eventsVisible =\r\n//     expanded || eventsFiltered.length <= COLLAPSE_AFTER\r\n//       ? eventsFiltered\r\n//       : eventsFiltered.slice(0, COLLAPSE_AFTER);\r\n\r\n//   const leftOff = journey?.leftOffAt;\r\n\r\n//   return (\r\n//     <Transition appear show={isOpen} as={Fragment}>\r\n//       <Dialog as=\"div\" className=\"relative z-50\" onClose={onClose}>\r\n//         <Transition.Child\r\n//           as={Fragment}\r\n//           enter=\"ease-out duration-300\"\r\n//           enterFrom=\"opacity-0\"\r\n//           enterTo=\"opacity-100\"\r\n//           leave=\"ease-in duration-200\"\r\n//           leaveFrom=\"opacity-100\"\r\n//           leaveTo=\"opacity-0\"\r\n//         >\r\n//           <div className=\"fixed inset-0 bg-black/40\" />\r\n//         </Transition.Child>\r\n\r\n//         <div className=\"fixed inset-0 overflow-y-hidden\">\r\n//           <div className=\"flex items-center justify-center min-h-full p-4\">\r\n//             <Transition.Child\r\n//               as={Fragment}\r\n//               enter=\"ease-out duration-300\"\r\n//               enterFrom=\"opacity-0 scale-95\"\r\n//               enterTo=\"opacity-100 scale-100\"\r\n//               leave=\"ease-in duration-200\"\r\n//               leaveFrom=\"opacity-100 scale-100\"\r\n//               leaveTo=\"opacity-0 scale-95\"\r\n//             >\r\n//               <Dialog.Panel className=\"w-full max-w-2xl flex flex-col max-h-[85vh] transform overflow-hidden rounded-xl bg-white shadow-xl transition-all\">\r\n//                 {/* Header */}\r\n//                 <Dialog.Title className=\"sticky top-0 z-10 bg-white/70 backdrop-blur px-6 pt-6 pb-3 text-xl font-bold text-gray-800 flex items-center gap-2 border-b border-gray-200\">\r\n//                   <span className=\"text-purple-600\">ðŸ§­</span>\r\n//                   Contact Journey for {safeLog.contactName}\r\n//                   {typeBadge}\r\n//                   <div className=\"ml-auto flex items-center gap-2\">\r\n//                     <Filter size={16} className=\"text-gray-400\" />\r\n//                     <div className=\"inline-flex rounded-lg border overflow-hidden\">\r\n//                       <button\r\n//                         className={`px-2 py-1 text-xs ${\r\n//                           filter === \"all\"\r\n//                             ? \"bg-gray-900 text-white\"\r\n//                             : \"bg-white\"\r\n//                         }`}\r\n//                         onClick={() => setFilter(\"all\")}\r\n//                       >\r\n//                         All\r\n//                       </button>\r\n//                       <button\r\n//                         className={`px-2 py-1 text-xs border-l ${\r\n//                           filter === \"messages\"\r\n//                             ? \"bg-gray-900 text-white\"\r\n//                             : \"bg-white\"\r\n//                         }`}\r\n//                         onClick={() => setFilter(\"messages\")}\r\n//                       >\r\n//                         Messages\r\n//                       </button>\r\n//                       <button\r\n//                         className={`px-2 py-1 text-xs border-l ${\r\n//                           filter === \"clicks\"\r\n//                             ? \"bg-gray-900 text-white\"\r\n//                             : \"bg-white\"\r\n//                         }`}\r\n//                         onClick={() => setFilter(\"clicks\")}\r\n//                       >\r\n//                         Clicks\r\n//                       </button>\r\n//                     </div>\r\n//                     <button\r\n//                       onClick={onClose}\r\n//                       className=\"ml-2 inline-flex items-center justify-center rounded-lg p-2 hover:bg-gray-100\"\r\n//                       aria-label=\"Close\"\r\n//                     >\r\n//                       <X size={16} />\r\n//                     </button>\r\n//                   </div>\r\n//                 </Dialog.Title>\r\n\r\n//                 {/* Body */}\r\n//                 <div className=\"flex-grow overflow-y-auto px-6\">\r\n//                   {loading ? (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       Loading journey...\r\n//                     </p>\r\n//                   ) : (eventsFiltered.length || 0) > 0 ? (\r\n//                     <>\r\n//                       {leftOff && (\r\n//                         <div className=\"mt-4 mb-2 text-xs text-gray-600\">\r\n//                           <span className=\"inline-flex items-center gap-1 rounded-full bg-amber-50 text-amber-700 px-2 py-1 font-semibold\">\r\n//                             Left off at:\r\n//                             <span className=\"text-amber-900\">{leftOff}</span>\r\n//                             {journey.flowName ? (\r\n//                               <span className=\"text-amber-700\">\r\n//                                 &nbsp;in{\" \"}\r\n//                                 <span className=\"font-bold\">\r\n//                                   {journey.flowName}\r\n//                                 </span>\r\n//                               </span>\r\n//                             ) : null}\r\n//                           </span>\r\n//                         </div>\r\n//                       )}\r\n\r\n//                       <div className=\"relative ml-4 py-6\">\r\n//                         {/* vertical line */}\r\n//                         <div className=\"absolute left-0 top-0 bottom-0 w-px bg-slate-200\" />\r\n//                         <div className=\"space-y-6\">\r\n//                           {eventsVisible.map((event, idx) => (\r\n//                             <JourneyEvent\r\n//                               key={idx}\r\n//                               isCurrent={\r\n//                                 leftOff && event?.title?.includes(leftOff)\r\n//                               }\r\n//                               event={event}\r\n//                             />\r\n//                           ))}\r\n//                         </div>\r\n//                       </div>\r\n\r\n//                       {eventsFiltered.length > COLLAPSE_AFTER && (\r\n//                         <div className=\"flex justify-center pt-2 pb-6\">\r\n//                           <button\r\n//                             onClick={() => setExpanded(v => !v)}\r\n//                             className=\"text-sm font-semibold text-purple-700 hover:text-purple-800\"\r\n//                           >\r\n//                             {expanded\r\n//                               ? \"Show less\"\r\n//                               : `Show ${\r\n//                                   eventsFiltered.length - COLLAPSE_AFTER\r\n//                                 } more events`}\r\n//                           </button>\r\n//                         </div>\r\n//                       )}\r\n//                     </>\r\n//                   ) : (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       No journey events found for this message.\r\n//                     </p>\r\n//                   )}\r\n//                 </div>\r\n\r\n//                 {/* Footer */}\r\n//                 <div className=\"flex-shrink-0 px-6 pt-3 pb-5 flex justify-end gap-3 border-t border-gray-200\">\r\n//                   <button\r\n//                     onClick={onClose}\r\n//                     className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm font-semibold\"\r\n//                   >\r\n//                     Close\r\n//                   </button>\r\n//                 </div>\r\n//               </Dialog.Panel>\r\n//             </Transition.Child>\r\n//           </div>\r\n//         </div>\r\n//       </Dialog>\r\n//     </Transition>\r\n//   );\r\n// }\r\n\r\n// // const JourneyEvent = ({ event, isCurrent }) => {\r\n// //   const icon = ICONS[event.eventType] || (\r\n// //     <Hourglass size={16} className=\"text-white\" />\r\n// //   );\r\n// //   const color = COLORS[event.eventType] || \"bg-gray-400\";\r\n\r\n// //   const handleCopy = () => {\r\n// //     if (event.url) {\r\n// //       navigator.clipboard?.writeText(event.url);\r\n// //     }\r\n// //   };\r\n\r\n// //   const isClickable = Boolean(event.url);\r\n\r\n// //   return (\r\n// //     <div className=\"relative pl-8\">\r\n// //       {/* node */}\r\n// //       <div\r\n// //         className={`absolute -left-3 top-1 w-6 h-6 rounded-full flex items-center justify-center ring-4 ring-white ${color} ${\r\n// //           isCurrent ? \"scale-110 shadow-lg\" : \"\"\r\n// //         }`}\r\n// //       >\r\n// //         {icon}\r\n// //       </div>\r\n\r\n// //       <div\r\n// //         className={`rounded-lg p-3 ${\r\n// //           isCurrent ? \"bg-amber-50 border border-amber-200\" : \"bg-white\"\r\n// //         }`}\r\n// //       >\r\n// //         <p className=\"font-semibold text-gray-800\">{event.title}</p>\r\n\r\n// //         <p className=\"text-sm text-gray-600 break-words\">\r\n// //           {event.details}\r\n// //           {isClickable && (\r\n// //             <>\r\n// //               <br />\r\n// //               <a\r\n// //                 className=\"inline-flex items-center gap-1 text-blue-700 underline underline-offset-2\"\r\n// //                 href={event.url}\r\n// //                 target=\"_blank\"\r\n// //                 rel=\"noreferrer\"\r\n// //                 title={event.url}\r\n// //               >\r\n// //                 <Link2 size={14} />\r\n// //                 {displayUrl(event.url)}\r\n// //               </a>\r\n// //               <button\r\n// //                 onClick={handleCopy}\r\n// //                 className=\"ml-2 inline-flex items-center gap-1 text-gray-500 hover:text-gray-700\"\r\n// //                 title=\"Copy URL\"\r\n// //               >\r\n// //                 <Copy size={14} />\r\n// //                 <span className=\"text-xs\">Copy</span>\r\n// //               </button>\r\n// //             </>\r\n// //           )}\r\n// //         </p>\r\n\r\n// //         <p className=\"text-xs text-gray-400 mt-2\">\r\n// //           {formatDate(event.timestamp)} â€¢ {relTime(event.timestamp)}\r\n// //         </p>\r\n// //       </div>\r\n// //     </div>\r\n// //   );\r\n// // };\r\n// const JourneyEvent = ({ event, isCurrent }) => {\r\n//   const icon = ICONS[event.eventType] || (\r\n//     <Hourglass size={16} className=\"text-white\" />\r\n//   );\r\n//   const color = COLORS[event.eventType] || \"bg-gray-400\";\r\n\r\n//   const handleCopy = () => {\r\n//     if (event.url) {\r\n//       navigator.clipboard?.writeText(event.url);\r\n//     }\r\n//   };\r\n\r\n//   const isClickable = Boolean(event.url);\r\n\r\n//   // âœ… hide \"details\" for click-type events (Quick Reply / URL button)\r\n//   const shouldShowDetails = !(\r\n//     event.eventType === \"ButtonClicked\" || event.eventType === \"Redirect\"\r\n//   );\r\n\r\n//   return (\r\n//     <div className=\"relative pl-8\">\r\n//       {/* node */}\r\n//       <div\r\n//         className={`absolute -left-3 top-1 w-6 h-6 rounded-full flex items-center justify-center ring-4 ring-white ${color} ${\r\n//           isCurrent ? \"scale-110 shadow-lg\" : \"\"\r\n//         }`}\r\n//       >\r\n//         {icon}\r\n//       </div>\r\n\r\n//       <div\r\n//         className={`rounded-lg p-3 ${\r\n//           isCurrent ? \"bg-amber-50 border border-amber-200\" : \"bg-white\"\r\n//         }`}\r\n//       >\r\n//         <p className=\"font-semibold text-gray-800\">{event.title}</p>\r\n\r\n//         {shouldShowDetails && event.details && (\r\n//           <p className=\"text-sm text-gray-600 break-words\">{event.details}</p>\r\n//         )}\r\n\r\n//         {isClickable && (\r\n//           <p className=\"mt-1\">\r\n//             <a\r\n//               className=\"inline-flex items-center gap-1 text-blue-700 underline underline-offset-2\"\r\n//               href={event.url}\r\n//               target=\"_blank\"\r\n//               rel=\"noreferrer\"\r\n//               title={event.url}\r\n//             >\r\n//               <Link2 size={14} />\r\n//               {displayUrl(event.url)}\r\n//             </a>\r\n//             <button\r\n//               onClick={handleCopy}\r\n//               className=\"ml-2 inline-flex items-center gap-1 text-gray-500 hover:text-gray-700\"\r\n//               title=\"Copy URL\"\r\n//             >\r\n//               <Copy size={14} />\r\n//               <span className=\"text-xs\">Copy</span>\r\n//             </button>\r\n//           </p>\r\n//         )}\r\n\r\n//         <p className=\"text-xs text-gray-400 mt-2\">\r\n//           {formatDate(event.timestamp)} â€¢ {relTime(event.timestamp)}\r\n//         </p>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default ContactJourneyModal;\r\n// ðŸ“„ src/pages/campaigns/components/ContactJourneyModal.jsx\r\n// import React, { useEffect, useMemo, useState, Fragment } from \"react\";\r\n// import { Dialog, Transition } from \"@headlessui/react\";\r\n// import axiosClient from \"../../../api/axiosClient\";\r\n// import {\r\n//   Send,\r\n//   MousePointerClick,\r\n//   Hourglass,\r\n//   CheckCircle2,\r\n//   Eye,\r\n//   Share2,\r\n//   Link2,\r\n//   Copy,\r\n//   Filter,\r\n//   X,\r\n// } from \"lucide-react\";\r\n\r\n// const formatDate = dt => (dt ? new Date(dt).toLocaleString() : \"N/A\");\r\n\r\n// // ---- helpers ----\r\n// const relTime = iso => {\r\n//   if (!iso) return \"\";\r\n//   const diff = Date.now() - new Date(iso).getTime();\r\n//   const abs = Math.abs(diff);\r\n//   const mins = Math.floor(abs / (60 * 1000));\r\n//   if (mins < 1) return \"just now\";\r\n//   if (mins < 60) return `${mins}m ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n//   const hrs = Math.floor(mins / 60);\r\n//   if (hrs < 24) return `${hrs}h ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n//   const days = Math.floor(hrs / 24);\r\n//   return `${days}d ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n// };\r\n\r\n// const displayUrl = raw => {\r\n//   try {\r\n//     const u = new URL(raw);\r\n//     const tail =\r\n//       u.pathname.length > 1 ? u.pathname.split(\"/\").slice(-1)[0] : \"\";\r\n//     return `${u.hostname}${tail ? `/${tail}` : \"\"}`;\r\n//   } catch {\r\n//     return raw?.slice(0, 60) || \"\";\r\n//   }\r\n// };\r\n\r\n// // ðŸ‘‰ extract a phone number from any string like \"WhatsApp User (+91897â€¦)\"\r\n// const extractNumber = val => {\r\n//   if (!val) return null;\r\n//   const m = String(val).match(/(\\+?\\d[\\d\\s-]{5,}\\d)/);\r\n//   return m ? m[1].replace(/[\\s-]/g, \"\") : null;\r\n// };\r\n\r\n// const ICONS = {\r\n//   MessageSent: <Send size={16} className=\"text-white\" />,\r\n//   Delivered: <CheckCircle2 size={16} className=\"text-white\" />,\r\n//   Read: <Eye size={16} className=\"text-white\" />,\r\n//   ButtonClicked: <MousePointerClick size={16} className=\"text-white\" />,\r\n//   FlowSend: <Send size={16} className=\"text-white\" />,\r\n//   Redirect: <Share2 size={16} className=\"text-white\" />,\r\n// };\r\n\r\n// const COLORS = {\r\n//   MessageSent: \"bg-blue-500\",\r\n//   Delivered: \"bg-emerald-500\",\r\n//   Read: \"bg-cyan-500\",\r\n//   ButtonClicked: \"bg-green-500\",\r\n//   FlowSend: \"bg-indigo-500\",\r\n//   Redirect: \"bg-amber-500\",\r\n// };\r\n\r\n// const isClickEvent = t => t === \"ButtonClicked\" || t === \"Redirect\";\r\n// const isMessageEvent = t =>\r\n//   t === \"MessageSent\" || t === \"Delivered\" || t === \"Read\" || t === \"FlowSend\";\r\n\r\n// function ContactJourneyModal({ isOpen, onClose, log }) {\r\n//   const [journey, setJourney] = useState({ events: [] });\r\n//   const [loading, setLoading] = useState(false);\r\n//   const [filter, setFilter] = useState(\"all\"); // all | messages | clicks\r\n//   const [expanded, setExpanded] = useState(false);\r\n\r\n//   // âœ… safe fallback to avoid conditional return before hooks\r\n//   const safeLog = log || { contactName: \"Unknown\" };\r\n\r\n//   // Prefer explicit phone fields, then try to pull from contactName like \"WhatsApp User (+91â€¦)\"\r\n//   const displayPhone =\r\n//     log?.recipientNumber ||\r\n//     log?.contactPhone ||\r\n//     log?.to ||\r\n//     extractNumber(log?.contactName) ||\r\n//     \"Unknown\";\r\n\r\n//   useEffect(() => {\r\n//     if (isOpen && log?.id) {\r\n//       (async () => {\r\n//         setLoading(true);\r\n//         try {\r\n//           const res = await axiosClient.get(`/tracking/journeys/${log.id}`);\r\n//           const data = res.data;\r\n//           if (Array.isArray(data)) setJourney({ events: data });\r\n//           else setJourney(data || { events: [] });\r\n//         } catch (e) {\r\n//           console.error(\"Failed to fetch contact journey\", e);\r\n//           setJourney({ events: [] });\r\n//         } finally {\r\n//           setLoading(false);\r\n//         }\r\n//       })();\r\n//     }\r\n//   }, [isOpen, log]);\r\n\r\n//   useEffect(() => {\r\n//     if (isOpen) setExpanded(false);\r\n//   }, [isOpen]);\r\n\r\n//   const typeBadge =\r\n//     journey.campaignType === \"flow\" ? (\r\n//       <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-emerald-100 text-emerald-700 text-xs font-semibold\">\r\n//         Flow\r\n//       </span>\r\n//     ) : (\r\n//       <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-blue-100 text-blue-700 text-xs font-semibold\">\r\n//         Dynamic URL\r\n//       </span>\r\n//     );\r\n\r\n//   // filter view\r\n//   const eventsFiltered = useMemo(() => {\r\n//     const all = journey?.events || [];\r\n//     if (filter === \"messages\")\r\n//       return all.filter(e => isMessageEvent(e.eventType));\r\n//     if (filter === \"clicks\") return all.filter(e => isClickEvent(e.eventType));\r\n//     return all;\r\n//   }, [journey, filter]);\r\n\r\n//   // collapse logic\r\n//   const COLLAPSE_AFTER = 6;\r\n//   const eventsVisible =\r\n//     expanded || eventsFiltered.length <= COLLAPSE_AFTER\r\n//       ? eventsFiltered\r\n//       : eventsFiltered.slice(0, COLLAPSE_AFTER);\r\n\r\n//   const leftOff = journey?.leftOffAt;\r\n\r\n//   return (\r\n//     <Transition appear show={isOpen} as={Fragment}>\r\n//       <Dialog as=\"div\" className=\"relative z-50\" onClose={onClose}>\r\n//         <Transition.Child\r\n//           as={Fragment}\r\n//           enter=\"ease-out duration-300\"\r\n//           enterFrom=\"opacity-0\"\r\n//           enterTo=\"opacity-100\"\r\n//           leave=\"ease-in duration-200\"\r\n//           leaveFrom=\"opacity-100\"\r\n//           leaveTo=\"opacity-0\"\r\n//         >\r\n//           <div className=\"fixed inset-0 bg-black/40\" />\r\n//         </Transition.Child>\r\n\r\n//         <div className=\"fixed inset-0 overflow-y-hidden\">\r\n//           <div className=\"flex items-center justify-center min-h-full p-4\">\r\n//             <Transition.Child\r\n//               as={Fragment}\r\n//               enter=\"ease-out duration-300\"\r\n//               enterFrom=\"opacity-0 scale-95\"\r\n//               enterTo=\"opacity-100 scale-100\"\r\n//               leave=\"ease-in duration-200\"\r\n//               leaveFrom=\"opacity-100 scale-100\"\r\n//               leaveTo=\"opacity-0 scale-95\"\r\n//             >\r\n//               <Dialog.Panel className=\"w-full max-w-2xl flex flex-col max-h-[85vh] transform overflow-hidden rounded-xl bg-white shadow-xl transition-all\">\r\n//                 {/* Header */}\r\n//                 <Dialog.Title className=\"sticky top-0 z-10 bg-white/70 backdrop-blur px-6 pt-6 pb-3 text-lg font-semibold text-gray-800 flex items-center gap-2 border-b border-gray-200\">\r\n//                   <span className=\"text-purple-600\">ðŸ§­</span>\r\n//                   {/* ðŸ” Show only the phone number here */}\r\n//                   Contact Journey for {displayPhone}\r\n//                   {typeBadge}\r\n//                   <div className=\"ml-auto flex items-center gap-2\">\r\n//                     <Filter size={16} className=\"text-gray-400\" />\r\n//                     <div className=\"inline-flex rounded-lg border overflow-hidden\">\r\n//                       <button\r\n//                         className={`px-2 py-1 text-xs ${\r\n//                           filter === \"all\"\r\n//                             ? \"bg-gray-900 text-white\"\r\n//                             : \"bg-white\"\r\n//                         }`}\r\n//                         onClick={() => setFilter(\"all\")}\r\n//                       >\r\n//                         All\r\n//                       </button>\r\n//                       <button\r\n//                         className={`px-2 py-1 text-xs border-l ${\r\n//                           filter === \"messages\"\r\n//                             ? \"bg-gray-900 text-white\"\r\n//                             : \"bg-white\"\r\n//                         }`}\r\n//                         onClick={() => setFilter(\"messages\")}\r\n//                       >\r\n//                         Messages\r\n//                       </button>\r\n//                       <button\r\n//                         className={`px-2 py-1 text-xs border-l ${\r\n//                           filter === \"clicks\"\r\n//                             ? \"bg-gray-900 text-white\"\r\n//                             : \"bg-white\"\r\n//                         }`}\r\n//                         onClick={() => setFilter(\"clicks\")}\r\n//                       >\r\n//                         Clicks\r\n//                       </button>\r\n//                     </div>\r\n//                     <button\r\n//                       onClick={onClose}\r\n//                       className=\"ml-2 inline-flex items-center justify-center rounded-lg p-2 hover:bg-gray-100\"\r\n//                       aria-label=\"Close\"\r\n//                     >\r\n//                       <X size={16} />\r\n//                     </button>\r\n//                   </div>\r\n//                 </Dialog.Title>\r\n\r\n//                 {/* Body */}\r\n//                 <div className=\"flex-grow overflow-y-auto px-6\">\r\n//                   {loading ? (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       Loading journey...\r\n//                     </p>\r\n//                   ) : (eventsFiltered.length || 0) > 0 ? (\r\n//                     <>\r\n//                       {leftOff && (\r\n//                         <div className=\"mt-4 mb-2 text-xs text-gray-600\">\r\n//                           <span className=\"inline-flex items-center gap-1 rounded-full bg-amber-50 text-amber-700 px-2 py-1 font-semibold\">\r\n//                             Left off at:\r\n//                             <span className=\"text-amber-900\">{leftOff}</span>\r\n//                             {journey.flowName ? (\r\n//                               <span className=\"text-amber-700\">\r\n//                                 &nbsp;in{\" \"}\r\n//                                 <span className=\"font-bold\">\r\n//                                   {journey.flowName}\r\n//                                 </span>\r\n//                               </span>\r\n//                             ) : null}\r\n//                           </span>\r\n//                         </div>\r\n//                       )}\r\n\r\n//                       <div className=\"relative ml-4 py-6\">\r\n//                         <div className=\"absolute left-0 top-0 bottom-0 w-px bg-slate-200\" />\r\n//                         <div className=\"space-y-6\">\r\n//                           {eventsVisible.map((event, idx) => (\r\n//                             <JourneyEvent\r\n//                               key={idx}\r\n//                               isCurrent={\r\n//                                 leftOff && event?.title?.includes(leftOff)\r\n//                               }\r\n//                               event={event}\r\n//                             />\r\n//                           ))}\r\n//                         </div>\r\n//                       </div>\r\n\r\n//                       {eventsFiltered.length > COLLAPSE_AFTER && (\r\n//                         <div className=\"flex justify-center pt-2 pb-6\">\r\n//                           <button\r\n//                             onClick={() => setExpanded(v => !v)}\r\n//                             className=\"text-sm font-semibold text-purple-700 hover:text-purple-800\"\r\n//                           >\r\n//                             {expanded\r\n//                               ? \"Show less\"\r\n//                               : `Show ${\r\n//                                   eventsFiltered.length - COLLAPSE_AFTER\r\n//                                 } more events`}\r\n//                           </button>\r\n//                         </div>\r\n//                       )}\r\n//                     </>\r\n//                   ) : (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       No journey events found for this message.\r\n//                     </p>\r\n//                   )}\r\n//                 </div>\r\n\r\n//                 {/* Footer */}\r\n//                 <div className=\"flex-shrink-0 px-6 pt-3 pb-5 flex justify-end gap-3 border-t border-gray-200\">\r\n//                   <button\r\n//                     onClick={onClose}\r\n//                     className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm font-semibold\"\r\n//                   >\r\n//                     Close\r\n//                   </button>\r\n//                 </div>\r\n//               </Dialog.Panel>\r\n//             </Transition.Child>\r\n//           </div>\r\n//         </div>\r\n//       </Dialog>\r\n//     </Transition>\r\n//   );\r\n// }\r\n\r\n// const JourneyEvent = ({ event, isCurrent }) => {\r\n//   const icon = ICONS[event.eventType] || (\r\n//     <Hourglass size={16} className=\"text-white\" />\r\n//   );\r\n//   const color = COLORS[event.eventType] || \"bg-gray-400\";\r\n\r\n//   const handleCopy = () => {\r\n//     if (event.url) {\r\n//       navigator.clipboard?.writeText(event.url);\r\n//     }\r\n//   };\r\n\r\n//   const isClickable = Boolean(event.url);\r\n\r\n//   // Hide details for click-type events; keep for statuses/errors\r\n//   const shouldShowDetails = !(\r\n//     event.eventType === \"ButtonClicked\" || event.eventType === \"Redirect\"\r\n//   );\r\n\r\n//   return (\r\n//     <div className=\"relative pl-8\">\r\n//       <div\r\n//         className={`absolute -left-3 top-1 w-6 h-6 rounded-full flex items-center justify-center ring-4 ring-white ${color} ${\r\n//           isCurrent ? \"scale-110 shadow-lg\" : \"\"\r\n//         }`}\r\n//       >\r\n//         {icon}\r\n//       </div>\r\n\r\n//       <div\r\n//         className={`rounded-lg p-2 ${\r\n//           isCurrent ? \"bg-amber-50 border border-amber-200\" : \"bg-white\"\r\n//         }`}\r\n//       >\r\n//         <p className=\"font-semibold text-gray-800\">{event.title}</p>\r\n\r\n//         {shouldShowDetails && event.details && (\r\n//           <p className=\"text-sm text-gray-600 break-words\">{event.details}</p>\r\n//         )}\r\n\r\n//         {isClickable && (\r\n//           <p className=\"mt-1\">\r\n//             <a\r\n//               className=\"inline-flex items-center gap-1 text-blue-700 underline underline-offset-2\"\r\n//               href={event.url}\r\n//               target=\"_blank\"\r\n//               rel=\"noreferrer\"\r\n//               title={event.url}\r\n//             >\r\n//               <Link2 size={14} />\r\n//               {displayUrl(event.url)}\r\n//             </a>\r\n//             <button\r\n//               onClick={handleCopy}\r\n//               className=\"ml-2 inline-flex items-center gap-1 text-gray-500 hover:text-gray-700\"\r\n//               title=\"Copy URL\"\r\n//             >\r\n//               <Copy size={14} />\r\n//               <span className=\"text-xs\">Copy</span>\r\n//             </button>\r\n//           </p>\r\n//         )}\r\n\r\n//         <p className=\"text-xs text-gray-400 mt-2\">\r\n//           {formatDate(event.timestamp)} â€¢ {relTime(event.timestamp)}\r\n//         </p>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default ContactJourneyModal;\r\n\r\n// import React, { useEffect, useMemo, useState, Fragment } from \"react\";\r\n// import { Dialog, Transition } from \"@headlessui/react\";\r\n// import axiosClient from \"../../../api/axiosClient\";\r\n// import {\r\n//   Send,\r\n//   MousePointerClick,\r\n//   Hourglass,\r\n//   CheckCircle2,\r\n//   Eye,\r\n//   Share2,\r\n//   Link2,\r\n//   Copy,\r\n//   Filter,\r\n//   X,\r\n// } from \"lucide-react\";\r\n\r\n// const formatDate = dt => (dt ? new Date(dt).toLocaleString() : \"N/A\");\r\n\r\n// const relTime = iso => {\r\n//   if (!iso) return \"\";\r\n//   const diff = Date.now() - new Date(iso).getTime();\r\n//   const abs = Math.abs(diff);\r\n//   const mins = Math.floor(abs / (60 * 1000));\r\n//   if (mins < 1) return \"just now\";\r\n//   if (mins < 60) return `${mins}m ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n//   const hrs = Math.floor(mins / 60);\r\n//   if (hrs < 24) return `${hrs}h ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n//   const days = Math.floor(hrs / 24);\r\n//   return `${days}d ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n// };\r\n\r\n// const displayUrl = raw => {\r\n//   try {\r\n//     const u = new URL(raw);\r\n//     const tail =\r\n//       u.pathname.length > 1 ? u.pathname.split(\"/\").slice(-1)[0] : \"\";\r\n//     return `${u.hostname}${tail ? `/${tail}` : \"\"}`;\r\n//   } catch {\r\n//     return raw?.slice(0, 60) || \"\";\r\n//   }\r\n// };\r\n\r\n// const extractNumber = val => {\r\n//   if (!val) return null;\r\n//   const m = String(val).match(/(\\+?\\d[\\d\\s-]{5,}\\d)/);\r\n//   return m ? m[1].replace(/[\\s-]/g, \"\") : null;\r\n// };\r\n\r\n// const ICONS = {\r\n//   MessageSent: <Send size={16} className=\"text-white\" />,\r\n//   Delivered: <CheckCircle2 size={16} className=\"text-white\" />,\r\n//   Read: <Eye size={16} className=\"text-white\" />,\r\n//   ButtonClicked: <MousePointerClick size={16} className=\"text-white\" />,\r\n//   FlowSend: <Send size={16} className=\"text-white\" />,\r\n//   Redirect: <Share2 size={16} className=\"text-white\" />,\r\n// };\r\n\r\n// const COLORS = {\r\n//   MessageSent: \"bg-blue-500\",\r\n//   Delivered: \"bg-emerald-500\",\r\n//   Read: \"bg-cyan-500\",\r\n//   ButtonClicked: \"bg-green-500\",\r\n//   FlowSend: \"bg-indigo-500\",\r\n//   Redirect: \"bg-amber-500\",\r\n// };\r\n\r\n// const isClickEvent = t => t === \"ButtonClicked\" || t === \"Redirect\";\r\n// const isMessageEvent = t =>\r\n//   t === \"MessageSent\" || t === \"Delivered\" || t === \"Read\" || t === \"FlowSend\";\r\n\r\n// function ContactJourneyModal({ isOpen, onClose, log }) {\r\n//   const [journey, setJourney] = useState({ events: [] });\r\n//   const [loading, setLoading] = useState(false);\r\n//   const [filter, setFilter] = useState(\"all\");\r\n//   const [expanded, setExpanded] = useState(false);\r\n\r\n//   const displayPhone =\r\n//     log?.recipientNumber ||\r\n//     log?.contactPhone ||\r\n//     log?.to ||\r\n//     extractNumber(log?.contactName) ||\r\n//     \"Unknown\";\r\n\r\n//   useEffect(() => {\r\n//     if (isOpen && log?.id) {\r\n//       (async () => {\r\n//         setLoading(true);\r\n//         try {\r\n//           const res = await axiosClient.get(`/tracking/journeys/${log.id}`);\r\n//           const data = res.data;\r\n//           if (Array.isArray(data)) setJourney({ events: data });\r\n//           else setJourney(data || { events: [] });\r\n//         } catch (e) {\r\n//           console.error(\"Failed to fetch contact journey\", e);\r\n//           setJourney({ events: [] });\r\n//         } finally {\r\n//           setLoading(false);\r\n//         }\r\n//       })();\r\n//     }\r\n//   }, [isOpen, log]);\r\n\r\n//   useEffect(() => {\r\n//     if (isOpen) setExpanded(false);\r\n//   }, [isOpen]);\r\n\r\n//   const typeBadge =\r\n//     journey.campaignType === \"flow\" ? (\r\n//       <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-emerald-100 text-emerald-700 text-xs font-semibold\">\r\n//         Flow\r\n//       </span>\r\n//     ) : (\r\n//       <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-blue-100 text-blue-700 text-xs font-semibold\">\r\n//         Dynamic URL\r\n//       </span>\r\n//     );\r\n\r\n//   const eventsFiltered = useMemo(() => {\r\n//     const all = journey?.events || [];\r\n//     if (filter === \"messages\")\r\n//       return all.filter(e => isMessageEvent(e.eventType));\r\n//     if (filter === \"clicks\") return all.filter(e => isClickEvent(e.eventType));\r\n//     return all;\r\n//   }, [journey, filter]);\r\n\r\n//   const COLLAPSE_AFTER = 6;\r\n//   const eventsVisible =\r\n//     expanded || eventsFiltered.length <= COLLAPSE_AFTER\r\n//       ? eventsFiltered\r\n//       : eventsFiltered.slice(0, COLLAPSE_AFTER);\r\n\r\n//   const leftOff = journey?.leftOffAt;\r\n\r\n//   return (\r\n//     <Transition appear show={isOpen} as={Fragment}>\r\n//       <Dialog as=\"div\" className=\"relative z-50\" onClose={onClose}>\r\n//         <Transition.Child\r\n//           as={Fragment}\r\n//           enter=\"ease-out duration-300\"\r\n//           enterFrom=\"opacity-0\"\r\n//           enterTo=\"opacity-100\"\r\n//           leave=\"ease-in duration-200\"\r\n//           leaveFrom=\"opacity-100\"\r\n//           leaveTo=\"opacity-0\"\r\n//         >\r\n//           <div className=\"fixed inset-0 bg-black/40\" />\r\n//         </Transition.Child>\r\n\r\n//         <div className=\"fixed inset-0 overflow-y-hidden\">\r\n//           <div className=\"flex items-center justify-center min-h-full p-4\">\r\n//             <Transition.Child\r\n//               as={Fragment}\r\n//               enter=\"ease-out duration-300\"\r\n//               enterFrom=\"opacity-0 scale-95\"\r\n//               enterTo=\"opacity-100 scale-100\"\r\n//               leave=\"ease-in duration-200\"\r\n//               leaveFrom=\"opacity-100 scale-100\"\r\n//               leaveTo=\"opacity-0 scale-95\"\r\n//             >\r\n//               <Dialog.Panel className=\"w-full max-w-2xl flex flex-col max-h-[85vh] transform overflow-hidden rounded-xl bg-white shadow-xl transition-all\">\r\n//                 {/* Header */}\r\n//                 <Dialog.Title className=\"sticky top-0 z-10 bg-white/70 backdrop-blur px-6 pt-6 pb-2 text-base font-semibold text-gray-800 flex items-center gap-2 border-b border-gray-200\">\r\n//                   <span className=\"text-purple-600\">ðŸ§­</span>\r\n//                   Contact Journey for {displayPhone}\r\n//                   {typeBadge}\r\n//                   <div className=\"ml-auto flex items-center gap-2\">\r\n//                     <Filter size={16} className=\"text-gray-400\" />\r\n//                     <div className=\"inline-flex rounded-lg border overflow-hidden\">\r\n//                       <button\r\n//                         className={`px-2 py-1 text-xs ${\r\n//                           filter === \"all\"\r\n//                             ? \"bg-gray-900 text-white\"\r\n//                             : \"bg-white\"\r\n//                         }`}\r\n//                         onClick={() => setFilter(\"all\")}\r\n//                       >\r\n//                         All\r\n//                       </button>\r\n//                       <button\r\n//                         className={`px-2 py-1 text-xs border-l ${\r\n//                           filter === \"messages\"\r\n//                             ? \"bg-gray-900 text-white\"\r\n//                             : \"bg-white\"\r\n//                         }`}\r\n//                         onClick={() => setFilter(\"messages\")}\r\n//                       >\r\n//                         Messages\r\n//                       </button>\r\n//                       <button\r\n//                         className={`px-2 py-1 text-xs border-l ${\r\n//                           filter === \"clicks\"\r\n//                             ? \"bg-gray-900 text-white\"\r\n//                             : \"bg-white\"\r\n//                         }`}\r\n//                         onClick={() => setFilter(\"clicks\")}\r\n//                       >\r\n//                         Clicks\r\n//                       </button>\r\n//                     </div>\r\n//                     <button\r\n//                       onClick={onClose}\r\n//                       className=\"ml-2 inline-flex items-center justify-center rounded-lg p-2 hover:bg-gray-100\"\r\n//                       aria-label=\"Close\"\r\n//                     >\r\n//                       <X size={16} />\r\n//                     </button>\r\n//                   </div>\r\n//                 </Dialog.Title>\r\n\r\n//                 {/* Body */}\r\n//                 <div className=\"flex-grow overflow-y-auto px-6\">\r\n//                   {loading ? (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       Loading journey...\r\n//                     </p>\r\n//                   ) : (eventsFiltered.length || 0) > 0 ? (\r\n//                     <>\r\n//                       {leftOff && (\r\n//                         <div className=\"mt-3 mb-2 text-xs text-gray-600\">\r\n//                           <span className=\"inline-flex items-center gap-1 rounded-full bg-amber-50 text-amber-700 px-2 py-1 font-semibold\">\r\n//                             Left off at:\r\n//                             <span className=\"text-amber-900\">{leftOff}</span>\r\n//                             {journey.flowName ? (\r\n//                               <span className=\"text-amber-700\">\r\n//                                 &nbsp;in{\" \"}\r\n//                                 <span className=\"font-bold\">\r\n//                                   {journey.flowName}\r\n//                                 </span>\r\n//                               </span>\r\n//                             ) : null}\r\n//                           </span>\r\n//                         </div>\r\n//                       )}\r\n\r\n//                       <div className=\"relative ml-3 py-3\">\r\n//                         <div className=\"absolute left-0 top-0 bottom-0 w-px bg-slate-200\" />\r\n//                         <div className=\"space-y-3\">\r\n//                           {eventsVisible.map((event, idx) => (\r\n//                             <JourneyEvent\r\n//                               key={idx}\r\n//                               isCurrent={\r\n//                                 leftOff && event?.title?.includes(leftOff)\r\n//                               }\r\n//                               event={event}\r\n//                             />\r\n//                           ))}\r\n//                         </div>\r\n//                       </div>\r\n\r\n//                       {eventsFiltered.length > COLLAPSE_AFTER && (\r\n//                         <div className=\"flex justify-center pt-2 pb-4\">\r\n//                           <button\r\n//                             onClick={() => setExpanded(v => !v)}\r\n//                             className=\"text-sm font-semibold text-purple-700 hover:text-purple-800\"\r\n//                           >\r\n//                             {expanded\r\n//                               ? \"Show less\"\r\n//                               : `Show ${\r\n//                                   eventsFiltered.length - COLLAPSE_AFTER\r\n//                                 } more events`}\r\n//                           </button>\r\n//                         </div>\r\n//                       )}\r\n//                     </>\r\n//                   ) : (\r\n//                     <p className=\"text-center text-gray-500 py-8\">\r\n//                       No journey events found for this message.\r\n//                     </p>\r\n//                   )}\r\n//                 </div>\r\n\r\n//                 {/* Footer */}\r\n//                 <div className=\"flex-shrink-0 px-6 pt-2 pb-4 flex justify-end gap-3 border-t border-gray-200\">\r\n//                   <button\r\n//                     onClick={onClose}\r\n//                     className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm font-semibold\"\r\n//                   >\r\n//                     Close\r\n//                   </button>\r\n//                 </div>\r\n//               </Dialog.Panel>\r\n//             </Transition.Child>\r\n//           </div>\r\n//         </div>\r\n//       </Dialog>\r\n//     </Transition>\r\n//   );\r\n// }\r\n\r\n// const JourneyEvent = ({ event, isCurrent }) => {\r\n//   const icon = ICONS[event.eventType] || (\r\n//     <Hourglass size={16} className=\"text-white\" />\r\n//   );\r\n//   const color = COLORS[event.eventType] || \"bg-gray-400\";\r\n\r\n//   const handleCopy = () => {\r\n//     if (event.url) {\r\n//       navigator.clipboard?.writeText(event.url);\r\n//     }\r\n//   };\r\n\r\n//   const isClickable = Boolean(event.url);\r\n//   const shouldShowDetails = !(\r\n//     event.eventType === \"ButtonClicked\" || event.eventType === \"Redirect\"\r\n//   );\r\n\r\n//   return (\r\n//     <div className=\"relative pl-6\">\r\n//       <div\r\n//         className={`absolute -left-3 top-1 w-6 h-6 rounded-full flex items-center justify-center ring-4 ring-white ${color} ${\r\n//           isCurrent ? \"scale-110 shadow-lg\" : \"\"\r\n//         }`}\r\n//       >\r\n//         {icon}\r\n//       </div>\r\n\r\n//       <div\r\n//         className={`rounded-lg p-1.5 ${\r\n//           isCurrent ? \"bg-amber-50 border border-amber-200\" : \"bg-white\"\r\n//         }`}\r\n//       >\r\n//         <p className=\"font-semibold text-gray-800\">{event.title}</p>\r\n\r\n//         {shouldShowDetails && event.details && (\r\n//           <p className=\"text-sm text-gray-600 break-words\">{event.details}</p>\r\n//         )}\r\n\r\n//         {isClickable && (\r\n//           <p className=\"mt-1\">\r\n//             <a\r\n//               className=\"inline-flex items-center gap-1 text-blue-700 underline underline-offset-2\"\r\n//               href={event.url}\r\n//               target=\"_blank\"\r\n//               rel=\"noreferrer\"\r\n//               title={event.url}\r\n//             >\r\n//               <Link2 size={14} />\r\n//               {displayUrl(event.url)}\r\n//             </a>\r\n//             <button\r\n//               onClick={handleCopy}\r\n//               className=\"ml-2 inline-flex items-center gap-1 text-gray-500 hover:text-gray-700\"\r\n//               title=\"Copy URL\"\r\n//             >\r\n//               <Copy size={14} />\r\n//               <span className=\"text-xs\">Copy</span>\r\n//             </button>\r\n//           </p>\r\n//         )}\r\n\r\n//         <p className=\"text-xs text-gray-400 mt-1\">\r\n//           {formatDate(event.timestamp)} â€¢ {relTime(event.timestamp)}\r\n//         </p>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default ContactJourneyModal;\r\n// ðŸ“„ src/pages/campaigns/components/ContactJourneyModal.jsx\r\nimport React, { useEffect, useMemo, useState, Fragment } from \"react\";\r\nimport { Dialog, Transition } from \"@headlessui/react\";\r\nimport axiosClient from \"../../../api/axiosClient\";\r\nimport { toast } from \"react-toastify\";\r\nimport {\r\n  Send,\r\n  MousePointerClick,\r\n  Hourglass,\r\n  CheckCircle2,\r\n  Eye,\r\n  Share2,\r\n  Link2,\r\n  Copy,\r\n  Filter,\r\n  X,\r\n} from \"lucide-react\";\r\n\r\nconst formatDate = dt => (dt ? new Date(dt).toLocaleString() : \"N/A\");\r\n\r\nconst relTime = iso => {\r\n  if (!iso) return \"\";\r\n  const diff = Date.now() - new Date(iso).getTime();\r\n  const abs = Math.abs(diff);\r\n  const mins = Math.floor(abs / (60 * 1000));\r\n  if (mins < 1) return \"just now\";\r\n  if (mins < 60) return `${mins}m ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n  const hrs = Math.floor(mins / 60);\r\n  if (hrs < 24) return `${hrs}h ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n  const days = Math.floor(hrs / 24);\r\n  return `${days}d ${diff < 0 ? \"from now\" : \"ago\"}`;\r\n};\r\n\r\nconst displayUrl = raw => {\r\n  try {\r\n    const u = new URL(raw);\r\n    const tail =\r\n      u.pathname.length > 1 ? u.pathname.split(\"/\").slice(-1)[0] : \"\";\r\n    return `${u.hostname}${tail ? `/${tail}` : \"\"}`;\r\n  } catch {\r\n    return raw?.slice(0, 60) || \"\";\r\n  }\r\n};\r\n\r\n/** Pull a phone-like token out of free text (e.g. \"WhatsApp User (+91 987...)\"). */\r\nconst extractNumberLoose = val => {\r\n  if (!val) return null;\r\n  const m = String(val).match(/(\\+?\\d[\\d\\s\\-()]{5,}\\d)/);\r\n  return m ? m[1] : null;\r\n};\r\n\r\n/** Normalize for display as E.164-like: keep leading \"+\", strip other non-digits; if no \"+\", prepend it. */\r\nconst normalizeE164 = raw => {\r\n  if (!raw) return \"\";\r\n  let s = String(raw).trim();\r\n  const hasPlus = s.startsWith(\"+\");\r\n  s = (hasPlus ? \"+\" : \"\") + s.replace(/[^\\d]/g, \"\");\r\n  if (!s.startsWith(\"+\")) s = \"+\" + s;\r\n  return s;\r\n};\r\n\r\nconst ICONS = {\r\n  MessageSent: <Send size={16} className=\"text-white\" />,\r\n  Delivered: <CheckCircle2 size={16} className=\"text-white\" />,\r\n  Read: <Eye size={16} className=\"text-white\" />,\r\n  ButtonClicked: <MousePointerClick size={16} className=\"text-white\" />,\r\n  FlowSend: <Send size={16} className=\"text-white\" />,\r\n  Redirect: <Share2 size={16} className=\"text-white\" />,\r\n};\r\n\r\nconst COLORS = {\r\n  MessageSent: \"bg-blue-500\",\r\n  Delivered: \"bg-emerald-500\",\r\n  Read: \"bg-cyan-500\",\r\n  ButtonClicked: \"bg-green-500\",\r\n  FlowSend: \"bg-indigo-500\",\r\n  Redirect: \"bg-amber-500\",\r\n};\r\n\r\nconst isClickEvent = t => t === \"ButtonClicked\" || t === \"Redirect\";\r\nconst isMessageEvent = t =>\r\n  t === \"MessageSent\" || t === \"Delivered\" || t === \"Read\" || t === \"FlowSend\";\r\n\r\nfunction ContactJourneyModal({ isOpen, onClose, log }) {\r\n  const [journey, setJourney] = useState({ events: [] });\r\n  const [loading, setLoading] = useState(false);\r\n  const [filter, setFilter] = useState(\"all\");\r\n  const [expanded, setExpanded] = useState(false);\r\n  const [errorText, setErrorText] = useState(\"\");\r\n\r\n  // Prefer backend-resolved phone, then log fields, then loose extraction; finally normalize to +E.164 for display.\r\n  const rawPhoneCandidate =\r\n    journey?.contactPhone ||\r\n    log?.recipientNumber ||\r\n    log?.contactPhone ||\r\n    log?.to ||\r\n    extractNumberLoose(log?.contactName) ||\r\n    \"\";\r\n  const displayPhone = normalizeE164(rawPhoneCandidate) || \"Unknown\";\r\n\r\n  useEffect(() => {\r\n    if (!isOpen || !log) return;\r\n\r\n    // Prefer CampaignSendLogId (audience uploads), fall back to id\r\n    const cslId = log.campaignSendLogId || log.id;\r\n    if (!cslId) return;\r\n\r\n    (async () => {\r\n      setLoading(true);\r\n      setErrorText(\"\");\r\n      try {\r\n        const res = await axiosClient.get(`/tracking/journeys/${cslId}`);\r\n        const data = res.data;\r\n        setJourney(\r\n          Array.isArray(data) ? { events: data } : data || { events: [] }\r\n        );\r\n      } catch (err) {\r\n        const raw =\r\n          err?.response?.data?.message ||\r\n          err?.response?.data?.title ||\r\n          err?.message ||\r\n          \"\";\r\n        const isEmptyProjection =\r\n          typeof raw === \"string\" &&\r\n          raw.toLowerCase().includes(\"emptyprojectionmember\");\r\n\r\n        if (isEmptyProjection) {\r\n          console.warn(\"[Journey] Backend EF error:\", raw);\r\n          setErrorText(\r\n            \"Journey data is temporarily unavailable. Please try again after a refresh.\"\r\n          );\r\n        } else {\r\n          setErrorText(raw || \"Failed to fetch contact journey.\");\r\n          toast.error(`ðŸš¨ ${raw || \"Failed to fetch contact journey\"}`);\r\n        }\r\n        setJourney({ events: [] });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n  }, [isOpen, log]);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) setExpanded(false);\r\n  }, [isOpen]);\r\n\r\n  const typeBadge =\r\n    journey.campaignType === \"flow\" ? (\r\n      <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-emerald-100 text-emerald-700 text-xs font-semibold\">\r\n        Flow\r\n      </span>\r\n    ) : (\r\n      <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-blue-100 text-blue-700 text-xs font-semibold\">\r\n        Dynamic URL\r\n      </span>\r\n    );\r\n\r\n  const eventsFiltered = useMemo(() => {\r\n    const all = journey?.events || [];\r\n    if (filter === \"messages\")\r\n      return all.filter(e => isMessageEvent(e.eventType));\r\n    if (filter === \"clicks\") return all.filter(e => isClickEvent(e.eventType));\r\n    return all;\r\n  }, [journey, filter]);\r\n\r\n  const COLLAPSE_AFTER = 6;\r\n  const eventsVisible =\r\n    expanded || eventsFiltered.length <= COLLAPSE_AFTER\r\n      ? eventsFiltered\r\n      : eventsFiltered.slice(0, COLLAPSE_AFTER);\r\n\r\n  const leftOff = journey?.leftOffAt;\r\n\r\n  return (\r\n    <Transition appear show={isOpen} as={Fragment}>\r\n      <Dialog as=\"div\" className=\"relative z-50\" onClose={onClose}>\r\n        <Transition.Child\r\n          as={Fragment}\r\n          enter=\"ease-out duration-300\"\r\n          enterFrom=\"opacity-0\"\r\n          enterTo=\"opacity-100\"\r\n          leave=\"ease-in duration-200\"\r\n          leaveFrom=\"opacity-100\"\r\n          leaveTo=\"opacity-0\"\r\n        >\r\n          <div className=\"fixed inset-0 bg-black/40\" />\r\n        </Transition.Child>\r\n\r\n        <div className=\"fixed inset-0 overflow-y-hidden\">\r\n          <div className=\"flex items-center justify-center min-h-full p-4\">\r\n            <Transition.Child\r\n              as={Fragment}\r\n              enter=\"ease-out duration-300\"\r\n              enterFrom=\"opacity-0 scale-95\"\r\n              enterTo=\"opacity-100 scale-100\"\r\n              leave=\"ease-in duration-200\"\r\n              leaveFrom=\"opacity-100 scale-100\"\r\n              leaveTo=\"opacity-0 scale-95\"\r\n            >\r\n              <Dialog.Panel className=\"w-full max-w-2xl flex flex-col max-h-[85vh] transform overflow-hidden rounded-xl bg-white shadow-xl transition-all\">\r\n                {/* Header */}\r\n                <Dialog.Title className=\"sticky top-0 z-10 bg-white/70 backdrop-blur px-6 pt-6 pb-2 text-base font-semibold text-gray-800 flex items-center gap-2 border-b border-gray-200\">\r\n                  <span className=\"text-purple-600\">ðŸ§­</span>\r\n                  Contact Journey for {displayPhone}\r\n                  {typeBadge}\r\n                  <div className=\"ml-auto flex items-center gap-2\">\r\n                    <Filter size={16} className=\"text-gray-400\" />\r\n                    <div className=\"inline-flex rounded-lg border overflow-hidden\">\r\n                      <button\r\n                        className={`px-2 py-1 text-xs ${\r\n                          filter === \"all\"\r\n                            ? \"bg-gray-900 text-white\"\r\n                            : \"bg-white\"\r\n                        }`}\r\n                        onClick={() => setFilter(\"all\")}\r\n                      >\r\n                        All\r\n                      </button>\r\n                      <button\r\n                        className={`px-2 py-1 text-xs border-l ${\r\n                          filter === \"messages\"\r\n                            ? \"bg-gray-900 text-white\"\r\n                            : \"bg-white\"\r\n                        }`}\r\n                        onClick={() => setFilter(\"messages\")}\r\n                      >\r\n                        Messages\r\n                      </button>\r\n                      <button\r\n                        className={`px-2 py-1 text-xs border-l ${\r\n                          filter === \"clicks\"\r\n                            ? \"bg-gray-900 text-white\"\r\n                            : \"bg-white\"\r\n                        }`}\r\n                        onClick={() => setFilter(\"clicks\")}\r\n                      >\r\n                        Clicks\r\n                      </button>\r\n                    </div>\r\n                    <button\r\n                      onClick={onClose}\r\n                      className=\"ml-2 inline-flex items-center justify-center rounded-lg p-2 hover:bg-gray-100\"\r\n                      aria-label=\"Close\"\r\n                    >\r\n                      <X size={16} />\r\n                    </button>\r\n                  </div>\r\n                </Dialog.Title>\r\n\r\n                {/* Body */}\r\n                <div className=\"flex-grow overflow-y-auto px-6\">\r\n                  {loading ? (\r\n                    <p className=\"text-center text-gray-500 py-8\">\r\n                      Loading journey...\r\n                    </p>\r\n                  ) : errorText ? (\r\n                    <div className=\"py-8\">\r\n                      <p className=\"text-center text-amber-700 bg-amber-50 border border-amber-200 rounded p-3 text-sm\">\r\n                        {errorText}\r\n                      </p>\r\n                    </div>\r\n                  ) : (eventsFiltered.length || 0) > 0 ? (\r\n                    <>\r\n                      {leftOff && (\r\n                        <div className=\"mt-3 mb-2 text-xs text-gray-600\">\r\n                          <span className=\"inline-flex items-center gap-1 rounded-full bg-amber-50 text-amber-700 px-2 py-1 font-semibold\">\r\n                            Left off at:{\" \"}\r\n                            <span className=\"text-amber-900\">{leftOff}</span>\r\n                            {journey.flowName ? (\r\n                              <span className=\"text-amber-700\">\r\n                                &nbsp;in{\" \"}\r\n                                <span className=\"font-bold\">\r\n                                  {journey.flowName}\r\n                                </span>\r\n                              </span>\r\n                            ) : null}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n\r\n                      <div className=\"relative ml-3 py-3\">\r\n                        <div className=\"absolute left-0 top-0 bottom-0 w-px bg-slate-200\" />\r\n                        <div className=\"space-y-3\">\r\n                          {eventsVisible.map((event, idx) => (\r\n                            <JourneyEvent\r\n                              key={idx}\r\n                              isCurrent={\r\n                                leftOff && event?.title?.includes(leftOff)\r\n                              }\r\n                              event={event}\r\n                            />\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n\r\n                      {eventsFiltered.length > COLLAPSE_AFTER && (\r\n                        <div className=\"flex justify-center pt-2 pb-4\">\r\n                          <button\r\n                            onClick={() => setExpanded(v => !v)}\r\n                            className=\"text-sm font-semibold text-purple-700 hover:text-purple-800\"\r\n                          >\r\n                            {expanded\r\n                              ? \"Show less\"\r\n                              : `Show ${\r\n                                  eventsFiltered.length - COLLAPSE_AFTER\r\n                                } more events`}\r\n                          </button>\r\n                        </div>\r\n                      )}\r\n                    </>\r\n                  ) : (\r\n                    <p className=\"text-center text-gray-500 py-8\">\r\n                      No journey events found for this message.\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"flex-shrink-0 px-6 pt-2 pb-4 flex justify-end gap-3 border-t border-gray-200\">\r\n                  <button\r\n                    onClick={onClose}\r\n                    className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm font-semibold\"\r\n                  >\r\n                    Close\r\n                  </button>\r\n                </div>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </div>\r\n      </Dialog>\r\n    </Transition>\r\n  );\r\n}\r\n\r\nconst JourneyEvent = ({ event, isCurrent }) => {\r\n  const icon = ICONS[event.eventType] || (\r\n    <Hourglass size={16} className=\"text-white\" />\r\n  );\r\n  const color = COLORS[event.eventType] || \"bg-gray-400\";\r\n\r\n  const handleCopy = () => {\r\n    if (event.url) navigator.clipboard?.writeText(event.url);\r\n  };\r\n\r\n  const isClickable = Boolean(event.url);\r\n  const shouldShowDetails = !(\r\n    event.eventType === \"ButtonClicked\" || event.eventType === \"Redirect\"\r\n  );\r\n\r\n  return (\r\n    <div className=\"relative pl-6\">\r\n      <div\r\n        className={`absolute -left-3 top-1 w-6 h-6 rounded-full flex items-center justify-center ring-4 ring-white ${color} ${\r\n          isCurrent ? \"scale-110 shadow-lg\" : \"\"\r\n        }`}\r\n      >\r\n        {icon}\r\n      </div>\r\n\r\n      <div\r\n        className={`rounded-lg p-1.5 ${\r\n          isCurrent ? \"bg-amber-50 border border-amber-200\" : \"bg-white\"\r\n        }`}\r\n      >\r\n        <p className=\"font-semibold text-gray-800\">{event.title}</p>\r\n\r\n        {shouldShowDetails && event.details && (\r\n          <p className=\"text-sm text-gray-600 break-words\">{event.details}</p>\r\n        )}\r\n\r\n        {isClickable && (\r\n          <p className=\"mt-1\">\r\n            <a\r\n              className=\"inline-flex items-center gap-1 text-blue-700 underline underline-offset-2\"\r\n              href={event.url}\r\n              target=\"_blank\"\r\n              rel=\"noreferrer\"\r\n              title={event.url}\r\n            >\r\n              <Link2 size={14} />\r\n              {displayUrl(event.url)}\r\n            </a>\r\n            <button\r\n              onClick={handleCopy}\r\n              className=\"ml-2 inline-flex items-center gap-1 text-gray-500 hover:text-gray-700\"\r\n              title=\"Copy URL\"\r\n            >\r\n              <Copy size={14} />\r\n              <span className=\"text-xs\">Copy</span>\r\n            </button>\r\n          </p>\r\n        )}\r\n\r\n        <p className=\"text-xs text-gray-400 mt-1\">\r\n          {formatDate(event.timestamp)} â€¢ {relTime(event.timestamp)}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ContactJourneyModal;\r\n","// ðŸ“„ src/pages/campaigns/CampaignSendLogs.jsx\r\nimport React, { useEffect, useState, useCallback } from \"react\";\r\nimport { useParams, Link } from \"react-router-dom\";\r\nimport axiosClient from \"../../api/axiosClient\";\r\nimport { toast } from \"react-toastify\";\r\nimport { saveAs } from \"file-saver\";\r\nimport { confirmAlert } from \"react-confirm-alert\";\r\nimport \"react-confirm-alert/src/react-confirm-alert.css\";\r\nimport MessagePreviewModal from \"./components/MessagePreviewModal\";\r\nimport CampaignSummaryBar from \"./components/CampaignSummaryBar\";\r\nimport ContactJourneyModal from \"./components/ContactJourneyModal\";\r\n\r\nfunction CampaignSendLogs() {\r\n  const { campaignId } = useParams();\r\n\r\n  // data\r\n  const [logs, setLogs] = useState([]);\r\n  const [summary, setSummary] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // filters/paging\r\n  const [search, setSearch] = useState(\"\");\r\n  const [statusFilter, setStatusFilter] = useState(\"\");\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize] = useState(10);\r\n  const [totalPages, setTotalPages] = useState(0);\r\n  const [totalLogs, setTotalLogs] = useState(0);\r\n\r\n  // modals\r\n  const [previewOpen, setPreviewOpen] = useState(false);\r\n  const [selectedLog, setSelectedLog] = useState(null);\r\n  const [isJourneyOpen, setIsJourneyOpen] = useState(false);\r\n  const [journeyLog, setJourneyLog] = useState(null);\r\n\r\n  // --- helpers ---\r\n  // Prefer contactPhone when it's a real value; otherwise fall back to recipientNumber / to.\r\n  const getDisplayPhone = log => {\r\n    const clean = v => (typeof v === \"string\" ? v.trim() : v);\r\n    const p = clean(log?.contactPhone);\r\n    if (p && p !== \"-\" && p.toLowerCase() !== \"n/a\") return p;\r\n    const r = clean(log?.recipientNumber) || clean(log?.to);\r\n    return r || \"\"; // empty if truly unavailable\r\n  };\r\n\r\n  // --- fetching ---\r\n  const fetchLogs = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const params = new URLSearchParams({\r\n        page,\r\n        pageSize,\r\n        status: statusFilter,\r\n        search,\r\n      });\r\n      const res = await axiosClient.get(\r\n        `/campaign-logs/campaign/${campaignId}?${params.toString()}`\r\n      );\r\n      setLogs(res.data.items || []);\r\n      setTotalLogs(res.data.totalCount || 0);\r\n      setTotalPages(res.data.totalPages || 0);\r\n    } catch {\r\n      toast.error(\"âŒ Failed to load send logs\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [campaignId, page, pageSize, statusFilter, search]);\r\n\r\n  const fetchSummary = useCallback(async () => {\r\n    try {\r\n      const res = await axiosClient.get(\r\n        `/campaign-logs/campaign/${campaignId}/summary`\r\n      );\r\n      setSummary(res.data.data || res.data);\r\n    } catch {\r\n      console.error(\"âŒ Failed to fetch summary\");\r\n    }\r\n  }, [campaignId]);\r\n\r\n  useEffect(() => {\r\n    const t = setTimeout(fetchLogs, 500);\r\n    return () => clearTimeout(t);\r\n  }, [fetchLogs]);\r\n\r\n  useEffect(() => {\r\n    fetchSummary();\r\n  }, [fetchSummary]);\r\n\r\n  // --- handlers ---\r\n  const handleStatusChange = e => {\r\n    setStatusFilter(e.target.value);\r\n    setPage(1);\r\n  };\r\n  const handleSearchChange = e => {\r\n    setSearch(e.target.value);\r\n    setPage(1);\r\n  };\r\n\r\n  const handleExport = () => {\r\n    const headers = [\r\n      \"Contact Phone\",\r\n      \"Status\",\r\n      \"Channel\",\r\n      \"Sent At\",\r\n      \"Delivered\",\r\n      \"Read\",\r\n      \"Clicked\",\r\n      \"Click Type\",\r\n    ];\r\n    const csvRows = [\r\n      headers,\r\n      ...logs.map(log => [\r\n        getDisplayPhone(log), // âœ… phone only\r\n        log.sendStatus,\r\n        log.sourceChannel,\r\n        log.sentAt ? new Date(log.sentAt).toLocaleString() : \"\",\r\n        log.deliveredAt ? new Date(log.deliveredAt).toLocaleString() : \"\",\r\n        log.readAt ? new Date(log.readAt).toLocaleString() : \"\",\r\n        log.isClicked ? \"Yes\" : \"No\",\r\n        log.clickType || \"\",\r\n      ]),\r\n    ];\r\n    const blob = new Blob([csvRows.map(r => r.join(\",\")).join(\"\\n\")], {\r\n      type: \"text/csv\",\r\n    });\r\n    saveAs(blob, `CampaignLogs-${campaignId}.csv`);\r\n  };\r\n\r\n  const handleRetrySingle = logId => {\r\n    confirmAlert({\r\n      title: \"Retry This Message?\",\r\n      message: \"Are you sure you want to retry this failed message?\",\r\n      buttons: [\r\n        {\r\n          label: \"Yes\",\r\n          onClick: async () => {\r\n            try {\r\n              await axiosClient.post(`/campaign-logs/${logId}/retry`);\r\n              toast.success(\"âœ… Retry triggered\");\r\n              fetchLogs();\r\n              fetchSummary();\r\n            } catch {\r\n              toast.error(\"âŒ Retry failed\");\r\n            }\r\n          },\r\n        },\r\n        { label: \"Cancel\" },\r\n      ],\r\n    });\r\n  };\r\n\r\n  const handleRetryAll = () => {\r\n    confirmAlert({\r\n      title: \"Retry All Failed Messages?\",\r\n      message:\r\n        \"This will retry all failed messages in this campaign. Continue?\",\r\n      buttons: [\r\n        {\r\n          label: \"Yes\",\r\n          onClick: async () => {\r\n            try {\r\n              const res = await axiosClient.post(\r\n                `/campaign-logs/campaign/${campaignId}/retry-all`\r\n              );\r\n              toast.success(`âœ… Retried ${res.data.retried} messages`);\r\n              fetchLogs();\r\n              fetchSummary();\r\n            } catch {\r\n              toast.error(\"âŒ Retry failed\");\r\n            }\r\n          },\r\n        },\r\n        { label: \"Cancel\" },\r\n      ],\r\n    });\r\n  };\r\n\r\n  const openPreview = log => {\r\n    setSelectedLog(log);\r\n    setPreviewOpen(true);\r\n  };\r\n  const closePreview = () => {\r\n    setPreviewOpen(false);\r\n    setSelectedLog(null);\r\n  };\r\n\r\n  // --- render ---\r\n  return (\r\n    <div className=\"p-6 bg-[#f5f6f7] min-h-[calc(100vh-80px)]\">\r\n      <div className=\"flex justify-between items-center mb-4\">\r\n        <h1 className=\"text-2xl font-bold text-purple-700\">\r\n          ðŸ“¨ Send Logs for Campaign\r\n        </h1>\r\n        <Link\r\n          to=\"/app/campaigns/template-campaigns-list\"\r\n          className=\"inline-flex items-center gap-2 rounded-lg border px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-50 transition\"\r\n        >\r\n          <span className=\"text-lg\">â†</span> Back to Campaigns\r\n        </Link>\r\n      </div>\r\n\r\n      <CampaignSummaryBar summary={summary} />\r\n\r\n      <div className=\"grid md:grid-cols-4 gap-4 mb-4\">\r\n        <input\r\n          className=\"border px-3 py-2 rounded\"\r\n          placeholder=\"ðŸ” Search by name or phone\"\r\n          onChange={handleSearchChange}\r\n        />\r\n        <select\r\n          className=\"border px-3 py-2 rounded\"\r\n          value={statusFilter}\r\n          onChange={handleStatusChange}\r\n        >\r\n          <option value=\"\">All Statuses</option>\r\n          <option value=\"Sent\">Sent</option>\r\n          <option value=\"Delivered\">Delivered</option>\r\n          <option value=\"Read\">Read</option>\r\n          <option value=\"Queued\">Queued</option>\r\n          <option value=\"Failed\">Failed</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"mb-4 flex justify-between\">\r\n        <p className=\"text-sm text-gray-500\">\r\n          Showing {logs.length} of {totalLogs} logs\r\n        </p>\r\n        <div className=\"space-x-2\">\r\n          <button\r\n            onClick={handleExport}\r\n            className=\"bg-emerald-600 text-white text-sm px-3 py-1 rounded hover:bg-emerald-700\"\r\n          >\r\n            â¬‡ Export CSV\r\n          </button>\r\n          <button\r\n            onClick={handleRetryAll}\r\n            className=\"bg-purple-600 text-white text-sm px-3 py-1 rounded hover:bg-purple-700\"\r\n          >\r\n            ðŸ” Retry All Failed\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {loading ? (\r\n        <p>Loading logs...</p>\r\n      ) : logs.length === 0 ? (\r\n        <p className=\"text-gray-500\">No logs found with current filters.</p>\r\n      ) : (\r\n        <div className=\"overflow-x-auto bg-white shadow rounded\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead className=\"bg-gray-100 text-left\">\r\n              <tr>\r\n                <th className=\"p-2\">Contact</th>\r\n                <th className=\"p-2\">Status</th>\r\n                <th className=\"p-2\">Channel</th>\r\n                <th className=\"p-2\">Sent</th>\r\n                <th className=\"p-2\">Clicked</th>\r\n                <th className=\"p-2\">Click Type</th>\r\n                <th className=\"p-2\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {logs.map(log => (\r\n                <tr key={log.id} className=\"border-t hover:bg-gray-50\">\r\n                  <td className=\"p-2\">\r\n                    {/* âœ… phone only â€“ no N/A, no parentheses */}\r\n                    {getDisplayPhone(log) || \"-\"}\r\n                  </td>\r\n                  <td className=\"p-2\">{log.sendStatus || \"-\"}</td>\r\n                  <td className=\"p-2\">{log.sourceChannel || \"-\"}</td>\r\n                  <td className=\"p-2\">\r\n                    {log.sentAt ? new Date(log.sentAt).toLocaleString() : \"-\"}\r\n                  </td>\r\n                  <td className=\"p-2\">{log.isClicked ? \"âœ… Yes\" : \"âŒ No\"}</td>\r\n                  <td className=\"p-2\">{log.clickType || \"-\"}</td>\r\n                  <td className=\"p-2 space-x-2\">\r\n                    <button\r\n                      onClick={() => openPreview(log)}\r\n                      className=\"text-xs text-blue-600 hover:underline\"\r\n                    >\r\n                      Preview\r\n                    </button>\r\n                    <button\r\n                      onClick={() => {\r\n                        setJourneyLog(log);\r\n                        setIsJourneyOpen(true);\r\n                      }}\r\n                      className=\"text-xs text-indigo-600 hover:underline\"\r\n                    >\r\n                      ðŸ§­ Journey\r\n                    </button>\r\n                    {log.sendStatus === \"Failed\" && (\r\n                      <button\r\n                        onClick={() => handleRetrySingle(log.id)}\r\n                        className=\"text-xs text-white bg-red-500 hover:bg-red-600 px-2 py-1 rounded\"\r\n                      >\r\n                        Retry\r\n                      </button>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n\r\n      {totalPages > 1 && (\r\n        <div className=\"flex justify-end items-center mt-4 space-x-2\">\r\n          <button\r\n            className=\"px-2 py-1 text-sm border rounded\"\r\n            disabled={page === 1}\r\n            onClick={() => setPage(p => p - 1)}\r\n          >\r\n            â¬… Prev\r\n          </button>\r\n          <span className=\"text-sm text-gray-600\">\r\n            Page {page} of {totalPages}\r\n          </span>\r\n          <button\r\n            className=\"px-2 py-1 text-sm border rounded\"\r\n            disabled={page === totalPages}\r\n            onClick={() => setPage(p => p + 1)}\r\n          >\r\n            Next âž¡\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      <MessagePreviewModal\r\n        isOpen={previewOpen}\r\n        onClose={closePreview}\r\n        messageLog={selectedLog}\r\n      />\r\n      <ContactJourneyModal\r\n        isOpen={isJourneyOpen}\r\n        onClose={() => setIsJourneyOpen(false)}\r\n        log={journeyLog}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CampaignSendLogs;\r\n"],"names":["_class","_temp2","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","exports","properties","document","body","classList","add","getElementById","svgNS","feGaussianBlur","createElementNS","setAttribute","filter","appendChild","svgElem","createSVGBlurReconfirm","divTarget","targetId","console","error","children","createElement","id","root","_client","createRoot","render","_react2","default","ReactConfirmAlert","createElementReconfirm","_react","require","_interopRequireDefault","_propTypes2","obj","__esModule","_possibleConstructorReturn","self","ReferenceError","_Component","_ref","_temp","_this","instance","TypeError","_classCallCheck","this","_len","args","Array","_key","__proto__","getPrototypeOf","apply","concat","handleClickButton","button","onClick","close","handleClickOverlay","e","_this$props","closeOnClickOutside","onClickOutside","isClickOutside","overlay","stopPropagation","afterClose","remove","unmount","removeElementReconfirm","svg","parentNode","removeChild","removeSVGBlurReconfirm","keyboard","event","_this$props2","closeOnEscape","onKeypressEscape","onkeyPress","keyCodeForClose","keyCode","isKeyCodeEscape","includes","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","willUnmount","renderCustomUI","_this$props3","title","message","buttons","customUI","onClose","subClass","superClass","create","constructor","value","setPrototypeOf","_inherits","_this2","_props","childrenElement","overlayClassName","className","ref","dom","map","label","Component","propTypes","string","array","isRequired","func","bool","arrayOf","number","defaultProps","isOpen","messageLog","_jsxs","Dialog","open","_jsx","Panel","Title","finalMessage","sourceChannel","sentAt","Date","toLocaleString","clickType","KpiCard","_ref2","icon","subText","gradient","decoration","decorations","wave","fill","viewBox","preserveAspectRatio","d","graph","stroke","strokeWidth","bars","x","y","width","height","summary","deliveryRate","sent","delivered","toFixed","readRate","read","chartData","name","failedCount","COLORS","totalSent","Send","size","CheckCircle2","Eye","XCircle","clickedCount","MousePointerClick","ResponsiveContainer","PieChart","Pie","data","dataKey","nameKey","cx","cy","innerRadius","outerRadius","paddingAngle","entry","index","Cell","indexOf","Tooltip","formatter","Share2","createLucideIcon","r","x1","x2","y1","y2","relTime","iso","diff","now","getTime","abs","Math","mins","floor","hrs","days","displayUrl","raw","u","URL","tail","pathname","split","slice","hostname","_unused","ICONS","MessageSent","Delivered","Read","ButtonClicked","FlowSend","Redirect","JourneyEvent","isCurrent","eventType","Hourglass","color","isClickable","Boolean","url","shouldShowDetails","details","href","rel","Link2","handleCopy","_navigator$clipboard","navigator","clipboard","writeText","Copy","dt","timestamp","log","journey","setJourney","useState","events","loading","setLoading","setFilter","expanded","setExpanded","errorText","setErrorText","displayPhone","s","String","trim","hasPlus","startsWith","replace","normalizeE164","contactPhone","recipientNumber","to","val","m","match","extractNumberLoose","contactName","useEffect","cslId","campaignSendLogId","axiosClient","get","isArray","err","_err$response","_err$response$data","_err$response2","_err$response2$data","response","toLowerCase","warn","toast","typeBadge","campaignType","eventsFiltered","useMemo","all","isMessageEvent","t","isClickEvent","eventsVisible","leftOff","leftOffAt","Transition","appear","show","as","Fragment","Child","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","Filter","X","_Fragment","flowName","idx","_event$title","v","campaignId","useParams","logs","setLogs","setSummary","search","setSearch","statusFilter","setStatusFilter","page","setPage","pageSize","totalPages","setTotalPages","totalLogs","setTotalLogs","previewOpen","setPreviewOpen","selectedLog","setSelectedLog","isJourneyOpen","setIsJourneyOpen","journeyLog","setJourneyLog","getDisplayPhone","clean","p","fetchLogs","useCallback","async","params","URLSearchParams","status","res","toString","items","totalCount","fetchSummary","_unused2","setTimeout","clearTimeout","Link","CampaignSummaryBar","placeholder","onChange","handleExport","csvRows","sendStatus","deliveredAt","readAt","isClicked","blob","Blob","join","type","saveAs","handleRetryAll","confirmAlert","post","success","retried","_unused4","openPreview","handleRetrySingle","logId","_unused3","disabled","MessagePreviewModal","closePreview","ContactJourneyModal"],"sourceRoot":""}