Folder and File Content Report
Root folder: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts
Generated at: 21-12-2025 22:28:55.28
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\ContactForm.jsx 
====================================================== 
 
import React, { useEffect, useState } from "react";
import axiosClient from "../../../api/axiosClient";
import { toast } from "react-toastify";

function ContactForm({ contact, onSaveComplete }) {
  const [formData, setFormData] = useState({
    name: "",
    phoneNumber: "",
    email: "",
    leadSource: "",
    notes: "",
    tags: [], // Array of tag IDs
    // Date fields are handled separately to avoid timezone issues
  });
  const [allTags, setAllTags] = useState([]);
  const [saving, setSaving] = useState(false);

  // Fetch all available tags when the component mounts
  useEffect(() => {
    const fetchTags = async () => {
      try {
        const response = await axiosClient.get("/tags");
        setAllTags(response.data.data || response.data); // Handle wrapper if it exists
      } catch (error) {
        console.error("Failed to load tags:", error);
        toast.error("âŒ Failed to load tags");
      }
    };
    fetchTags();
  }, []);

  // Populate the form when an existing contact is passed in
  useEffect(() => {
    if (contact) {
      setFormData({
        name: contact.name || "",
        phoneNumber: contact.phoneNumber || "",
        email: contact.email || "",
        leadSource: contact.leadSource || "",
        notes: contact.notes || "",
        tags: contact.tags?.map(t => t.tagId) || [],
      });
    }
  }, [contact]);

  const handleChange = e => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  const handleTagChange = e => {
    const selected = Array.from(e.target.selectedOptions, opt => opt.value);
    setFormData(prev => ({ ...prev, tags: selected }));
  };

  const handleSubmit = async e => {
    e.preventDefault();
    setSaving(true);

    // Backend expects an array of Guids/strings for the tag IDs
    const payload = {
      ...formData,
      tagIds: formData.tags, // Send just the array of IDs
    };

    try {
      if (contact?.id) {
        // Update existing contact
        await axiosClient.put(`/contacts/${contact.id}`, payload);
        toast.success("âœ… Contact updated successfully!");
      } else {
        // Create new contact
        await axiosClient.post("/contacts", payload);
        toast.success("âœ… Contact created successfully!");
      }
      onSaveComplete?.(); // Notify parent component to refresh/close
    } catch (err) {
      // Display the specific error message from the backend
      const errorMessage =
        err.response?.data?.message || "âŒ Failed to save contact.";
      toast.error(errorMessage);
      console.error("Save contact failed:", err);
    } finally {
      setSaving(false);
    }
  };

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      <input
        name="name"
        value={formData.name}
        onChange={handleChange}
        required
        placeholder="Name"
        className="w-full border px-3 py-2 rounded-md"
      />
      <input
        name="phoneNumber"
        value={formData.phoneNumber}
        onChange={handleChange}
        placeholder="Phone Number"
        className="w-full border px-3 py-2 rounded-md"
      />
      <input
        type="email"
        name="email"
        value={formData.email}
        onChange={handleChange}
        placeholder="Email"
        className="w-full border px-3 py-2 rounded-md"
      />

      <div>
        <label className="text-sm text-gray-600">Tags</label>
        <select
          multiple
          value={formData.tags}
          onChange={handleTagChange}
          className="w-full border px-3 py-2 rounded-md h-24"
        >
          {allTags.map(tag => (
            <option key={tag.id} value={tag.id}>
              {tag.name}
            </option>
          ))}
        </select>
      </div>

      <textarea
        name="notes"
        value={formData.notes}
        onChange={handleChange}
        placeholder="Notes..."
        className="w-full border px-3 py-2 rounded-md"
        rows={3}
      />

      <button
        type="submit"
        disabled={saving}
        className="w-full bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 disabled:bg-purple-300"
      >
        {saving ? "Saving..." : contact?.id ? "Update Contact" : "Add Contact"}
      </button>
    </form>
  );
}

export default ContactForm;

// import React, { useEffect, useState } from "react";
// import axios from "axios";
// import { toast } from "react-toastify";

// function ContactForm({ contact, onSaveComplete }) {
//   const [formData, setFormData] = useState({
//     name: "",
//     phoneNumber: "",
//     email: "",
//     leadSource: "",
//     notes: "",
//     lastContactedAt: "",
//     nextFollowUpAt: "",
//     tags: [], // Now array of tag IDs
//   });

//   const [allTags, setAllTags] = useState([]);

//   useEffect(() => {
//     // Load all tags from DB
//     axios
//       .get("/api/tags")
//       .then(res => setAllTags(res.data))
//       .catch(() => toast.error("âŒ Failed to load tags"));
//   }, []);

//   useEffect(() => {
//     if (contact) {
//       setFormData({
//         name: contact.name || "",
//         phoneNumber: contact.phoneNumber || "",
//         email: contact.email || "",
//         leadSource: contact.leadSource || "",
//         notes: contact.notes || "",
//         lastContactedAt: contact.lastContactedAt || "",
//         nextFollowUpAt: contact.nextFollowUpAt || "",
//         tags: contact.tags?.map(t => t.tagId) || [],
//       });
//     }
//   }, [contact]);

//   const handleChange = e => {
//     const { name, value } = e.target;
//     setFormData(prev => ({ ...prev, [name]: value }));
//   };

//   const handleTagChange = e => {
//     const selected = Array.from(e.target.selectedOptions, opt => opt.value);
//     setFormData(prev => ({ ...prev, tags: selected }));
//   };

//   const handleSubmit = async e => {
//     e.preventDefault();

//     const mappedTags = formData.tags.map(id => {
//       const tag = allTags.find(t => t.id === id);
//       return { tagId: tag.id, tagName: tag.name };
//     });

//     const payload = {
//       ...formData,
//       tags: mappedTags,
//     };

//     try {
//       if (contact?.id) {
//         await axios.put(`/contacts/${contact.id}`, payload);
//         toast.success("âœ… Contact updated");
//       } else {
//         await axios.post("/contacts", payload);
//         toast.success("âœ… Contact added");
//       }

//       onSaveComplete?.();
//     } catch (err) {
//       console.error(err);
//       toast.error("âŒ Failed to save contact");
//     }
//   };

//   return (
//     <form onSubmit={handleSubmit} className="space-y-3">
//       <input
//         name="name"
//         value={formData.name}
//         onChange={handleChange}
//         required
//         placeholder="Name"
//         className="w-full border px-3 py-2 rounded"
//       />
//       <input
//         name="phoneNumber"
//         value={formData.phoneNumber}
//         onChange={handleChange}
//         required
//         placeholder="Phone"
//         className="w-full border px-3 py-2 rounded"
//       />
//       <input
//         name="email"
//         value={formData.email}
//         onChange={handleChange}
//         placeholder="Email"
//         className="w-full border px-3 py-2 rounded"
//       />
//       <input
//         name="leadSource"
//         value={formData.leadSource}
//         onChange={handleChange}
//         placeholder="Lead Source"
//         className="w-full border px-3 py-2 rounded"
//       />

//       {/* âœ… Tag Select */}
//       <select
//         multiple
//         value={formData.tags}
//         onChange={handleTagChange}
//         className="w-full border px-3 py-2 rounded"
//       >
//         {allTags.map(tag => (
//           <option key={tag.id} value={tag.id}>
//             {tag.name}
//           </option>
//         ))}
//       </select>

//       <input
//         type="datetime-local"
//         name="lastContactedAt"
//         value={formData.lastContactedAt}
//         onChange={handleChange}
//         className="w-full border px-3 py-2 rounded"
//       />
//       <input
//         type="datetime-local"
//         name="nextFollowUpAt"
//         value={formData.nextFollowUpAt}
//         onChange={handleChange}
//         className="w-full border px-3 py-2 rounded"
//       />
//       <textarea
//         name="notes"
//         value={formData.notes}
//         onChange={handleChange}
//         placeholder="Notes"
//         className="w-full border px-3 py-2 rounded"
//       />

//       <button
//         type="submit"
//         className="bg-purple-600 text-white px-4 py-2 rounded"
//       >
//         {contact?.id ? "Update Contact" : "Add Contact"}
//       </button>
//     </form>
//   );
// }

// export default ContactForm;
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\ContactList.jsx 
====================================================== 
 
import React from "react";
import { FaEllipsisV } from "react-icons/fa";

function getInitials(name) {
  if (!name) return "";
  const parts = name.trim().split(" ");
  return parts
    .slice(0, 2)
    .map(word => word[0])
    .join("")
    .toUpperCase();
}

export default function ContactList({
  contacts,
  onEdit,
  onDelete,
  onNotes,
  onTimeline,
}) {
  return (
    <div className="overflow-x-auto mt-4 rounded-xl border shadow-sm">
      <table className="min-w-full bg-white">
        <thead className="text-left bg-gray-100 text-sm font-medium">
          <tr>
            <th className="px-4 py-3">Name</th>
            <th className="px-4 py-3">Phone</th>
            <th className="px-4 py-3">Tags</th>
            <th className="px-4 py-3 text-right">Actions</th>
          </tr>
        </thead>
        <tbody className="text-sm">
          {contacts.map(contact => (
            <tr key={contact.id} className="border-t hover:bg-gray-50">
              <td className="px-4 py-3 flex items-center gap-3">
                <div className="w-9 h-9 rounded-full bg-purple-100 text-purple-700 flex items-center justify-center font-bold text-sm shadow-sm">
                  {getInitials(contact.name)}
                </div>
                <span className="font-semibold">{contact.name}</span>
              </td>

              <td className="px-4 py-3 text-gray-700">
                {contact.phoneNumber || (
                  <span className="text-gray-400 italic">No number</span>
                )}
              </td>

              <td className="px-4 py-3">
                <div className="flex flex-wrap gap-1">
                  {(contact.tags ?? contact.contactTags ?? []).length > 0 ? (
                    (contact.tags ?? contact.contactTags).map((tag, index) => (
                      <span
                        key={index}
                        className="px-2 py-0.5 text-xs rounded-full font-medium"
                        style={{
                          backgroundColor: tag.colorHex || "#EEE",
                          color: "#1F2937",
                        }}
                      >
                        {tag.tagName || tag.name}
                      </span>
                    ))
                  ) : (
                    <span className="text-gray-400 text-xs italic">
                      No tags
                    </span>
                  )}
                </div>
              </td>

              <td className="px-4 py-3 text-right relative">
                <DropdownMenu
                  onEdit={() => onEdit(contact)}
                  onDelete={() => onDelete(contact)}
                  onNotes={() => onNotes(contact)}
                  onTimeline={() => onTimeline(contact)}
                />
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}

function DropdownMenu({ onEdit, onDelete, onNotes, onTimeline }) {
  const [open, setOpen] = React.useState(false);

  return (
    <div className="relative inline-block text-left">
      <button
        onClick={() => setOpen(prev => !prev)}
        className="p-2 rounded-full hover:bg-gray-100"
      >
        <FaEllipsisV size={14} />
      </button>

      {open && (
        <div className="absolute right-0 z-10 mt-2 w-40 origin-top-right rounded-md bg-white shadow-lg border">
          <div className="py-1 text-sm text-gray-700">
            <button
              onClick={onEdit}
              className="block w-full px-4 py-2 hover:bg-gray-100 text-left"
            >
              âœï¸ Edit
            </button>
            <button
              onClick={onNotes}
              className="block w-full px-4 py-2 hover:bg-gray-100 text-left"
            >
              ğŸ“ Notes
            </button>
            <button
              onClick={onTimeline}
              className="block w-full px-4 py-2 hover:bg-gray-100 text-left"
            >
              ğŸ•’ Timeline
            </button>
            <button
              onClick={onDelete}
              className="block w-full px-4 py-2 text-red-600 hover:bg-red-50 text-left"
            >
              ğŸ—‘ Delete
            </button>
          </div>
        </div>
      )}
    </div>
  );
}
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\Contacts.jsx 
====================================================== 
 
// ğŸ“„ src/pages/CRM/Contacts/Contacts.jsx

import React, { useState } from "react";
import { User } from "lucide-react";
import { toast } from "react-toastify";

import ContactsTopBar from "./components/ContactsTopBar";
import ContactsTable from "./components/ContactsTable";
import ContactFormModal from "./components/ContactFormModal";
import BulkActionsBar from "./components/BulkActionsBar";

export default function Contacts() {
  // ğŸ”¹ UI state
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [editingContact, setEditingContact] = useState(null);
  const [refreshTrigger, setRefreshTrigger] = useState(0);
  const [activeTab, setActiveTab] = useState("all");
  const [searchTerm, setSearchTerm] = useState("");
  const [selectedIds, setSelectedIds] = useState([]);
  const [currentPage, setCurrentPage] = useState(1);

  const [density, setDensity] = useState(() => {
    try {
      return localStorage.getItem("crm.contacts.density") || "compact";
    } catch {
      return "compact";
    }
  });

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Handlers
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const handleAddClick = () => {
    setEditingContact(null);
    setIsModalOpen(true);
  };

  const handleEditContact = contact => {
    setEditingContact(contact);
    setIsModalOpen(true);
  };

  const handleModalClose = () => {
    setIsModalOpen(false);
    setEditingContact(null);
  };

  const handleSaveComplete = () => {
    setRefreshTrigger(prev => prev + 1);
  };

  const handleSelectionChange = ids => {
    setSelectedIds(ids || []);
  };

  const handleTabChange = tab => {
    setActiveTab(tab);
    setCurrentPage(1);
    setSelectedIds([]);
  };

  const handleClearSelection = () => {
    setSelectedIds([]);
  };

  const handleRefreshList = () => {
    setRefreshTrigger(prev => prev + 1);
  };

  const handleDensityChange = next => {
    setDensity(next);
    try {
      localStorage.setItem("crm.contacts.density", next);
    } catch {
      // ignore storage errors
    }
  };

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Render
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  return (
    <div className="min-h-[calc(100vh-80px)] bg-gradient-to-b from-slate-50 via-white to-slate-50">
      <div className="max-w-7xl mx-auto px-5 sm:px-6 pt-6 pb-8">
        {/* Workspace header */}
        <div className="mb-5">
          <div className="flex items-start justify-between gap-4">
            <div>
              <h1 className="mt-1.5 text-xl font-semibold text-slate-900">
                Contacts
              </h1>

              <p className="mt-1 text-sm text-slate-600 max-w-2xl">
                Organize leads, segment customers, and run bulk actions.
              </p>

              <div className="mt-3 flex flex-wrap items-center gap-2">
                <span className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-[11px] font-semibold bg-emerald-50 text-emerald-800 border border-emerald-200/60">
                  <span className="w-1.5 h-1.5 rounded-full bg-emerald-600" />
                  Active tab: {activeTab}
                </span>

                <span className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-[11px] font-semibold bg-white text-slate-700 border border-slate-200">
                  Selected: {selectedIds.length}
                </span>
              </div>
            </div>

            <div className="hidden sm:flex h-12 w-12 items-center justify-center rounded-2xl bg-white border border-emerald-200/60 shadow-sm">
              <div className="h-10 w-10 rounded-2xl bg-emerald-100 flex items-center justify-center">
                <User className="h-5 w-5 text-emerald-800" />
              </div>
            </div>
          </div>
        </div>

        {/* Main module card */}
        <div className="bg-white/90 backdrop-blur rounded-2xl border border-slate-100 shadow-sm overflow-hidden">
          <div className="bg-white">
            <div className="border-b border-slate-100">
              <ContactsTopBar
                onAddClick={handleAddClick}
                onSearchChange={setSearchTerm}
                activeTab={activeTab}
                onTabChange={handleTabChange}
                searchTerm={searchTerm}
                density={density}
                onDensityChange={handleDensityChange}
                onFilterClick={() =>
                  toast.info("Advanced filters will come in a later phase.")
                }
              />
            </div>

            {selectedIds.length > 0 && (
              <div className="border-b border-slate-100 bg-emerald-50/50">
                <BulkActionsBar
                  selectedIds={selectedIds}
                  onClearSelection={handleClearSelection}
                  onRefresh={handleRefreshList}
                />
              </div>
            )}
          </div>

          <div className="bg-white">
            <div className="min-h-[560px]">
              <ContactsTable
                onEdit={handleEditContact}
                refreshTrigger={refreshTrigger}
                activeTab={activeTab}
                onSelectionChange={handleSelectionChange}
                searchTerm={searchTerm}
                currentPage={currentPage}
                setCurrentPage={setCurrentPage}
                density={density}
              />
            </div>
          </div>
        </div>

        <ContactFormModal
          isOpen={isModalOpen}
          onClose={handleModalClose}
          contact={editingContact}
          onSaveComplete={handleSaveComplete}
        />
      </div>
    </div>
  );
}

// // ğŸ“„ src/pages/CRM/Contacts/Contacts.jsx

// import React, { useEffect, useMemo, useState } from "react";
// import { useLocation } from "react-router-dom";
// import {
//   User,
//   Tag,
//   Clock,
//   StickyNote,
//   Bell,
//   Activity,
//   Filter,
// } from "lucide-react";
// import { toast } from "react-toastify";

// import axiosClient from "../../../api/axiosClient";

// import ContactsTopBar from "./components/ContactsTopBar";
// import ContactsTable from "./components/ContactsTable";
// import ContactFormModal from "./components/ContactFormModal";
// import BulkActionsBar from "./components/BulkActionsBar";

// function formatDateTime(value) {
//   if (!value) return "-";
//   try {
//     return new Date(value).toLocaleString();
//   } catch {
//     return String(value);
//   }
// }

// export default function Contacts() {
//   /**
//    * âœ… Product decision (for now):
//    * Keep Contact 360 code intact, but hide it from the UI until we finalize Inbox CRM panel integration.
//    */
//   const SHOW_CONTACT_360_PANEL = false;

//   // ğŸ”¹ UI state for list side
//   const [isModalOpen, setIsModalOpen] = useState(false);
//   const [editingContact, setEditingContact] = useState(null);
//   const [refreshTrigger, setRefreshTrigger] = useState(0);
//   const [activeTab, setActiveTab] = useState("all");
//   const [searchTerm, setSearchTerm] = useState("");
//   const [selectedIds, setSelectedIds] = useState([]);
//   const [currentPage, setCurrentPage] = useState(1);
//   const [density, setDensity] = useState(() => {
//     try {
//       return localStorage.getItem("crm.contacts.density") || "comfortable";
//     } catch {
//       return "comfortable";
//     }
//   });

//   // ğŸ”¹ URL -> contactId (for deep-link from Chat Inbox)
//   const location = useLocation();
//   const [focusedContactId, setFocusedContactId] = useState(null);

//   // ğŸ”¹ Contact 360 summary data (kept for later)
//   const [contactSummary, setContactSummary] = useState(null);
//   const [isSummaryLoading, setIsSummaryLoading] = useState(false);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 1) Hydrate focusedContactId from URL (?contactId=...)
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   useEffect(() => {
//     const params = new URLSearchParams(location.search);
//     const idFromUrl = params.get("contactId");

//     if (idFromUrl) {
//       setFocusedContactId(idFromUrl);

//       // Keep selection aligned so bulk actions make sense
//       setSelectedIds(prev =>
//         prev && prev.length > 0 && prev.includes(idFromUrl) ? prev : [idFromUrl]
//       );
//     }
//   }, [location.search]);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 2) Selection -> focus logic (kept for future 360 usage)
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   useEffect(() => {
//     const params = new URLSearchParams(location.search);
//     const idFromUrl = params.get("contactId");

//     if (idFromUrl) return;

//     if (!selectedIds || selectedIds.length === 0) {
//       setFocusedContactId(null);
//       setContactSummary(null);
//       return;
//     }

//     if (selectedIds.length === 1) {
//       setFocusedContactId(selectedIds[0]);
//       return;
//     }
//   }, [selectedIds, location.search]);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 3) Handlers
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   const handleAddClick = () => {
//     setEditingContact(null);
//     setIsModalOpen(true);
//   };

//   const handleEditContact = contact => {
//     setEditingContact(contact);
//     setIsModalOpen(true);
//   };

//   const handleModalClose = () => {
//     setIsModalOpen(false);
//     setEditingContact(null);
//   };

//   const handleSaveComplete = () => {
//     setRefreshTrigger(prev => prev + 1);
//   };

//   const handleSelectionChange = ids => {
//     setSelectedIds(ids || []);
//   };

//   const handleTabChange = tab => {
//     setActiveTab(tab);
//     setCurrentPage(1);
//     setSelectedIds([]);
//   };

//   const handleClearSelection = () => {
//     setSelectedIds([]);
//   };

//   const handleRefreshList = () => {
//     setRefreshTrigger(prev => prev + 1);
//   };

//   const handleDensityChange = next => {
//     setDensity(next);
//     try {
//       localStorage.setItem("crm.contacts.density", next);
//     } catch {
//       // ignore storage errors
//     }
//   };

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 4) Fetch Contact 360 summary (disabled while panel hidden)
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   useEffect(() => {
//     if (!SHOW_CONTACT_360_PANEL) return;

//     const contactId = focusedContactId;
//     if (!contactId) return;

//     let cancelled = false;

//     const loadSummary = async () => {
//       try {
//         setIsSummaryLoading(true);
//         const response = await axiosClient.get(
//           `/crm/contact-summary/${contactId}`
//         );
//         if (cancelled) return;
//         setContactSummary(response.data || null);
//       } catch (error) {
//         if (cancelled) return;
//         console.error("Failed to load contact summary", error);
//         toast.error(
//           error?.response?.data?.message ||
//             "Failed to load Contact 360 summary."
//         );
//         setContactSummary(null);
//       } finally {
//         if (!cancelled) setIsSummaryLoading(false);
//       }
//     };

//     loadSummary();

//     return () => {
//       cancelled = true;
//     };
//   }, [focusedContactId, SHOW_CONTACT_360_PANEL]);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 5) Derived CRM slices (kept for later)
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   const tagsList = useMemo(() => {
//     if (!contactSummary) return [];
//     if (Array.isArray(contactSummary.tags)) return contactSummary.tags;
//     if (Array.isArray(contactSummary.contactTags))
//       return contactSummary.contactTags;
//     if (Array.isArray(contactSummary.tagSummaries))
//       return contactSummary.tagSummaries;
//     if (Array.isArray(contactSummary.tagList)) return contactSummary.tagList;
//     return [];
//   }, [contactSummary]);

//   const recentNotes = useMemo(() => {
//     if (!contactSummary) return [];
//     const notes =
//       contactSummary.recentNotes ||
//       contactSummary.notes ||
//       contactSummary.lastNotes ||
//       [];
//     return Array.isArray(notes) ? notes.slice(0, 3) : [];
//   }, [contactSummary]);

//   const nextReminder = useMemo(() => {
//     if (!contactSummary) return null;
//     return (
//       contactSummary.nextReminder ||
//       contactSummary.upcomingReminder ||
//       contactSummary.reminder ||
//       null
//     );
//   }, [contactSummary]);

//   const recentTimeline = useMemo(() => {
//     if (!contactSummary) return [];
//     const items =
//       contactSummary.recentTimeline ||
//       contactSummary.timeline ||
//       contactSummary.events ||
//       [];
//     return Array.isArray(items) ? items.slice(0, 5) : [];
//   }, [contactSummary]);

//   const basic =
//     contactSummary?.contact ||
//     contactSummary?.contactBasic ||
//     contactSummary?.contactInfo ||
//     contactSummary ||
//     null;

//   const displayName =
//     basic?.fullName ||
//     basic?.name ||
//     basic?.contactName ||
//     "Unnamed contact";
//   const displayPhone =
//     basic?.phoneNumber || basic?.whatsappNumber || basic?.phone || "";
//   const displayEmail = basic?.email || basic?.emailAddress || "";
//   const displayStatus =
//     basic?.status || basic?.lifecycleStage || basic?.stage || null;
//   const createdAt =
//     basic?.createdAt ||
//     basic?.createdOn ||
//     basic?.firstSeenAt ||
//     basic?.createdDate;
//   const lastInbound =
//     basic?.lastInboundAt ||
//     basic?.lastInboundMessageAt ||
//     basic?.lastIncomingAt;
//   const lastOutbound =
//     basic?.lastOutboundAt ||
//     basic?.lastOutboundMessageAt ||
//     basic?.lastOutgoingAt;

//   const multipleSelected = selectedIds.length > 1;

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // âœ… Redesigned layout (emerald-only, premium spacing + hierarchy)
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   return (
//     <div className="min-h-[calc(100vh-80px)] bg-gradient-to-b from-slate-50 via-white to-slate-50">
//       {/* Soft top spacing so it never feels glued to topbar */}
//       <div className="max-w-7xl mx-auto px-5 sm:px-6 pt-6 pb-8">
//         {/* Workspace header */}
//         <div className="mb-5">
//           <div className="flex items-start justify-between gap-4">
//             <div>
//               <div className="flex flex-wrap items-center gap-2">
//                 <span className="text-[11px] font-semibold uppercase tracking-wide text-emerald-700">
//                   CRM Workspace
//                 </span>
//                 <span className="text-slate-300">/</span>
//                 <span className="text-[11px] font-medium text-slate-500">
//                   Contacts
//                 </span>
//               </div>

//               <h1 className="mt-1.5 text-xl font-semibold text-slate-900">
//                 Contacts
//               </h1>

//               <p className="mt-1 text-sm text-slate-600 max-w-2xl">
//                 Organize leads, segment customers, and keep context ready for
//                 Inbox actions.
//               </p>

//               {/* Meta chips (subtle, premium) */}
//               <div className="mt-3 flex flex-wrap items-center gap-2">
//                 <span className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-[11px] font-semibold bg-emerald-50 text-emerald-800 border border-emerald-200/60">
//                   <span className="w-1.5 h-1.5 rounded-full bg-emerald-600" />
//                   Active tab: {activeTab}
//                 </span>

//                 <span className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-[11px] font-semibold bg-white text-slate-700 border border-slate-200">
//                   Selected: {selectedIds.length}
//                 </span>
//               </div>
//             </div>

//             {/* Brand icon tile */}
//             <div className="hidden sm:flex h-12 w-12 items-center justify-center rounded-2xl bg-white border border-emerald-200/60 shadow-sm">
//               <div className="h-10 w-10 rounded-2xl bg-emerald-100 flex items-center justify-center">
//                 <User className="h-5 w-5 text-emerald-800" />
//               </div>
//             </div>
//           </div>
//         </div>

//         {/* Main module card */}
//         <div className="bg-white/90 backdrop-blur rounded-2xl border border-slate-100 shadow-sm overflow-hidden">
//           {/* Top controls zone */}
//           <div className="bg-white">
//             <div className="border-b border-slate-100">
//               <ContactsTopBar
//                 onAddClick={handleAddClick}
//                 onSearchChange={setSearchTerm}
//                 activeTab={activeTab}
//                 onTabChange={handleTabChange}
//                 searchTerm={searchTerm}
//                 density={density}
//                 onDensityChange={handleDensityChange}
//                 onFilterClick={() =>
//                   toast.info("Advanced filters will come in a later phase.")
//                 }
//               />
//             </div>

//             {/* Bulk actions bar */}
//             {selectedIds.length > 0 && (
//               <div className="border-b border-slate-100 bg-emerald-50/50">
//                 <BulkActionsBar
//                   selectedIds={selectedIds}
//                   onClearSelection={handleClearSelection}
//                   onRefresh={handleRefreshList}
//                 />
//               </div>
//             )}
//           </div>

//           {/* Table stage (gives the table a clean â€œcanvasâ€) */}
//           <div className="bg-white">
//             <div className="min-h-[560px]">
//               <ContactsTable
//                 onEdit={handleEditContact}
//                 refreshTrigger={refreshTrigger}
//                 activeTab={activeTab}
//                 onSelectionChange={handleSelectionChange}
//                 searchTerm={searchTerm}
//                 currentPage={currentPage}
//                 setCurrentPage={setCurrentPage}
//                 density={density}
//               />
//             </div>
//           </div>
//         </div>

//         {/* Contact create/edit modal */}
//         <ContactFormModal
//           isOpen={isModalOpen}
//           onClose={handleModalClose}
//           contact={editingContact}
//           onSaveComplete={handleSaveComplete}
//         />
//       </div>

//       {/* âœ… Contact 360 stays in code, but hidden */}
//       {SHOW_CONTACT_360_PANEL && (
//         <div className="hidden">
//           {/* Keeping the panel code alive for later decision */}
//           <div className="hidden lg:flex w-[360px] xl:w-[380px] flex-col bg-gradient-to-b from-emerald-50/80 via-white to-emerald-50/40">
//             <div className="border-b border-emerald-100 px-4 py-3 bg-white/90 backdrop-blur">
//               <div className="flex items-center justify-between">
//                 <div>
//                   <p className="text-[11px] font-semibold uppercase tracking-wide text-emerald-600">
//                     Contact 360
//                   </p>
//                   <p className="text-xs text-slate-500">
//                     Quick CRM snapshot for the selected contact
//                   </p>
//                 </div>
//                 <div className="h-8 w-8 rounded-2xl bg-emerald-100 flex items-center justify-center">
//                   <User className="h-4 w-4 text-emerald-700" />
//                 </div>
//               </div>
//             </div>

//             <div className="flex-1 overflow-y-auto px-4 py-3 space-y-4">
//               {!focusedContactId && !isSummaryLoading && !multipleSelected && (
//                 <div className="mt-10 text-center text-slate-500 text-sm">
//                   <div className="mx-auto mb-3 flex h-11 w-11 items-center justify-center rounded-2xl bg-emerald-50">
//                     <Filter className="h-4 w-4 text-emerald-600" />
//                   </div>
//                   <p className="font-medium text-slate-800">
//                     No contact selected yet
//                   </p>
//                   <p className="mt-1 text-xs text-slate-500">
//                     Select a contact from the list (or open this page from Chat
//                     Inbox) to see their full CRM profile.
//                   </p>
//                 </div>
//               )}

//               {multipleSelected && (
//                 <div className="mt-10 text-center text-slate-500 text-sm">
//                   <div className="mx-auto mb-3 flex h-11 w-11 items-center justify-center rounded-2xl bg-emerald-50">
//                     <Activity className="h-4 w-4 text-emerald-600" />
//                   </div>
//                   <p className="font-medium text-slate-800">
//                     Multiple contacts selected
//                   </p>
//                   <p className="mt-1 text-xs text-slate-500">
//                     Use the bulk actions bar for mass updates. Contact 360 is
//                     available when exactly one contact is selected.
//                   </p>
//                 </div>
//               )}

//               {focusedContactId && !multipleSelected && isSummaryLoading && (
//                 <div className="mt-6 space-y-3">
//                   <div className="animate-pulse space-y-3">
//                     <div className="h-5 w-32 rounded bg-emerald-100/70" />
//                     <div className="h-16 rounded-xl bg-emerald-50/80" />
//                     <div className="h-10 rounded-xl bg-emerald-50/70" />
//                     <div className="h-24 rounded-xl bg-emerald-50/60" />
//                   </div>
//                 </div>
//               )}

//               {focusedContactId &&
//                 !multipleSelected &&
//                 !isSummaryLoading &&
//                 contactSummary && (
//                   <>
//                     <div className="rounded-2xl border border-emerald-100 bg-white px-3 py-3 shadow-sm">
//                       <div className="flex items-start justify-between gap-2">
//                         <div>
//                           <div className="text-sm font-semibold text-slate-900">
//                             {displayName}
//                           </div>
//                           {displayPhone && (
//                             <div className="mt-0.5 text-xs text-slate-600 font-mono">
//                               {displayPhone}
//                             </div>
//                           )}
//                           {displayEmail && (
//                             <div className="mt-0.5 text-xs text-slate-500">
//                               {displayEmail}
//                             </div>
//                           )}
//                         </div>
//                         {displayStatus && (
//                           <span className="inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-800">
//                             {displayStatus}
//                           </span>
//                         )}
//                       </div>

//                       <div className="mt-3 grid grid-cols-2 gap-3 text-[11px] text-slate-600">
//                         <div>
//                           <p className="text-[10px] uppercase text-slate-400">
//                             Created
//                           </p>
//                           <p className="mt-0.5 font-medium">
//                             {formatDateTime(createdAt)}
//                           </p>
//                         </div>
//                         <div>
//                           <p className="text-[10px] uppercase text-slate-400">
//                             Last inbound
//                           </p>
//                           <p className="mt-0.5 font-medium">
//                             {formatDateTime(lastInbound)}
//                           </p>
//                         </div>
//                         <div>
//                           <p className="text-[10px] uppercase text-slate-400">
//                             Last outbound
//                           </p>
//                           <p className="mt-0.5 font-medium">
//                             {formatDateTime(lastOutbound)}
//                           </p>
//                         </div>
//                       </div>
//                     </div>

//                     {/* Tags / Reminders / Notes / Timeline remain unchanged */}
//                     {/* (kept here intentionally for later reuse in Inbox CRM panel) */}
//                   </>
//                 )}
//             </div>
//           </div>
//         </div>
//       )}
//     </div>
//   );
// }

// // ğŸ“„ src/pages/CRM/Contacts/Contacts.jsx

// import React, { useEffect, useMemo, useState } from "react";
// import { useLocation } from "react-router-dom";
// import {
//   User,
//   Tag,
//   Clock,
//   StickyNote,
//   Bell,
//   Activity,
//   Filter,
// } from "lucide-react";
// import { toast } from "react-toastify";

// import axiosClient from "../../../api/axiosClient";

// import ContactsTopBar from "./components/ContactsTopBar";
// import ContactsTable from "./components/ContactsTable";
// import ContactFormModal from "./components/ContactFormModal";
// import BulkActionsBar from "./components/BulkActionsBar";

// function formatDateTime(value) {
//   if (!value) return "â€”";
//   try {
//     return new Date(value).toLocaleString();
//   } catch {
//     return String(value);
//   }
// }

// export default function Contacts() {
//   // ğŸ”¹ UI state for list side
//   const [isModalOpen, setIsModalOpen] = useState(false);
//   const [editingContact, setEditingContact] = useState(null);
//   const [refreshTrigger, setRefreshTrigger] = useState(0);
//   const [activeTab, setActiveTab] = useState("all");
//   const [searchTerm, setSearchTerm] = useState("");
//   const [selectedIds, setSelectedIds] = useState([]);
//   const [currentPage, setCurrentPage] = useState(1);

//   // ğŸ”¹ URL -> contactId (for when we deep-link from Chat Inbox)
//   const location = useLocation();
//   const [focusedContactId, setFocusedContactId] = useState(null);

//   // ğŸ”¹ Contact 360 summary data
//   const [contactSummary, setContactSummary] = useState(null);
//   const [isSummaryLoading, setIsSummaryLoading] = useState(false);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 1) Hydrate focusedContactId from URL (?contactId=...)
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   useEffect(() => {
//     const params = new URLSearchParams(location.search);
//     const idFromUrl = params.get("contactId");

//     if (idFromUrl) {
//       setFocusedContactId(idFromUrl);

//       // Keep selection in a reasonable state for BulkActionsBar
//       setSelectedIds(prev =>
//         prev && prev.length > 0 && prev.includes(idFromUrl) ? prev : [idFromUrl]
//       );
//     }
//   }, [location.search]);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 2) When user selects contacts via checkboxes,
//   //    decide what Contact 360 should show
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   useEffect(() => {
//     const params = new URLSearchParams(location.search);
//     const idFromUrl = params.get("contactId");

//     // If there is a deep-link contactId in the URL, do not override it here.
//     if (idFromUrl) return;

//     if (!selectedIds || selectedIds.length === 0) {
//       // Nothing selected â†’ clear focus & summary
//       setFocusedContactId(null);
//       setContactSummary(null);
//       return;
//     }

//     if (selectedIds.length === 1) {
//       // Exactly one selected â†’ that is our focused contact
//       setFocusedContactId(selectedIds[0]);
//       return;
//     }

//     // If multiple are selected, we keep the previous focusedContactId.
//     // The right panel will switch to a "multiple contacts selected" state.
//   }, [selectedIds]);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 3) Handlers for list side
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   const handleAddClick = () => {
//     setEditingContact(null);
//     setIsModalOpen(true);
//   };

//   const handleEditContact = contact => {
//     setEditingContact(contact);
//     setIsModalOpen(true);
//   };

//   const handleModalClose = () => {
//     setIsModalOpen(false);
//     setEditingContact(null);
//   };

//   const handleSaveComplete = () => {
//     // Modal will close itself via onClose; we just trigger refresh.
//     setRefreshTrigger(prev => prev + 1);
//   };

//   const handleSelectionChange = ids => {
//     setSelectedIds(ids || []);
//   };

//   const handleTabChange = tab => {
//     setActiveTab(tab);
//     setCurrentPage(1);
//     setSelectedIds([]);
//   };

//   const handleClearSelection = () => {
//     setSelectedIds([]);
//   };

//   const handleRefreshList = () => {
//     setRefreshTrigger(prev => prev + 1);
//   };

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 4) Fetch Contact 360 summary when focusedContactId changes
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   useEffect(() => {
//     const contactId = focusedContactId;
//     if (!contactId) return;

//     let cancelled = false;

//     const loadSummary = async () => {
//       try {
//         setIsSummaryLoading(true);
//         const response = await axiosClient.get(
//           `/crm/contact-summary/${contactId}`
//         );
//         if (cancelled) return;
//         setContactSummary(response.data || null);
//       } catch (error) {
//         if (cancelled) return;
//         console.error("Failed to load contact summary", error);
//         toast.error(
//           error?.response?.data?.message ||
//             "Failed to load Contact 360 summary."
//         );
//         setContactSummary(null);
//       } finally {
//         if (!cancelled) {
//           setIsSummaryLoading(false);
//         }
//       }
//     };

//     loadSummary();

//     return () => {
//       cancelled = true;
//     };
//   }, [focusedContactId]);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 5) Derived CRM summary slices (tags, notes, reminder, timeline)
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   const tagsList = useMemo(() => {
//     if (!contactSummary) return [];
//     if (Array.isArray(contactSummary.tags)) return contactSummary.tags;
//     if (Array.isArray(contactSummary.contactTags))
//       return contactSummary.contactTags;
//     if (Array.isArray(contactSummary.tagSummaries))
//       return contactSummary.tagSummaries;
//     if (Array.isArray(contactSummary.tagList)) return contactSummary.tagList;
//     return [];
//   }, [contactSummary]);

//   const recentNotes = useMemo(() => {
//     if (!contactSummary) return [];
//     const notes =
//       contactSummary.recentNotes ||
//       contactSummary.notes ||
//       contactSummary.lastNotes ||
//       [];
//     return Array.isArray(notes) ? notes.slice(0, 3) : [];
//   }, [contactSummary]);

//   const nextReminder = useMemo(() => {
//     if (!contactSummary) return null;
//     return (
//       contactSummary.nextReminder ||
//       contactSummary.upcomingReminder ||
//       contactSummary.reminder ||
//       null
//     );
//   }, [contactSummary]);

//   const recentTimeline = useMemo(() => {
//     if (!contactSummary) return [];
//     const items =
//       contactSummary.recentTimeline ||
//       contactSummary.timeline ||
//       contactSummary.events ||
//       [];
//     return Array.isArray(items) ? items.slice(0, 5) : [];
//   }, [contactSummary]);

//   const basic =
//     contactSummary?.contact ||
//     contactSummary?.contactBasic ||
//     contactSummary?.contactInfo ||
//     contactSummary ||
//     null;

//   const displayName =
//     basic?.fullName || basic?.name || basic?.contactName || "â€”";
//   const displayPhone =
//     basic?.phoneNumber || basic?.whatsappNumber || basic?.phone || "";
//   const displayEmail = basic?.email || basic?.emailAddress || "";
//   const displayStatus =
//     basic?.status || basic?.lifecycleStage || basic?.stage || null;
//   const createdAt =
//     basic?.createdAt ||
//     basic?.createdOn ||
//     basic?.firstSeenAt ||
//     basic?.createdDate;
//   const lastInbound =
//     basic?.lastInboundAt ||
//     basic?.lastInboundMessageAt ||
//     basic?.lastIncomingAt;
//   const lastOutbound =
//     basic?.lastOutboundAt ||
//     basic?.lastOutboundMessageAt ||
//     basic?.lastOutgoingAt;

//   const multipleSelected = selectedIds.length > 1;

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 6) Render â€“ green / XploreByte themed
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   return (
//     <div className="flex h-full bg-gradient-to-r from-emerald-50 via-emerald-50/40 to-white">
//       {/* LEFT: Contacts list + workspace header + filters + bulk actions */}
//       <div className="flex-1 flex flex-col border-r border-slate-200 bg-white/90 backdrop-blur">
//         {/* Workspace-style header */}
//         <div className="border-b border-slate-200 bg-white/90">
//           <div className="px-5 pt-4 pb-3 flex items-center justify-between">
//             <div>
//               <p className="text-[11px] font-semibold uppercase tracking-wide text-emerald-600">
//                 CRM Workspace
//               </p>
//               <h1 className="mt-1 text-lg font-semibold text-slate-900">
//                 Contacts
//               </h1>
//               <p className="mt-0.5 text-xs text-slate-500">
//                 Manage your leads and customers in one place.
//               </p>
//             </div>
//             <div className="hidden sm:flex h-10 w-10 items-center justify-center rounded-2xl bg-emerald-100">
//               <User className="h-5 w-5 text-emerald-600" />
//             </div>
//           </div>

//           {/* Top bar: search + tabs + filters */}
//           <div className="border-t border-slate-100">
//             <ContactsTopBar
//               onAddClick={handleAddClick}
//               onSearchChange={setSearchTerm}
//               activeTab={activeTab}
//               onTabChange={handleTabChange}
//               searchTerm={searchTerm}
//               onFilterClick={() =>
//                 toast.info("Advanced filters will come in a later phase.")
//               }
//             />
//           </div>
//         </div>

//         {/* Bulk actions (only visible when something is selected) */}
//         {selectedIds.length > 0 && (
//           <BulkActionsBar
//             selectedIds={selectedIds}
//             onClearSelection={handleClearSelection}
//             onRefresh={handleRefreshList}
//           />
//         )}

//         {/* Contacts table */}
//         <div className="flex-1 overflow-hidden">
//           <ContactsTable
//             onEdit={handleEditContact}
//             refreshTrigger={refreshTrigger}
//             activeTab={activeTab}
//             onSelectionChange={handleSelectionChange}
//             searchTerm={searchTerm}
//             currentPage={currentPage}
//             setCurrentPage={setCurrentPage}
//           />
//         </div>

//         {/* Contact create/edit modal */}
//         <ContactFormModal
//           isOpen={isModalOpen}
//           onClose={handleModalClose}
//           contact={editingContact}
//           onSaveComplete={handleSaveComplete}
//         />
//       </div>

//       {/* RIGHT: Contact 360 mini-CRM panel */}
//       <div className="hidden lg:flex w-[360px] xl:w-[380px] flex-col bg-gradient-to-b from-emerald-50/80 via-white to-emerald-50/40">
//         {/* Header */}
//         <div className="border-b border-emerald-100 px-4 py-3 bg-white/90 backdrop-blur">
//           <div className="flex items-center justify-between">
//             <div>
//               <p className="text-[11px] font-semibold uppercase tracking-wide text-emerald-600">
//                 Contact 360
//               </p>
//               <p className="text-xs text-slate-500">
//                 Quick CRM snapshot for the selected contact
//               </p>
//             </div>
//             <div className="h-8 w-8 rounded-2xl bg-emerald-100 flex items-center justify-center">
//               <User className="h-4 w-4 text-emerald-700" />
//             </div>
//           </div>
//         </div>

//         {/* Body */}
//         <div className="flex-1 overflow-y-auto px-4 py-3 space-y-4">
//           {/* Empty state */}
//           {!focusedContactId && !isSummaryLoading && !multipleSelected && (
//             <div className="mt-10 text-center text-slate-500 text-sm">
//               <div className="mx-auto mb-3 flex h-11 w-11 items-center justify-center rounded-2xl bg-emerald-50">
//                 <Filter className="h-4 w-4 text-emerald-600" />
//               </div>
//               <p className="font-medium text-slate-800">
//                 No contact selected yet
//               </p>
//               <p className="mt-1 text-xs text-slate-500">
//                 Select a contact from the list (or open this page from Chat
//                 Inbox) to see their full CRM profile.
//               </p>
//             </div>
//           )}

//           {/* Multiple selection state */}
//           {multipleSelected && (
//             <div className="mt-10 text-center text-slate-500 text-sm">
//               <div className="mx-auto mb-3 flex h-11 w-11 items-center justify-center rounded-2xl bg-emerald-50">
//                 <Activity className="h-4 w-4 text-emerald-600" />
//               </div>
//               <p className="font-medium text-slate-800">
//                 Multiple contacts selected
//               </p>
//               <p className="mt-1 text-xs text-slate-500">
//                 Use the bulk actions bar for mass updates. Contact 360 is
//                 available when exactly one contact is selected.
//               </p>
//             </div>
//           )}

//           {/* Loading skeleton */}
//           {focusedContactId && !multipleSelected && isSummaryLoading && (
//             <div className="mt-6 space-y-3">
//               <div className="animate-pulse space-y-3">
//                 <div className="h-5 w-32 rounded bg-emerald-100/70" />
//                 <div className="h-16 rounded-xl bg-emerald-50/80" />
//                 <div className="h-10 rounded-xl bg-emerald-50/70" />
//                 <div className="h-24 rounded-xl bg-emerald-50/60" />
//               </div>
//             </div>
//           )}

//           {/* Actual summary */}
//           {focusedContactId &&
//             !multipleSelected &&
//             !isSummaryLoading &&
//             contactSummary && (
//               <>
//                 {/* Basic info card */}
//                 <div className="rounded-2xl border border-emerald-100 bg-white px-3 py-3 shadow-sm">
//                   <div className="flex items-start justify-between gap-2">
//                     <div>
//                       <div className="text-sm font-semibold text-slate-900">
//                         {displayName}
//                       </div>
//                       {displayPhone && (
//                         <div className="mt-0.5 text-xs text-slate-600 font-mono">
//                           {displayPhone}
//                         </div>
//                       )}
//                       {displayEmail && (
//                         <div className="mt-0.5 text-xs text-slate-500">
//                           {displayEmail}
//                         </div>
//                       )}
//                     </div>
//                     {displayStatus && (
//                       <span className="inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700">
//                         {displayStatus}
//                       </span>
//                     )}
//                   </div>

//                   <div className="mt-3 grid grid-cols-2 gap-3 text-[11px] text-slate-600">
//                     <div>
//                       <p className="text-[10px] uppercase text-slate-400">
//                         Created
//                       </p>
//                       <p className="mt-0.5 font-medium">
//                         {formatDateTime(createdAt)}
//                       </p>
//                     </div>
//                     <div>
//                       <p className="text-[10px] uppercase text-slate-400">
//                         Last inbound
//                       </p>
//                       <p className="mt-0.5 font-medium">
//                         {formatDateTime(lastInbound)}
//                       </p>
//                     </div>
//                     <div>
//                       <p className="text-[10px] uppercase text-slate-400">
//                         Last outbound
//                       </p>
//                       <p className="mt-0.5 font-medium">
//                         {formatDateTime(lastOutbound)}
//                       </p>
//                     </div>
//                   </div>
//                 </div>

//                 {/* Tags */}
//                 <div className="rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm">
//                   <div className="flex items-center justify-between mb-2">
//                     <div className="flex items-center gap-2">
//                       <div className="h-6 w-6 rounded-full bg-emerald-50 flex items-center justify-center">
//                         <Tag className="h-3 w-3 text-emerald-700" />
//                       </div>
//                       <p className="text-xs font-semibold text-slate-800">
//                         Tags
//                       </p>
//                     </div>
//                   </div>
//                   {tagsList.length === 0 ? (
//                     <p className="text-xs text-slate-500">
//                       No tags yet. You can tag this contact from the main
//                       Contacts view.
//                     </p>
//                   ) : (
//                     <div className="flex flex-wrap gap-1.5">
//                       {tagsList.map(tag => (
//                         <span
//                           key={tag.id || tag.tagId || tag.name}
//                           className="inline-flex items-center rounded-full border border-slate-200 bg-emerald-50/70 px-2 py-0.5 text-[11px] text-slate-800"
//                         >
//                           {tag.color && (
//                             <span
//                               className="mr-1 h-2 w-2 rounded-full"
//                               style={{ backgroundColor: tag.color }}
//                             />
//                           )}
//                           {tag.name || tag.label || tag.tagName}
//                         </span>
//                       ))}
//                     </div>
//                   )}
//                 </div>

//                 {/* Next Reminder */}
//                 <div className="rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm">
//                   <div className="flex items-center gap-2 mb-2">
//                     <div className="h-6 w-6 rounded-full bg-emerald-50 flex items-center justify-center">
//                       <Bell className="h-3 w-3 text-emerald-700" />
//                     </div>
//                     <p className="text-xs font-semibold text-slate-800">
//                       Next reminder
//                     </p>
//                   </div>
//                   {!nextReminder ? (
//                     <p className="text-xs text-slate-500">
//                       No upcoming reminder scheduled.
//                     </p>
//                   ) : (
//                     <div className="space-y-1 text-xs text-slate-700">
//                       <p className="font-medium">
//                         {nextReminder.title ||
//                           nextReminder.subject ||
//                           "Reminder"}
//                       </p>
//                       {nextReminder.dueAt && (
//                         <p className="flex items-center gap-1 text-slate-500">
//                           <Clock className="h-3 w-3" />
//                           {formatDateTime(
//                             nextReminder.dueAt ||
//                               nextReminder.dueDate ||
//                               nextReminder.remindAt
//                           )}
//                         </p>
//                       )}
//                       {nextReminder.note && (
//                         <p className="text-[11px] text-slate-500">
//                           {nextReminder.note}
//                         </p>
//                       )}
//                     </div>
//                   )}
//                 </div>

//                 {/* Recent Notes */}
//                 <div className="rounded-2xl border border-slate-200 bg-white px-3 py-3 shadow-sm">
//                   <div className="flex items-center gap-2 mb-2">
//                     <div className="h-6 w-6 rounded-full bg-emerald-50 flex items-center justify-center">
//                       <StickyNote className="h-3 w-3 text-emerald-700" />
//                     </div>
//                     <p className="text-xs font-semibold text-slate-800">
//                       Recent notes
//                     </p>
//                   </div>
//                   {recentNotes.length === 0 ? (
//                     <p className="text-xs text-slate-500">
//                       No notes yet. Use the Notes module in CRM to add context
//                       for this lead.
//                     </p>
//                   ) : (
//                     <div className="space-y-2">
//                       {recentNotes.map(note => (
//                         <div
//                           key={note.id || note.noteId}
//                           className="rounded-lg border border-slate-100 bg-emerald-50/40 px-2 py-1.5"
//                         >
//                           <p className="text-[11px] font-medium text-slate-800">
//                             {note.title || "Note"}
//                           </p>
//                           {note.content && (
//                             <p className="mt-0.5 text-[11px] text-slate-600 line-clamp-2">
//                               {note.content}
//                             </p>
//                           )}
//                           {note.createdAt && (
//                             <p className="mt-0.5 text-[10px] text-slate-400">
//                               {formatDateTime(note.createdAt)}
//                             </p>
//                           )}
//                         </div>
//                       ))}
//                     </div>
//                   )}
//                 </div>

//                 {/* Recent Timeline */}
//                 <div className="rounded-2xl border border-slate-200 bg-white px-3 py-3 mb-2 shadow-sm">
//                   <div className="flex items-center gap-2 mb-2">
//                     <div className="h-6 w-6 rounded-full bg-emerald-50 flex items-center justify-center">
//                       <Activity className="h-3 w-3 text-emerald-700" />
//                     </div>
//                     <p className="text-xs font-semibold text-slate-800">
//                       Recent activity
//                     </p>
//                   </div>
//                   {recentTimeline.length === 0 ? (
//                     <p className="text-xs text-slate-500">
//                       No recent timeline events captured for this contact yet.
//                     </p>
//                   ) : (
//                     <ol className="space-y-1.5 text-[11px] text-slate-700">
//                       {recentTimeline.map(item => (
//                         <li
//                           key={item.id || item.eventId || item.occurredAt}
//                           className="flex items-start gap-2"
//                         >
//                           <span className="mt-1 h-1.5 w-1.5 rounded-full bg-emerald-500 flex-shrink-0" />
//                           <div>
//                             <p className="font-medium">
//                               {item.title || item.type || "Event"}
//                             </p>
//                             {item.description && (
//                               <p className="text-[11px] text-slate-600 line-clamp-2">
//                                 {item.description}
//                               </p>
//                             )}
//                             {item.occurredAt && (
//                               <p className="text-[10px] text-slate-400 mt-0.5">
//                                 {formatDateTime(item.occurredAt)}
//                               </p>
//                             )}
//                           </div>
//                         </li>
//                       ))}
//                     </ol>
//                   )}
//                 </div>
//               </>
//             )}
//         </div>
//       </div>
//     </div>
//   );
// }

// // ğŸ“„ src/pages/CRM/Contacts/Contacts.jsx

// import React, { useEffect, useMemo, useState } from "react";
// import { useLocation } from "react-router-dom";
// import {
//   User,
//   Tag,
//   Clock,
//   StickyNote,
//   Bell,
//   Activity,
//   Filter,
// } from "lucide-react";
// import { toast } from "react-toastify";

// import axiosClient from "../../../api/axiosClient";

// import ContactsTopBar from "./components/ContactsTopBar";
// import ContactsTable from "./components/ContactsTable";
// import ContactFormModal from "./components/ContactFormModal";
// import BulkActionsBar from "./components/BulkActionsBar";

// function formatDateTime(value) {
//   if (!value) return "â€”";
//   try {
//     return new Date(value).toLocaleString();
//   } catch {
//     return String(value);
//   }
// }

// export default function Contacts() {
//   // ğŸ”¹ UI state for list side
//   const [isModalOpen, setIsModalOpen] = useState(false);
//   const [editingContact, setEditingContact] = useState(null);
//   const [refreshTrigger, setRefreshTrigger] = useState(0);
//   const [activeTab, setActiveTab] = useState("all");
//   const [searchTerm, setSearchTerm] = useState("");
//   const [selectedIds, setSelectedIds] = useState([]);
//   const [currentPage, setCurrentPage] = useState(1);

//   // ğŸ”¹ URL -> contactId (for when we deep-link from Chat Inbox)
//   const location = useLocation();
//   const [focusedContactId, setFocusedContactId] = useState(null);

//   // ğŸ”¹ Contact 360 summary data
//   const [contactSummary, setContactSummary] = useState(null);
//   const [isSummaryLoading, setIsSummaryLoading] = useState(false);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 1) Hydrate focusedContactId from URL (?contactId=...)
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   useEffect(() => {
//     const params = new URLSearchParams(location.search);
//     const idFromUrl = params.get("contactId");

//     if (idFromUrl) {
//       setFocusedContactId(idFromUrl);

//       // Keep selection in a reasonable state for BulkActionsBar
//       setSelectedIds(prev =>
//         prev && prev.length > 0 && prev.includes(idFromUrl) ? prev : [idFromUrl]
//       );
//     }
//   }, [location.search]);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 2) When user selects contacts via checkboxes,
//   //    focus the first one for Contact 360
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   useEffect(() => {
//     if (selectedIds && selectedIds.length > 0) {
//       setFocusedContactId(selectedIds[0]);
//     } else {
//       // Only clear if not coming from a URL-driven focus
//       const params = new URLSearchParams(location.search);
//       const idFromUrl = params.get("contactId");
//       if (!idFromUrl) {
//         setFocusedContactId(null);
//         setContactSummary(null);
//       }
//     }
//     // eslint-disable-next-line react-hooks/exhaustive-deps
//   }, [selectedIds]);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 3) Handlers for list side
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   const handleAddClick = () => {
//     setEditingContact(null);
//     setIsModalOpen(true);
//   };

//   const handleEditContact = contact => {
//     setEditingContact(contact);
//     setIsModalOpen(true);
//   };

//   const handleModalClose = () => {
//     setIsModalOpen(false);
//     setEditingContact(null);
//   };

//   const handleSaveComplete = () => {
//     // Modal will close itself via onClose; we just trigger refresh.
//     setRefreshTrigger(prev => prev + 1);
//   };

//   const handleSelectionChange = ids => {
//     setSelectedIds(ids || []);
//   };

//   const handleTabChange = tab => {
//     setActiveTab(tab);
//     setCurrentPage(1);
//     setSelectedIds([]);
//   };

//   const handleClearSelection = () => {
//     setSelectedIds([]);
//   };

//   const handleRefreshList = () => {
//     setRefreshTrigger(prev => prev + 1);
//   };

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 4) Fetch Contact 360 summary when focusedContactId changes
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   useEffect(() => {
//     const contactId = focusedContactId;
//     if (!contactId) return;

//     let cancelled = false;

//     const loadSummary = async () => {
//       try {
//         setIsSummaryLoading(true);
//         const response = await axiosClient.get(
//           `/crm/contact-summary/${contactId}`
//         );
//         if (cancelled) return;
//         setContactSummary(response.data || null);
//       } catch (error) {
//         if (cancelled) return;
//         console.error("Failed to load contact summary", error);
//         toast.error(
//           error?.response?.data?.message ||
//             "Failed to load Contact 360 summary."
//         );
//         setContactSummary(null);
//       } finally {
//         if (!cancelled) {
//           setIsSummaryLoading(false);
//         }
//       }
//     };

//     loadSummary();

//     return () => {
//       cancelled = true;
//     };
//   }, [focusedContactId]);

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 5) Derived CRM summary slices (tags, notes, reminder, timeline)
//   //    â€“ mirrors the logic weâ€™re already using in Chat Inbox
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   const tagsList = useMemo(() => {
//     if (!contactSummary) return [];
//     if (Array.isArray(contactSummary.tags)) return contactSummary.tags;
//     if (Array.isArray(contactSummary.contactTags))
//       return contactSummary.contactTags;
//     if (Array.isArray(contactSummary.tagSummaries))
//       return contactSummary.tagSummaries;
//     if (Array.isArray(contactSummary.tagList)) return contactSummary.tagList;
//     return [];
//   }, [contactSummary]);

//   const recentNotes = useMemo(() => {
//     if (!contactSummary) return [];
//     const notes =
//       contactSummary.recentNotes ||
//       contactSummary.notes ||
//       contactSummary.lastNotes ||
//       [];
//     return Array.isArray(notes) ? notes.slice(0, 3) : [];
//   }, [contactSummary]);

//   const nextReminder = useMemo(() => {
//     if (!contactSummary) return null;
//     return (
//       contactSummary.nextReminder ||
//       contactSummary.upcomingReminder ||
//       contactSummary.reminder ||
//       null
//     );
//   }, [contactSummary]);

//   const recentTimeline = useMemo(() => {
//     if (!contactSummary) return [];
//     const items =
//       contactSummary.recentTimeline ||
//       contactSummary.timeline ||
//       contactSummary.events ||
//       [];
//     return Array.isArray(items) ? items.slice(0, 5) : [];
//   }, [contactSummary]);

//   const basic =
//     contactSummary?.contact ||
//     contactSummary?.contactBasic ||
//     contactSummary?.contactInfo ||
//     contactSummary ||
//     null;

//   const displayName =
//     basic?.fullName || basic?.name || basic?.contactName || "â€”";
//   const displayPhone =
//     basic?.phoneNumber || basic?.whatsappNumber || basic?.phone || "";
//   const displayEmail = basic?.email || basic?.emailAddress || "";
//   const displayStatus =
//     basic?.status || basic?.lifecycleStage || basic?.stage || null;
//   const createdAt =
//     basic?.createdAt ||
//     basic?.createdOn ||
//     basic?.firstSeenAt ||
//     basic?.createdDate;
//   const lastInbound =
//     basic?.lastInboundAt ||
//     basic?.lastInboundMessageAt ||
//     basic?.lastIncomingAt;
//   const lastOutbound =
//     basic?.lastOutboundAt ||
//     basic?.lastOutboundMessageAt ||
//     basic?.lastOutgoingAt;

//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   // 6) Render
//   // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   return (
//     <div className="flex h-full bg-slate-50">
//       {/* LEFT: Contacts list + filters + bulk actions */}
//       <div className="flex-1 flex flex-col border-r border-slate-200 bg-white">
//         {/* Top bar: search + tabs + filters */}
//         <div className="border-b border-slate-200">
//           <ContactsTopBar
//             onAddClick={handleAddClick}
//             onSearchChange={setSearchTerm}
//             activeTab={activeTab}
//             onTabChange={handleTabChange}
//             searchTerm={searchTerm}
//             onFilterClick={() =>
//               toast.info("Advanced filters will come in a later phase.")
//             }
//           />
//         </div>

//         {/* Bulk actions (only visible when something is selected) */}
//         {selectedIds.length > 0 && (
//           <BulkActionsBar
//             selectedIds={selectedIds}
//             onClearSelection={handleClearSelection}
//             onRefresh={handleRefreshList}
//           />
//         )}

//         {/* Contacts table */}
//         <div className="flex-1 overflow-hidden">
//           <ContactsTable
//             onEdit={handleEditContact}
//             refreshTrigger={refreshTrigger}
//             activeTab={activeTab}
//             onSelectionChange={handleSelectionChange}
//             searchTerm={searchTerm}
//             currentPage={currentPage}
//             setCurrentPage={setCurrentPage}
//           />
//         </div>

//         {/* Contact create/edit modal */}
//         <ContactFormModal
//           isOpen={isModalOpen}
//           onClose={handleModalClose}
//           contact={editingContact}
//           onSaveComplete={handleSaveComplete}
//         />
//       </div>

//       {/* RIGHT: Contact 360 mini-CRM panel */}
//       <div className="hidden lg:flex w-[360px] xl:w-[380px] flex-col bg-slate-25">
//         {/* Header */}
//         <div className="border-b border-slate-200 px-4 py-3 bg-white">
//           <div className="flex items-center justify-between">
//             <div>
//               <p className="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
//                 Contact 360
//               </p>
//               <p className="text-xs text-slate-500">
//                 Quick CRM snapshot for the selected contact
//               </p>
//             </div>
//             <div className="h-8 w-8 rounded-full bg-purple-50 flex items-center justify-center">
//               <User className="h-4 w-4 text-purple-600" />
//             </div>
//           </div>
//         </div>

//         {/* Body */}
//         <div className="flex-1 overflow-y-auto px-4 py-3 space-y-4">
//           {/* Empty state */}
//           {!focusedContactId && !isSummaryLoading && (
//             <div className="mt-8 text-center text-slate-500 text-sm">
//               <div className="mx-auto mb-3 flex h-10 w-10 items-center justify-center rounded-full bg-slate-100">
//                 <Filter className="h-4 w-4 text-slate-500" />
//               </div>
//               <p className="font-medium">No contact selected</p>
//               <p className="mt-1 text-xs text-slate-500">
//                 Select a contact from the list (or open this page from Chat
//                 Inbox) to see their CRM profile.
//               </p>
//             </div>
//           )}

//           {/* Loading */}
//           {focusedContactId && isSummaryLoading && (
//             <div className="mt-6 space-y-3">
//               <div className="animate-pulse space-y-3">
//                 <div className="h-5 w-32 rounded bg-slate-200" />
//                 <div className="h-16 rounded-xl bg-slate-100" />
//                 <div className="h-10 rounded-xl bg-slate-100" />
//                 <div className="h-24 rounded-xl bg-slate-100" />
//               </div>
//             </div>
//           )}

//           {/* Actual summary */}
//           {focusedContactId && !isSummaryLoading && contactSummary && (
//             <>
//               {/* Basic info card */}
//               <div className="rounded-xl border border-slate-200 bg-slate-50 px-3 py-3">
//                 <div className="flex items-start justify-between gap-2">
//                   <div>
//                     <div className="text-sm font-semibold text-slate-900">
//                       {displayName}
//                     </div>
//                     {displayPhone && (
//                       <div className="mt-0.5 text-xs text-slate-600 font-mono">
//                         {displayPhone}
//                       </div>
//                     )}
//                     {displayEmail && (
//                       <div className="mt-0.5 text-xs text-slate-500">
//                         {displayEmail}
//                       </div>
//                     )}
//                   </div>
//                   {displayStatus && (
//                     <span className="inline-flex items-center rounded-full border border-amber-200 bg-amber-50 px-2 py-0.5 text-[10px] font-medium text-amber-700">
//                       {displayStatus}
//                     </span>
//                   )}
//                 </div>

//                 <div className="mt-3 grid grid-cols-2 gap-3 text-[11px] text-slate-600">
//                   <div>
//                     <p className="text-[10px] uppercase text-slate-400">
//                       Created
//                     </p>
//                     <p className="mt-0.5 font-medium">
//                       {formatDateTime(createdAt)}
//                     </p>
//                   </div>
//                   <div>
//                     <p className="text-[10px] uppercase text-slate-400">
//                       Last inbound
//                     </p>
//                     <p className="mt-0.5 font-medium">
//                       {formatDateTime(lastInbound)}
//                     </p>
//                   </div>
//                   <div>
//                     <p className="text-[10px] uppercase text-slate-400">
//                       Last outbound
//                     </p>
//                     <p className="mt-0.5 font-medium">
//                       {formatDateTime(lastOutbound)}
//                     </p>
//                   </div>
//                 </div>
//               </div>

//               {/* Tags */}
//               <div className="rounded-xl border border-slate-200 bg-white px-3 py-3">
//                 <div className="flex items-center justify-between mb-2">
//                   <div className="flex items-center gap-2">
//                     <div className="h-6 w-6 rounded-full bg-purple-50 flex items-center justify-center">
//                       <Tag className="h-3 w-3 text-purple-600" />
//                     </div>
//                     <p className="text-xs font-semibold text-slate-800">Tags</p>
//                   </div>
//                 </div>
//                 {tagsList.length === 0 ? (
//                   <p className="text-xs text-slate-500">
//                     No tags yet. You can tag this contact from the main Contacts
//                     view.
//                   </p>
//                 ) : (
//                   <div className="flex flex-wrap gap-1.5">
//                     {tagsList.map(tag => (
//                       <span
//                         key={tag.id || tag.tagId || tag.name}
//                         className="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px] text-slate-800"
//                       >
//                         {tag.color && (
//                           <span
//                             className="mr-1 h-2 w-2 rounded-full"
//                             style={{ backgroundColor: tag.color }}
//                           />
//                         )}
//                         {tag.name || tag.label || tag.tagName}
//                       </span>
//                     ))}
//                   </div>
//                 )}
//               </div>

//               {/* Next Reminder */}
//               <div className="rounded-xl border border-slate-200 bg-white px-3 py-3">
//                 <div className="flex items-center gap-2 mb-2">
//                   <div className="h-6 w-6 rounded-full bg-emerald-50 flex items-center justify-center">
//                     <Bell className="h-3 w-3 text-emerald-700" />
//                   </div>
//                   <p className="text-xs font-semibold text-slate-800">
//                     Next reminder
//                   </p>
//                 </div>
//                 {!nextReminder ? (
//                   <p className="text-xs text-slate-500">
//                     No upcoming reminder scheduled.
//                   </p>
//                 ) : (
//                   <div className="space-y-1 text-xs text-slate-700">
//                     <p className="font-medium">
//                       {nextReminder.title || nextReminder.subject || "Reminder"}
//                     </p>
//                     {nextReminder.dueAt && (
//                       <p className="flex items-center gap-1 text-slate-500">
//                         <Clock className="h-3 w-3" />
//                         {formatDateTime(
//                           nextReminder.dueAt ||
//                             nextReminder.dueDate ||
//                             nextReminder.remindAt
//                         )}
//                       </p>
//                     )}
//                     {nextReminder.note && (
//                       <p className="text-[11px] text-slate-500">
//                         {nextReminder.note}
//                       </p>
//                     )}
//                   </div>
//                 )}
//               </div>

//               {/* Recent Notes */}
//               <div className="rounded-xl border border-slate-200 bg-white px-3 py-3">
//                 <div className="flex items-center gap-2 mb-2">
//                   <div className="h-6 w-6 rounded-full bg-sky-50 flex items-center justify-center">
//                     <StickyNote className="h-3 w-3 text-sky-700" />
//                   </div>
//                   <p className="text-xs font-semibold text-slate-800">
//                     Recent notes
//                   </p>
//                 </div>
//                 {recentNotes.length === 0 ? (
//                   <p className="text-xs text-slate-500">
//                     No notes yet. Use the Notes module in CRM to add context for
//                     this lead.
//                   </p>
//                 ) : (
//                   <div className="space-y-2">
//                     {recentNotes.map(note => (
//                       <div
//                         key={note.id || note.noteId}
//                         className="rounded-lg border border-slate-100 bg-slate-50 px-2 py-1.5"
//                       >
//                         <p className="text-[11px] font-medium text-slate-800">
//                           {note.title || "Note"}
//                         </p>
//                         {note.content && (
//                           <p className="mt-0.5 text-[11px] text-slate-600 line-clamp-2">
//                             {note.content}
//                           </p>
//                         )}
//                         {note.createdAt && (
//                           <p className="mt-0.5 text-[10px] text-slate-400">
//                             {formatDateTime(note.createdAt)}
//                           </p>
//                         )}
//                       </div>
//                     ))}
//                   </div>
//                 )}
//               </div>

//               {/* Recent Timeline */}
//               <div className="rounded-xl border border-slate-200 bg-white px-3 py-3 mb-2">
//                 <div className="flex items-center gap-2 mb-2">
//                   <div className="h-6 w-6 rounded-full bg-indigo-50 flex items-center justify-center">
//                     <Activity className="h-3 w-3 text-indigo-700" />
//                   </div>
//                   <p className="text-xs font-semibold text-slate-800">
//                     Recent activity
//                   </p>
//                 </div>
//                 {recentTimeline.length === 0 ? (
//                   <p className="text-xs text-slate-500">
//                     No recent timeline events captured for this contact yet.
//                   </p>
//                 ) : (
//                   <ol className="space-y-1.5 text-[11px] text-slate-700">
//                     {recentTimeline.map(item => (
//                       <li
//                         key={item.id || item.eventId || item.occurredAt}
//                         className="flex items-start gap-2"
//                       >
//                         <span className="mt-1 h-1.5 w-1.5 rounded-full bg-indigo-500 flex-shrink-0" />
//                         <div>
//                           <p className="font-medium">
//                             {item.title || item.type || "Event"}
//                           </p>
//                           {item.description && (
//                             <p className="text-[11px] text-slate-600 line-clamp-2">
//                               {item.description}
//                             </p>
//                           )}
//                           {item.occurredAt && (
//                             <p className="text-[10px] text-slate-400 mt-0.5">
//                               {formatDateTime(item.occurredAt)}
//                             </p>
//                           )}
//                         </div>
//                       </li>
//                     ))}
//                   </ol>
//                 )}
//               </div>
//             </>
//           )}
//         </div>
//       </div>
//     </div>
//   );
// }

// import React, { useState } from "react";
// import TopBar from "./components/ContactsTopBar";
// import ContactsTable from "./components/ContactsTable";
// import ContactFormModal from "./components/ContactFormModal";
// import BulkActionsBar from "./components/BulkActionsBar";

// function Contacts() {
//   const [isModalOpen, setIsModalOpen] = useState(false);
//   const [selectedContact, setSelectedContact] = useState(null);
//   const [refreshTrigger, setRefreshTrigger] = useState(0);
//   const [currentPage, setCurrentPage] = useState(1); // âœ… Added here
//   const [activeTab, setActiveTab] = useState("all");
//   const [searchTerm, setSearchTerm] = useState("");
//   const [selectedIds, setSelectedIds] = useState([]);

//   const handleAddNew = () => {
//     setSelectedContact(null);
//     setIsModalOpen(true);
//   };

//   const handleEdit = contact => {
//     setSelectedContact(contact);
//     setIsModalOpen(true);
//   };

//   const handleSaveComplete = () => {
//     setIsModalOpen(false);
//     setSelectedContact(null);
//     setCurrentPage(1); // âœ… Reset to page 1 on save
//     setRefreshTrigger(prev => prev + 1);
//   };

//   const handleSelectionChange = ids => {
//     setSelectedIds(ids);
//   };

//   const clearSelection = () => {
//     setSelectedIds([]);
//   };

//   return (
//     <div className="p-4 space-y-4">
//       <TopBar
//         onAddClick={handleAddNew}
//         activeTab={activeTab}
//         onTabChange={setActiveTab}
//         onSearchChange={setSearchTerm}
//       />

//       {selectedIds.length > 0 && (
//         <BulkActionsBar
//           selectedIds={selectedIds}
//           onClearSelection={clearSelection}
//           onRefresh={() => setRefreshTrigger(prev => prev + 1)}
//         />
//       )}

//       <ContactsTable
//         onEdit={handleEdit}
//         activeTab={activeTab}
//         refreshTrigger={refreshTrigger}
//         searchTerm={searchTerm}
//         onSelectionChange={handleSelectionChange}
//         selectedIds={selectedIds}
//         currentPage={currentPage}
//         setCurrentPage={setCurrentPage} // âœ… Pass down
//       />

//       <ContactFormModal
//         isOpen={isModalOpen}
//         onClose={() => setIsModalOpen(false)}
//         contact={selectedContact}
//         onSaveComplete={handleSaveComplete}
//       />
//     </div>
//   );
// }

// export default Contacts;
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\ContactsTopBar.jsx 
====================================================== 
 
// ğŸ“„ File: src/pages/Contacts/ContactsTopBar.jsx

import { useState } from "react";
import { Search, Filter, Plus } from "lucide-react";

const tabs = [
  { id: "all", label: "All Contacts", count: 266 },
  { id: "favourites", label: "Favourites", count: 86 },
  { id: "groups", label: "Groups", count: 23 },
  { id: "archived", label: "Archived", count: 8 },
];

export default function ContactsTopBar({ onAdd }) {
  const [activeTab, setActiveTab] = useState("all");
  const [search, setSearch] = useState("");

  return (
    <div className="flex flex-col gap-4 mb-6">
      {/* ğŸ” Search + Actions */}
      <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-3">
        <div className="flex items-center w-full md:max-w-sm bg-white border border-gray-300 rounded-lg px-3 py-2 shadow-sm">
          <Search size={18} className="text-gray-400 mr-2" />
          <input
            type="text"
            placeholder="Search contact, group or project"
            value={search}
            onChange={e => setSearch(e.target.value)}
            className="w-full outline-none text-sm text-gray-700"
          />
        </div>

        <div className="flex items-center gap-2 mt-2 md:mt-0">
          <button className="text-sm text-gray-600 hover:text-purple-700 flex items-center gap-1 border px-3 py-2 rounded-md border-gray-300">
            <Filter size={16} />
            <span className="hidden sm:inline">Filter</span>
          </button>
          <button
            onClick={onAdd}
            className="bg-purple-600 hover:bg-purple-700 text-white text-sm px-4 py-2 rounded-md flex items-center gap-2 shadow"
          >
            <Plus size={16} />
            Add Contact
          </button>
        </div>
      </div>

      {/* ğŸ“ Tabs */}
      <div className="flex items-center gap-6 border-b border-gray-200 text-sm font-medium">
        {tabs.map(tab => (
          <button
            key={tab.id}
            onClick={() => setActiveTab(tab.id)}
            className={`pb-2 border-b-2 ${
              activeTab === tab.id
                ? "border-purple-600 text-purple-700"
                : "border-transparent text-gray-500 hover:text-purple-600"
            }`}
          >
            {tab.label}{" "}
            <span className="text-xs text-gray-400 ml-1">({tab.count})</span>
          </button>
        ))}
      </div>
    </div>
  );
}
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\CsvUploadModal.jsx 
====================================================== 
 
import React, { useState } from "react";
import { toast } from "react-toastify";
import axios from "axios";

// Props: isOpen (bool), onClose (fn), onUploadComplete (contacts, skipSaving)
export default function CsvUploadModal({ isOpen, onClose, onUploadComplete }) {
  const [file, setFile] = useState(null);
  const [skipSaving, setSkipSaving] = useState(false);
  const [uploading, setUploading] = useState(false);

  const handleFileChange = e => {
    setFile(e.target.files[0]);
  };

  const handleUpload = async () => {
    if (!file) {
      toast.warn("âš ï¸ Please select a CSV file.");
      return;
    }

    const formData = new FormData();
    formData.append("file", file);

    setUploading(true);
    try {
      const res = await axios.post("/api/contacts/parse-csv", formData, {
        headers: {
          "Content-Type": "multipart/form-data",
        },
      });

      const contacts = res.data;
      if (!Array.isArray(contacts) || contacts.length === 0) {
        toast.error("âŒ No valid contacts parsed from file.");
        return;
      }

      toast.success("âœ… CSV parsed successfully!");
      onUploadComplete(contacts, skipSaving);
      setFile(null); // ğŸ” Reset file after success
      onClose();
    } catch (err) {
      console.error("âŒ Upload error:", err);
      toast.error("âŒ Failed to parse CSV. Please check format.");
    } finally {
      setUploading(false);
    }
  };

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
      <div className="bg-white p-6 rounded-xl shadow-md w-full max-w-md space-y-4">
        <h2 className="text-xl font-bold text-purple-700">
          ğŸ“¥ Upload CSV File
        </h2>

        <input type="file" accept=".csv" onChange={handleFileChange} />

        <div className="flex items-center space-x-2">
          <input
            type="checkbox"
            checked={skipSaving}
            onChange={e => setSkipSaving(e.target.checked)}
          />
          <label className="text-sm">
            Don't save contacts to CRM (temporary)
          </label>
        </div>

        <div className="flex justify-end gap-3 mt-4">
          <button
            onClick={onClose}
            className="px-4 py-2 rounded bg-gray-200 hover:bg-gray-300 text-sm"
          >
            Cancel
          </button>
          <button
            onClick={handleUpload}
            disabled={uploading}
            className="px-4 py-2 rounded bg-purple-600 text-white hover:bg-purple-700 text-sm"
          >
            {uploading ? "â³ Uploading..." : "ğŸš€ Upload"}
          </button>
        </div>
      </div>
    </div>
  );
}
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\MakeDump.bat 
====================================================== 
 
@echo off
REM This script will find relevant source files and output their names and contents into one file.
REM The output file will be named [FolderName]_AllFileDump.txt.

REM Get the current folder's name and set it as the output file name with the custom suffix
for %%I in ("%cd%") do set "outputFile=%%~nI_AllFileDump.txt"

REM Clear the output file to start fresh and write a small header
> "%outputFile%" (
    echo Folder and File Content Report
    echo Root folder: %cd%
    echo Generated at: %date% %time%
)
echo. >> "%outputFile%"

REM NOTE:
REM We now only dump RELEVANT text/code files (no binaries, no images, no node_modules, etc.)
REM This keeps the file smaller and much easier to review.

REM Loop through all relevant files in the current directory and subdirectories
REM Extensions included: C#, JS/TS/React, JSON, config, SQL, Markdown, YAML
for /R . %%F in (*.cs *.csproj *.jsx *.tsx *.js *.ts *.json *.config *.sql *.md *.yml *.yaml *.bat) do (

    REM Skip some noisy folders by path substring (node_modules, bin, obj, .git, dist, .vs)
    echo "%%F" | findstr /I /C:"\node_modules\" /C:"\bin\" /C:"\obj\" /C:"\.git\" /C:"\dist\" /C:"\.vs\" >nul
    if errorlevel 1 (
        echo ====================================================== >> "%outputFile%"
        echo FILE: %%F >> "%outputFile%"
        echo ====================================================== >> "%outputFile%"
        echo. >> "%outputFile%"
        type "%%F" >> "%outputFile%" 2>nul
        echo. >> "%outputFile%"
        echo. >> "%outputFile%"
    )
)

echo Finished! All content has been extracted to %outputFile%
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\components\BulkActionsBar.jsx 
====================================================== 
 
import React, { useEffect, useState } from "react";
import { toast } from "react-toastify";

import axiosClient from "../../../../api/axiosClient";

function BulkActionsBar({ selectedIds = [], onClearSelection, onRefresh }) {
  const [availableTags, setAvailableTags] = useState([]);
  const [selectedTagId, setSelectedTagId] = useState("");

  useEffect(() => {
    if (selectedIds.length > 0) {
      fetchTags();
    }
  }, [selectedIds.length]);

  const fetchTags = async () => {
    try {
      const res = await axiosClient.get("/tags");
      setAvailableTags(res.data.data || []);
    } catch (error) {
      toast.error("Failed to load tags.");
    }
  };

  const handleApplyTag = async () => {
    if (!selectedTagId) {
      toast.warn("Select a tag first.");
      return;
    }

    try {
      await axiosClient.post("/contacts/bulk-assign-tag", {
        contactIds: selectedIds,
        tagId: selectedTagId,
      });

      toast.success("Tag applied to selected contacts.");
      onClearSelection?.();
      onRefresh?.();
    } catch (error) {
      const message =
        error.response?.data?.message || "Failed to apply tag.";
      toast.error(message);
    }
  };

  if (selectedIds.length === 0) return null;

  return (
    <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 px-4 py-3 bg-emerald-50/60 border border-emerald-200/70">
      <p className="text-sm text-slate-700 font-medium">
        {selectedIds.length} selected
      </p>

      <div className="flex flex-col sm:flex-row items-stretch sm:items-center gap-2 w-full sm:w-auto">
        <select
          value={selectedTagId}
          onChange={e => setSelectedTagId(e.target.value)}
          className="border border-slate-200 rounded-md px-3 py-2 text-sm bg-white w-full sm:w-60"
        >
          <option value="">Select tagâ€¦</option>
          {availableTags.map(tag => (
            <option key={tag.id} value={tag.id}>
              {tag.name}
            </option>
          ))}
        </select>

        <button
          onClick={handleApplyTag}
          className="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-md text-sm shadow-sm"
        >
          Apply tag
        </button>

        <button
          onClick={onClearSelection}
          className="text-sm text-slate-600 hover:text-slate-900"
        >
          Clear selection
        </button>
      </div>
    </div>
  );
}

export default BulkActionsBar;
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\components\checkbox.jsx 
====================================================== 
 
// ğŸ“„ File: src/pages/Contacts/components/checkbox.jsx

import React from "react";

export const Checkbox = React.forwardRef(
  ({ className = "", checked, onCheckedChange, ...props }, ref) => {
    return (
      <input
        type="checkbox"
        ref={ref}
        checked={checked}
        className={`w-4 h-4 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 ${className}`}
        {...props}
        onChange={e => onCheckedChange?.(e.target.checked)}
      />
    );
  }
);

Checkbox.displayName = "Checkbox";
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\components\ContactFormModal.jsx 
====================================================== 
 
import React, { useEffect, useState } from "react";
import axiosClient from "../../../../api/axiosClient";
import { toast } from "react-toastify";
import TagSelector from "../../Tags/TagSelector";
import CustomFieldsEditor from "../../../CustomFields/components/CustomFieldsEditor";

const leadSources = [
  "Manual",
  "Website Form",
  "Google Search",
  "Facebook Ad",
  "LinkedIn",
  "Referral",
  "Trade Show",
  "Cold Call",
  "Other",
];

function ContactFormModal({ isOpen, onClose, contact, onSaveComplete }) {
  const [formData, setFormData] = useState({
    name: "",
    phoneNumber: "",
    email: "",
    leadSource: "Manual",
    notes: "",
    tagIds: [],
  });
  const [allTags, setAllTags] = useState([]);
  const [isSaving, setIsSaving] = useState(false);

  useEffect(() => {
    const fetchTags = async () => {
      try {
        const res = await axiosClient.get("/tags");
        const list = Array.isArray(res.data)
          ? res.data
          : Array.isArray(res.data?.data)
          ? res.data.data
          : [];
        setAllTags(list);
      } catch (error) {
        console.error("Failed to load tags:", error);
        toast.error("Failed to load tags.");
      }
    };

    if (isOpen) {
      fetchTags();
    }
  }, [isOpen]);

  useEffect(() => {
    if (contact) {
      const existing =
        contact.tags ||
        contact.contactTags ||
        contact.tagSummaries ||
        contact.tagList ||
        [];
      const tagIds = Array.isArray(existing)
        ? existing.map(t => t.tagId || t.id).filter(Boolean)
        : [];
      setFormData({
        name: contact.name || "",
        phoneNumber: contact.phoneNumber || "",
        email: contact.email || "",
        leadSource: contact.leadSource || "Manual",
        notes: contact.notes || "",
        tagIds,
      });
    } else {
      setFormData({
        name: "",
        phoneNumber: "",
        email: "",
        leadSource: "Manual",
        notes: "",
        tagIds: [],
      });
    }
  }, [contact, isOpen]);

  const handleChange = e => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  const handleSubmit = async e => {
    e.preventDefault();

    const creating = !contact?.id;
    if (creating && allTags.length > 0 && formData.tagIds.length === 0) {
      toast.warn("Please select at least one tag for this contact.");
      return;
    }

    setIsSaving(true);

    const payload = {
      ...formData,
      tagIds: formData.tagIds,
    };

    try {
      if (contact?.id) {
        await axiosClient.put(`/contacts/${contact.id}`, payload); // Assuming PUT doesn't need "add"
        toast.success("âœ… Contact updated successfully!");
      } else {
        // ğŸ‘‡ FIX #1: Using the correct endpoint for creating a contact.
        await axiosClient.post("/contacts/create", payload);
        toast.success("âœ… Contact created successfully!");
      }
      onSaveComplete?.();
      onClose();
    } catch (err) {
      // ğŸ‘‡ FIX #2: Specific error handling for duplicate contacts.
      if (err.response && err.response.status === 409) {
        // 409 Conflict status means the contact already exists.
        toast.warn(
          err.response.data.message ||
            "Contact with this phone number already exists."
        );
      } else {
        // Handle all other errors (like 404 Not Found, 500 Server Error, etc.)
        const errorMessage =
          err.response?.data?.message || "Failed to save contact.";
        toast.error(errorMessage);
      }
    } finally {
      setIsSaving(false);
    }
  };

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 bg-black bg-opacity-40 z-50 flex items-center justify-center p-4">
      <div className="bg-white p-6 rounded-xl shadow-lg w-full max-w-2xl relative">
        <button
          onClick={onClose}
          className="absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-2xl"
        >
          &times;
        </button>

        <h2 className="text-xl font-bold mb-4">
          {contact?.id ? "Edit Contact" : "Add New Contact"}
        </h2>

        <form
          onSubmit={handleSubmit}
          className="grid grid-cols-1 md:grid-cols-2 gap-4"
        >
          <input
            name="name"
            value={formData.name}
            onChange={handleChange}
            placeholder="Full Name *"
            required
            className="border px-3 py-2 rounded w-full"
          />
          <input
            name="phoneNumber"
            value={formData.phoneNumber}
            onChange={handleChange}
            placeholder="Phone Number *"
            required
            className="border px-3 py-2 rounded w-full"
          />
          <input
            type="email"
            name="email"
            value={formData.email}
            onChange={handleChange}
            placeholder="Email"
            className="border px-3 py-2 rounded w-full"
          />
          <select
            name="leadSource"
            value={formData.leadSource}
            onChange={handleChange}
            className="border px-3 py-2 rounded w-full"
          >
            {leadSources.map(source => (
              <option key={source} value={source}>
                {source}
              </option>
            ))}
          </select>

          <div className="md:col-span-2 space-y-1">
            <label className="text-sm font-medium text-slate-700">Tags</label>
            {allTags.length === 0 ? (
              <div className="text-xs text-slate-600 bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 flex items-center justify-between gap-3">
                <span>
                  No tags yet. Create a tag first to segment contacts.
                </span>
                <button
                  type="button"
                  onClick={() => window.open("/app/crm/tags", "_blank")}
                  className="text-emerald-700 font-semibold hover:text-emerald-800 whitespace-nowrap"
                >
                  Create tag
                </button>
              </div>
            ) : (
              <TagSelector
                tags={allTags}
                selected={formData.tagIds}
                onChange={ids =>
                  setFormData(prev => ({ ...prev, tagIds: ids }))
                }
                multi
              />
            )}
            {!contact?.id && allTags.length > 0 && (
              <p className="text-[11px] text-slate-500">
                At least one tag is required for new contacts.
              </p>
            )}
          </div>
          <textarea
            name="notes"
            value={formData.notes}
            onChange={handleChange}
            placeholder="Notes..."
            className="md:col-span-2 border px-3 py-2 rounded w-full min-h-[80px]"
          ></textarea>

          <div className="md:col-span-2 space-y-2">
            <div className="flex items-center justify-between">
              <h3 className="text-sm font-semibold text-slate-700">
                Custom Fields
              </h3>
              <span className="text-[11px] text-slate-400">
                CRM contact attributes
              </span>
            </div>

            {contact?.id ? (
              <CustomFieldsEditor entityType="Contact" entityId={contact.id} />
            ) : (
              <div className="rounded-lg border border-slate-100 bg-slate-50 px-3 py-2 text-xs text-slate-500">
                Save contact first, then you can fill custom fields.
              </div>
            )}
          </div>
          <div className="md:col-span-2 flex justify-end gap-3">
            <button
              type="button"
              onClick={onClose}
              className="bg-gray-200 text-gray-800 px-6 py-2 rounded hover:bg-gray-300"
            >
              Cancel
            </button>
            <button
              type="submit"
              disabled={isSaving}
              className="bg-emerald-600 text-white px-6 py-2 rounded hover:bg-emerald-700 disabled:bg-emerald-300"
            >
              {isSaving
                ? "Saving..."
                : contact?.id
                ? "Update Contact"
                : "Add Contact"}
            </button>
          </div>
        </form>
      </div>
    </div>
  );
}

export default ContactFormModal;

// import React, { useEffect, useState } from "react";
// import axiosClient from "../../../api/axiosClient";
// import { toast } from "react-toastify";

// // ğŸ‘‡ FIX #1: Define the list of lead sources.
// const leadSources = [
//   "Manual",
//   "Website Form",
//   "Google Search",
//   "Facebook Ad",
//   "LinkedIn",
//   "Referral",
//   "Trade Show",
//   "Cold Call",
//   "Other",
// ];

// function ContactFormModal({ isOpen, onClose, contact, onSaveComplete }) {
//   const [formData, setFormData] = useState({
//     name: "",
//     phoneNumber: "",
//     email: "",
//     // ğŸ‘‡ FIX #2: Set the default leadSource to "Manual".
//     leadSource: "Manual",
//     notes: "",
//     tagId: "",
//   });
//   const [allTags, setAllTags] = useState([]);
//   const [isSaving, setIsSaving] = useState(false);

//   useEffect(() => {
//     const fetchTags = async () => {
//       try {
//         const res = await axiosClient.get("/tags/get-tags");
//         setAllTags(res.data.data || []);
//       } catch (error) {
//         console.error("Failed to load tags:", error);
//         toast.error("âŒ Failed to load tags");
//       }
//     };

//     if (isOpen) {
//       fetchTags();
//     }
//   }, [isOpen]);

//   useEffect(() => {
//     if (contact) {
//       setFormData({
//         name: contact.name || "",
//         phoneNumber: contact.phoneNumber || "",
//         email: contact.email || "",
//         leadSource: contact.leadSource || "Manual",
//         notes: contact.notes || "",
//         tagId: contact.tags?.[0]?.tagId || "",
//       });
//     } else {
//       // Reset form for a new contact
//       setFormData({
//         name: "",
//         phoneNumber: "",
//         email: "",
//         leadSource: "Manual",
//         notes: "",
//         tagId: "",
//       });
//     }
//   }, [contact, isOpen]);

//   const handleChange = e => {
//     const { name, value } = e.target;
//     setFormData(prev => ({ ...prev, [name]: value }));
//   };

//   const handleSubmit = async e => {
//     e.preventDefault();
//     setIsSaving(true);

//     const payload = {
//       ...formData,
//       tagIds: formData.tagId ? [formData.tagId] : [],
//     };
//     delete payload.tagId;

//     try {
//       if (contact?.id) {
//         await axiosClient.put(`/contacts/add/${contact.id}`, payload);
//         toast.success("âœ… Contact updated successfully!");
//       } else {
//         await axiosClient.post("/contacts", payload);
//         toast.success("âœ… Contact created successfully!");
//       }
//       onSaveComplete?.();
//       onClose();
//     } catch (err) {
//       const errorMessage =
//         err.response?.data?.message || "âŒ Failed to save contact.";
//       toast.error(errorMessage);
//     } finally {
//       setIsSaving(false);
//     }
//   };

//   if (!isOpen) return null;

//   return (
//     <div className="fixed inset-0 bg-black bg-opacity-40 z-50 flex items-center justify-center p-4">
//       <div className="bg-white p-6 rounded-xl shadow-lg w-full max-w-2xl relative">
//         <button
//           onClick={onClose}
//           className="absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-2xl"
//         >
//           &times;
//         </button>

//         <h2 className="text-xl font-bold mb-4">
//           {contact?.id ? "Edit Contact" : "Add New Contact"}
//         </h2>

//         <form
//           onSubmit={handleSubmit}
//           className="grid grid-cols-1 md:grid-cols-2 gap-4"
//         >
//           <input
//             name="name"
//             value={formData.name}
//             onChange={handleChange}
//             placeholder="Full Name *"
//             required
//             className="border px-3 py-2 rounded w-full"
//           />
//           <input
//             name="phoneNumber"
//             value={formData.phoneNumber}
//             onChange={handleChange}
//             placeholder="Phone Number *"
//             required
//             className="border px-3 py-2 rounded w-full"
//           />
//           <input
//             type="email"
//             name="email"
//             value={formData.email}
//             onChange={handleChange}
//             placeholder="Email"
//             className="border px-3 py-2 rounded w-full"
//           />

//           {/* ğŸ‘‡ FIX #3: Replaced the text input with a select dropdown. */}
//           <select
//             name="leadSource"
//             value={formData.leadSource}
//             onChange={handleChange}
//             className="border px-3 py-2 rounded w-full"
//           >
//             {leadSources.map(source => (
//               <option key={source} value={source}>
//                 {source}
//               </option>
//             ))}
//           </select>

//           <select
//             name="tagId"
//             value={formData.tagId}
//             onChange={handleChange}
//             className="md:col-span-2 border px-3 py-2 rounded w-full"
//           >
//             <option value="">-- No Tag --</option>
//             {allTags.map(tag => (
//               <option key={tag.id} value={tag.id}>
//                 {tag.name}
//               </option>
//             ))}
//           </select>

//           <textarea
//             name="notes"
//             value={formData.notes}
//             onChange={handleChange}
//             placeholder="Notes..."
//             className="md:col-span-2 border px-3 py-2 rounded w-full min-h-[80px]"
//           ></textarea>

//           <div className="md:col-span-2 flex justify-end gap-3">
//             <button
//               type="button"
//               onClick={onClose}
//               className="bg-gray-200 text-gray-800 px-6 py-2 rounded hover:bg-gray-300"
//             >
//               Cancel
//             </button>
//             <button
//               type="submit"
//               disabled={isSaving}
//               className="bg-purple-600 text-white px-6 py-2 rounded hover:bg-purple-700 disabled:bg-purple-300"
//             >
//               {isSaving
//                 ? "Saving..."
//                 : contact?.id
//                 ? "Update Contact"
//                 : "Add Contact"}
//             </button>
//           </div>
//         </form>
//       </div>
//     </div>
//   );
// }

// export default ContactFormModal;
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\components\ContactsTable.jsx 
====================================================== 
 
import React, { useEffect, useState, useCallback } from "react";
import { useNavigate } from "react-router-dom";
import { toast } from "react-toastify";
import { MoreVertical } from "lucide-react";

import axiosClient from "../../../../api/axiosClient";
import { Checkbox } from "./checkbox";
import {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
} from "./dropdown-menu";

function getInitials(name) {
  if (!name) return "";
  return name
    .split(" ")
    .slice(0, 2)
    .map(w => w[0])
    .join(" ")
    .toUpperCase();
}

export default function ContactsTable({
  onEdit,
  refreshTrigger,
  activeTab,
  onSelectionChange,
  searchTerm,
  currentPage,
  setCurrentPage,
  density = "compact",
}) {
  const [contacts, setContacts] = useState([]);
  const [totalPages, setTotalPages] = useState(1);
  const [selectedIds, setSelectedIds] = useState([]);
  const pageSize = 20;
  const navigate = useNavigate();

  const fetchContacts = useCallback(async () => {
    try {
      const res = await axiosClient.get("/contacts/", {
        params: {
          tab: activeTab,
          search: searchTerm,
          page: currentPage,
          pageSize,
        },
      });

      const result = res.data.data;
      setContacts(Array.isArray(result?.items) ? result.items : []);

      const total = result?.totalPages > 0 ? result.totalPages : 1;
      setTotalPages(total);
    } catch (err) {
      const message =
        err.response?.data?.message || "Failed to load contacts.";
      toast.error(message);
    }
  }, [activeTab, searchTerm, currentPage, pageSize]);

  useEffect(() => {
    fetchContacts();
  }, [refreshTrigger, activeTab, searchTerm, currentPage, fetchContacts]);

  const handleSelectAll = checked => {
    const ids = checked ? contacts.map(c => c.id) : [];
    setSelectedIds(ids);
    onSelectionChange?.(ids);
  };

  const handleRowCheckbox = (checked, id) => {
    const updated = checked
      ? [...selectedIds, id]
      : selectedIds.filter(i => i !== id);
    setSelectedIds(updated);
    onSelectionChange?.(updated);
  };

  const handleDelete = async id => {
    if (!window.confirm("Are you sure you want to delete this contact?"))
      return;
    try {
      await axiosClient.delete(`/contacts/${id}`);
      toast.success("Contact deleted.");
      fetchContacts();
    } catch (err) {
      const message =
        err.response?.data?.message || "Failed to delete contact.";
      toast.error(message);
    }
  };

  const isCompact = density === "compact";
  const rowPadding = isCompact ? "py-2" : "py-3";
  const nameGap = isCompact ? "gap-2" : "gap-3";
  const avatarSize = isCompact ? "h-7 w-7 text-[10px]" : "h-8 w-8 text-[11px]";

  return (
    <div className="overflow-x-auto rounded-xl border border-slate-200 shadow-sm bg-white">
      <table className="w-full text-sm text-slate-700">
        <thead className="bg-slate-50">
          <tr>
            <th className={`px-4 ${rowPadding} text-center w-6 border-b border-slate-200`}>
              <Checkbox
                checked={
                  contacts.length > 0 && selectedIds.length === contacts.length
                }
                onCheckedChange={handleSelectAll}
                className="w-4 h-4"
              />
            </th>
            <th className={`px-4 ${rowPadding} text-left border-b border-slate-200 text-xs font-semibold uppercase tracking-wide text-slate-500`}>
              Name
            </th>
            <th className={`px-4 ${rowPadding} text-left border-b border-slate-200 text-xs font-semibold uppercase tracking-wide text-slate-500`}>
              Phone
            </th>
            <th className={`px-4 ${rowPadding} text-left border-b border-slate-200 text-xs font-semibold uppercase tracking-wide text-slate-500 hidden md:table-cell`}>
              Email
            </th>
            <th className={`px-4 ${rowPadding} text-left border-b border-slate-200 text-xs font-semibold uppercase tracking-wide text-slate-500 hidden lg:table-cell`}>
              Created
            </th>
            <th className={`px-4 ${rowPadding} text-center w-8 border-b border-slate-200 text-xs font-semibold uppercase tracking-wide text-slate-500`}>
              Actions
            </th>
          </tr>
        </thead>
        <tbody className="divide-y divide-slate-100">
          {contacts.length === 0 ? (
            <tr>
              <td
                colSpan={6}
                className="px-6 py-12 text-center text-slate-500"
              >
                <p className="text-sm font-medium text-slate-700">
                  No contacts found
                </p>
                <p className="mt-1 text-xs">
                  Try a different search or add a new contact.
                </p>
              </td>
            </tr>
          ) : (
            contacts.map(contact => (
              <tr key={contact.id} className="hover:bg-slate-50">
                <td className={`px-4 ${rowPadding} text-center align-middle`}>
                  <Checkbox
                    checked={selectedIds.includes(contact.id)}
                    onCheckedChange={checked =>
                      handleRowCheckbox(checked, contact.id)
                    }
                    className="w-4 h-4"
                  />
                </td>
                <td className={`px-4 ${rowPadding} flex items-center ${nameGap}`}>
                  <div className={`${avatarSize} rounded-full bg-emerald-100 text-emerald-700 flex items-center justify-center font-semibold`}>
                    {getInitials(contact.name)}
                  </div>
                  <span className={`font-medium truncate ${isCompact ? "text-[13px]" : ""}`}>
                    {contact.name || "Unnamed contact"}
                  </span>
                </td>

                <td className={`px-4 ${rowPadding} truncate ${isCompact ? "text-[13px]" : ""}`}>
                  {contact.phoneNumber || "-"}
                </td>
                <td className={`px-4 ${rowPadding} hidden md:table-cell truncate ${isCompact ? "text-[13px]" : ""}`}>
                  {contact.email || "-"}
                </td>
                <td className={`px-4 ${rowPadding} hidden lg:table-cell truncate ${isCompact ? "text-[13px]" : ""}`}>
                  {contact.createdAt
                    ? new Date(contact.createdAt).toLocaleDateString()
                    : "-"}
                </td>
                <td className={`px-4 ${rowPadding} text-center`}>
                  <DropdownMenu>
                    <DropdownMenuTrigger asChild>
                      <button className="p-1.5 rounded-md hover:bg-slate-100 focus:outline-none">
                        <MoreVertical size={16} />
                      </button>
                    </DropdownMenuTrigger>
                    <DropdownMenuContent className="w-40 rounded-lg shadow-lg border bg-white">
                      <DropdownMenuItem
                        onClick={() => onEdit(contact)}
                        className="px-3 py-2 hover:bg-slate-50 text-sm"
                      >
                        Edit
                      </DropdownMenuItem>
                      <DropdownMenuItem
                        onClick={() => handleDelete(contact.id)}
                        className="px-3 py-2 hover:bg-red-50 text-red-600 text-sm"
                      >
                        Delete
                      </DropdownMenuItem>
                      <DropdownMenuItem
                        onClick={() =>
                          navigate(`/dashboard/contacts/${contact.id}/notes`)
                        }
                        className="px-3 py-2 hover:bg-slate-50 text-sm"
                      >
                        Notes
                      </DropdownMenuItem>
                    </DropdownMenuContent>
                  </DropdownMenu>
                </td>
              </tr>
            ))
          )}
        </tbody>
      </table>

      <div className="flex justify-between items-center gap-3 px-4 py-3 text-sm text-slate-600 border-t border-slate-100">
        <span className="text-xs">
          Page {currentPage} of {totalPages}
        </span>
        <div className="flex items-center gap-2">
          <button
            onClick={() => setCurrentPage(p => Math.max(p - 1, 1))}
            disabled={currentPage === 1}
            className="px-3 py-1.5 border border-slate-200 rounded-md disabled:opacity-50 hover:bg-slate-50"
          >
            Prev
          </button>
          <button
            onClick={() => setCurrentPage(p => Math.min(p + 1, totalPages))}
            disabled={currentPage === totalPages}
            className="px-3 py-1.5 border border-slate-200 rounded-md disabled:opacity-50 hover:bg-slate-50"
          >
            Next
          </button>
        </div>
      </div>
    </div>
  );
}
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\components\ContactsTopBar.jsx 
====================================================== 
 
import { Search, Plus, SlidersHorizontal } from "lucide-react";

export default function ContactsTopBar({
  onAddClick,
  onSearchChange,
  activeTab,
  onTabChange,
  searchTerm,
  onFilterClick,
  density = "compact",
  onDensityChange,
}) {
  const tabs = [
    { key: "all", label: "All" },
    { key: "favourites", label: "Favourites" },
    { key: "archived", label: "Archived" },
    { key: "groups", label: "Groups" },
  ];

  return (
    <div className="space-y-3 px-4 py-3">
      <div className="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3">
        <div className="relative flex-1 max-w-xl">
          <Search
            size={16}
            className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"
          />
          <input
            type="text"
            placeholder="Search by name, phone, or emailâ€¦"
            value={searchTerm}
            onChange={e => onSearchChange?.(e.target.value)}
            className="w-full rounded-lg border border-slate-200 bg-white pl-9 pr-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-200"
          />
        </div>

        <div className="flex items-center gap-2 justify-end">
          <div className="inline-flex rounded-lg border border-slate-200 bg-white overflow-hidden">
            <button
              type="button"
              onClick={() => onDensityChange?.("comfortable")}
              className={`px-3 py-2 text-xs font-semibold transition-colors ${
                density === "comfortable"
                  ? "bg-slate-100 text-slate-900"
                  : "text-slate-600 hover:bg-slate-50"
              }`}
            >
              Comfortable
            </button>
            <button
              type="button"
              onClick={() => onDensityChange?.("compact")}
              className={`px-3 py-2 text-xs font-semibold transition-colors ${
                density === "compact"
                  ? "bg-slate-100 text-slate-900"
                  : "text-slate-600 hover:bg-slate-50"
              }`}
            >
              Compact
            </button>
          </div>
          <button
            onClick={onFilterClick}
            className="inline-flex items-center gap-2 px-3 py-2 rounded-lg text-sm border border-slate-200 text-slate-700 hover:bg-slate-50"
          >
            <SlidersHorizontal size={16} /> Filters
          </button>
          <button
            onClick={onAddClick}
            className="inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm bg-emerald-600 hover:bg-emerald-700 text-white shadow-sm"
          >
            <Plus size={16} /> Add contact
          </button>
        </div>
      </div>

      <div className="flex flex-wrap gap-2 text-sm font-medium">
        {tabs.map(tab => {
          const isActive = activeTab === tab.key;
          return (
            <button
              key={tab.key}
              onClick={() => onTabChange?.(tab.key)}
              className={`px-3 py-1.5 rounded-full border transition-colors ${
                isActive
                  ? "bg-emerald-50 border-emerald-200 text-emerald-900"
                  : "bg-white border-slate-200 text-slate-600 hover:bg-slate-50"
              }`}
            >
              {tab.label}
            </button>
          );
        })}
      </div>
    </div>
  );
}
 
 
====================================================== 
FILE: D:\xbytechat\xbytechat-ui\src\pages\CRM\Contacts\components\dropdown-menu.jsx 
====================================================== 
 
// ğŸ“„ File: src/pages/Contacts/components/dropdown-menu.jsx
import {
  Menu,
  MenuButton,
  MenuItems,
  MenuItem,
  Transition,
} from "@headlessui/react";
import { Fragment } from "react";

export function DropdownMenu({ children }) {
  return (
    <Menu as="div" className="relative inline-block text-left">
      {children}
    </Menu>
  );
}

export const DropdownMenuTrigger = ({ asChild, children }) => (
  <MenuButton as={Fragment}>{children}</MenuButton>
);

export const DropdownMenuContent = ({ children, className = "" }) => (
  <Transition
    as={Fragment}
    enter="transition ease-out duration-100"
    enterFrom="transform opacity-0 scale-95"
    enterTo="transform opacity-100 scale-100"
    leave="transition ease-in duration-75"
    leaveFrom="transform opacity-100 scale-100"
    leaveTo="transform opacity-0 scale-95"
  >
    <MenuItems
      className={`absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none ${className}`}
    >
      {children}
    </MenuItems>
  </Transition>
);

export const DropdownMenuItem = ({ children, onClick, className = "" }) => (
  <MenuItem>
    {({ active }) => (
      <button
        onClick={onClick}
        className={`${
          active ? "bg-gray-100" : ""
        } w-full px-4 py-2 text-sm text-left ${className}`}
      >
        {children}
      </button>
    )}
  </MenuItem>
);

// // ğŸ“„ File: src/pages/Contacts/components/dropdown-menu.jsx
// import {
//   Menu,
//   MenuButton,
//   MenuItems,
//   MenuItem,
//   Transition,
// } from "@headlessui/react";
// import { Fragment } from "react";

// export function DropdownMenu({ children }) {
//   return (
//     <Menu as="div" className="relative inline-block text-left">
//       {children}
//     </Menu>
//   );
// }

// export const DropdownMenuTrigger = ({ asChild, children }) => (
//   <MenuButton as={Fragment}>{children}</MenuButton>
// );

// export const DropdownMenuContent = ({ children, className = "" }) => (
//   <Transition
//     as={Fragment}
//     enter="transition ease-out duration-100"
//     enterFrom="transform opacity-0 scale-95"
//     enterTo="transform opacity-100 scale-100"
//     leave="transition ease-in duration-75"
//     leaveFrom="transform opacity-100 scale-100"
//     leaveTo="transform opacity-0 scale-95"
//   >
//     <MenuItems
//       className={`absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none ${className}`}
//     >
//       {children}
//     </MenuItems>
//   </Transition>
// );

// export const DropdownMenuItem = ({ children, onClick, className = "" }) => (
//   <MenuItem>
//     {({ active }) => (
//       <button
//         onClick={onClick}
//         className={`${
//           active ? "bg-gray-100" : ""
//         } w-full px-4 py-2 text-sm text-left ${className}`}
//       >
//         {children}
//       </button>
//     )}
//   </MenuItem>
// );
 
 
