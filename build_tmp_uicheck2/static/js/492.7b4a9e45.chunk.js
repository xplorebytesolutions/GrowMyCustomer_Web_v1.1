/*! For license information please see 492.7b4a9e45.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkxbytechat_ui=self.webpackChunkxbytechat_ui||[]).push([[492],{88492:(e,s,a)=>{a.r(s),a.d(s,{default:()=>j});var r=a(89379),i=a(78384),t=a(77784);const o=(0,t.A)("square-stack",[["path",{d:"M4 10c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"4i38lg"}],["path",{d:"M10 16c-1.1 0-2-.9-2-2v-4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"mlte4a"}],["rect",{width:"8",height:"8",x:"14",y:"14",rx:"2",key:"1fa9i4"}]]);var n=a(27033),l=a(37719);const d=(0,t.A)("bot-message-square",[["path",{d:"M12 6V2H8",key:"1155em"}],["path",{d:"m8 18-4 4V8a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2Z",key:"w2lp3e"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M9 11v2",key:"1ueba0"}],["path",{d:"M15 11v2",key:"i11awn"}],["path",{d:"M20 12h2",key:"1q8mjw"}]]);var c=a(26773),p=a(75686),m=a(81007),u=a(63961),h=a(5244),g=a(73216),x=a(65043),b=a(8927),f=a(65086),v=a(74961),y=a(63610),A=a(70579);const w={"business-approvals":[v.FK.SUPER_ADMIN_NEW_BUSINESS_APPROVAL],"plan-manager":[v.FK.SUPER_ADMIN_PLAN_MANAGER_VIEW],"plan-permissions":[v.FK.SUPER_ADMIN_PLAN_MANAGER_VIEW],"paln-permissions-list":[v.FK.SUPER_ADMIN_PLAN_PERMISSIONS_LIST],"esu-debug":[v.FK.SUPER_ADMIN_ESU_DEBUG],"account-signup-report":[v.FK.SUPER_ADMIN_SIGNUP_REPORT_VIEW],"business-overview":[v.FK.SUPER_ADMIN_BUSINESS_OVERVIEW],"webhook-monitor":[v.FK.SUPER_ADMIN_WEBHOOK_MONITOR],"user-permissions":[v.FK.SUPER_ADMIN_USER_MANAGEMENT_VIEW],"flow-execution-explorer":[v.FK.SUPER_ADMIN_FLOW_EXECUTION_EXPLORER_VIEW],"developer-notes":[v.FK.SUPER_ADMIN_WORKSPACE_VIEW],"server-troubleshooting":[v.FK.SUPER_ADMIN_WORKSPACE_VIEW]},N=[{id:"business-approvals",label:"Business Approvals",description:"Approve or reject pending business signups.",path:"/app/admin/approvals",icon:(0,A.jsx)(i.A,{size:22}),action:"Review Requests",roles:["superadmin","partner","reseller"]},{id:"plan-manager",label:"Plan \u2192 Feature Mapping",description:"Define feature limits for each plan tier.",path:"/app/admin/plan-management",icon:(0,A.jsx)(o,{size:22}),action:"Manage Plans",roles:["superadmin"]},{id:"paln-permissions-list",label:"Permissions list",description:"Define and organize permissions that power plans and workspace guards.",path:"/app/admin/permissions",icon:(0,A.jsx)(i.A,{size:22}),action:"Manage Permissions",roles:["superadmin"]},{id:"esu-debug",label:"FB Embedded Signup Debug",description:"Inspect ESU tokens/flags and locally deauthorize a workspace (dev / superadmin only).",path:"/app/admin/esu-debug",icon:(0,A.jsx)(i.A,{size:22}),action:"Open ESU Debug",roles:["superadmin"]},{id:"account-signup-report",label:"Signup Report",description:"Track signup \u2192 activation \u2192 WhatsApp setup \u2192 paid conversion across all accounts.",path:"/app/admin/account-insights",icon:(0,A.jsx)(n.A,{size:22}),action:"View Report",roles:["superadmin"]},{id:"business-overview",label:"Business Overview",description:"Detailed lifecycle, trial, and risk reports with drilldowns and exports.",path:"/app/admin/account-insights/account-reports",icon:(0,A.jsx)(n.A,{size:22}),action:"Open Overview",roles:["superadmin"]},{id:"webhook-monitor",label:"Webhook Reliability & Cleanup",description:"Monitor failed webhook callbacks and control auto-cleanup of webhook logs.",path:"/app/admin/webhooks/monitor",icon:(0,A.jsx)(l.A,{size:22}),action:"Open Webhook Tools",roles:["superadmin"]},{id:"user-permissions",label:"User Access & Permissions",description:"Override permissions for individual users in your account.",path:"/app/admin/user-permissions",icon:(0,A.jsx)(n.A,{className:"text-emerald-800",size:22}),action:"Manage Access",roles:["superadmin"]},{id:"flow-execution-explorer",label:"Flow Execution Explorer",description:"Audit and analyze flow executions across all businesses.",path:"/app/admin/audit/execution-explorer",icon:(0,A.jsx)(d,{className:"text-emerald-800",size:22}),action:"Open Explorer",roles:["superadmin"]},{id:"developer-notes",label:"Developer Notes",description:"Internal sanity checks, SQL snippets, and engineering decisions for faster debugging.",path:"/app/admin/developer-notes",icon:(0,A.jsx)(c.A,{size:22}),action:"Open Notes",roles:["superadmin"]},{id:"server-troubleshooting",label:"Server Troubleshooting",description:"Guide to diagnose and resolve server issues, high CPU/RAM usage, and more.",path:"/app/admin/server-troubleshooting",icon:(0,A.jsx)(c.A,{size:22}),action:"Open Guide",roles:["superadmin"]}];function j(){const e=(0,g.Zp)(),s=(0,g.zy)(),{role:a,hasAllAccess:i,can:t,isLoading:o,entLoading:n}=(0,f.h)(),d=String(a||"").toLowerCase(),c="1"===new URLSearchParams(s.search||"").get("flyout"),v=N.map((e=>e.id)),[j,S]=(0,x.useState)(JSON.parse(localStorage.getItem("admin-pinned")||"[]")),[k,E]=(0,x.useState)(JSON.parse(localStorage.getItem("admin-archived")||"[]")),[_,I]=(0,x.useState)((()=>{try{const e=localStorage.getItem("admin-order");if(!e)return v;const s=JSON.parse(e);return Array.isArray(s)?[...s,...v.filter((e=>!s.includes(e)))]:v}catch(e){return v}})()),[R,P]=(0,x.useState)(!1),D=_.map((e=>N.find((s=>s.id===e)))).filter(Boolean).filter((e=>(e=>i||!Array.isArray(e.roles)||e.roles.map((e=>String(e).toLowerCase())).includes(d))(e))).filter((e=>!!R||!k.includes(e.id))).map((e=>{const s=w[e.id]||[],a=i||Array.isArray(s)&&s.filter(Boolean).some((e=>t(e)));return(0,r.A)((0,r.A)({},e),{},{allowed:a,primaryCode:s&&s[0]||null})})),M=D.length>0,O=D.some((e=>e.allowed));return o||n?(0,A.jsx)("div",{className:"p-10 text-center text-lg text-gray-500",children:"Loading admin tools\u2026"}):c?(0,A.jsx)("div",{className:"p-6","data-test-id":"admin-workspace-root"}):(0,A.jsxs)("div",{className:"p-6","data-test-id":"admin-workspace-root",children:[(0,A.jsx)("style",{children:"\n        @keyframes drawRight { from { transform: scaleX(0) } to { transform: scaleX(1) } }\n        @keyframes drawDown  { from { transform: scaleY(0) } to { transform: scaleY(1) } }\n        @keyframes drawLeft  { from { transform: scaleX(0) } to { transform: scaleX(1) } }\n        @keyframes drawUp    { from { transform: scaleY(0) } to { transform: scaleY(1) } }\n\n        .tile:hover .topline    { animation: drawRight .9s ease forwards; }\n        .tile:hover .rightline  { animation: drawDown  .9s ease .18s forwards; }\n        .tile:hover .bottomline { animation: drawLeft .9s ease .36s forwards; }\n        .tile:hover .leftline   { animation: drawUp    .9s ease .54s forwards; }\n      "}),(0,A.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,A.jsx)("h2",{className:"text-2xl font-bold text-emerald-800",children:"\ud83d\udee1 Admin Workspace"}),(0,A.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,A.jsx)("input",{type:"checkbox",checked:R,onChange:()=>P(!R),className:"accent-emerald-600"}),"Show Archived Tools"]})]}),(0,A.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Manage plans, permissions, account health, webhooks, and ESU debugging across all businesses."}),!M&&(0,A.jsxs)("div",{className:"bg-red-100 text-red-700 p-4 border-l-4 border-red-500 rounded-md mb-6 shadow-sm flex items-start gap-3",children:[(0,A.jsx)(l.A,{size:22,className:"mt-1"}),(0,A.jsxs)("div",{children:[(0,A.jsx)("strong",{children:"Restricted:"})," You don\u2019t have access to any admin tools.",(0,A.jsx)("div",{className:"text-sm mt-1 text-gray-600",children:"This usually means your role is not superadmin / admin. Contact a superadmin if this is unexpected."})]})]}),M&&!O&&(0,A.jsxs)("div",{className:"bg-amber-50 text-amber-800 p-4 border-l-4 border-amber-500 rounded-md mb-6 shadow-sm flex items-start gap-3",children:[(0,A.jsx)(l.A,{size:22,className:"mt-1"}),(0,A.jsxs)("div",{children:[(0,A.jsx)("strong",{children:"Admin tools locked:"})," Your current permissions do not include these tools.",(0,A.jsx)("div",{className:"text-sm mt-1 text-gray-600",children:"Try opening a tile to request the right access, or contact your platform owner."})]})]}),M&&(0,A.jsx)(b.JY,{onDragEnd:e=>{if(!e.destination)return;const s=Array.from(_),[a]=s.splice(e.source.index,1);s.splice(e.destination.index,0,a),I(s),localStorage.setItem("admin-order",JSON.stringify(s))},children:(0,A.jsx)(b.gL,{droppableId:"admin-blocks",direction:"horizontal",children:s=>(0,A.jsxs)("div",(0,r.A)((0,r.A)({className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",ref:s.innerRef},s.droppableProps),{},{children:[D.map(((s,a)=>{const i="tile group relative overflow-hidden cursor-pointer bg-white rounded-md border shadow-sm hover:shadow-md transition transform hover:-translate-y-0.5 duration-200 focus:outline-none focus:ring-2 focus:ring-emerald-300",t=s.allowed?i:"".concat(i," ").concat("opacity-70 border-dashed cursor-not-allowed hover:-translate-y-0 hover:shadow-sm"),o=()=>{s.allowed?e(s.path):s.primaryCode&&(0,y.Y)({reason:"feature",code:s.primaryCode,source:"admin.workspace.tile"})},n=a=>{a.stopPropagation(),s.allowed?e(s.path):s.primaryCode&&(0,y.Y)({reason:"feature",code:s.primaryCode,source:"admin.workspace.action"})};return(0,A.jsx)(b.sx,{draggableId:s.id,index:a,children:e=>(0,A.jsxs)("div",(0,r.A)((0,r.A)({ref:e.innerRef},e.draggableProps),{},{role:"button",tabIndex:0,"aria-label":"".concat(s.label,": ").concat(s.action),onKeyDown:e=>{"Enter"===e.key&&o()},onClick:o,className:t,style:{userSelect:"none"},children:[!s.allowed&&(0,A.jsx)("span",{className:"pointer-events-none absolute top-3 right-3 inline-flex items-center gap-1 rounded-full border border-dashed border-amber-500 bg-amber-50 px-2 py-0.5 text-[11px] font-semibold text-amber-700",children:"\ud83d\udd12 Request Access"}),(0,A.jsx)("span",{"aria-hidden":!0,className:"topline pointer-events-none absolute left-0 -top-[2px] h-[2px] w-full origin-left rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(90deg, #A7F3D0, #34D399, #059669)",transform:"scaleX(0)"}}),(0,A.jsx)("span",{"aria-hidden":!0,className:"rightline pointer-events-none absolute right-0 -top-[2px] h-[calc(100%+4px)] w-[2px] origin-top rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(180deg, #A7F3D0, #34D399, #059669)",transform:"scaleY(0)"}}),(0,A.jsx)("span",{"aria-hidden":!0,className:"bottomline pointer-events-none absolute left-0 -bottom-[2px] h-[2px] w-full origin-right rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(270deg, #A7F3D0, #34D399, #059669)",transform:"scaleX(0)"}}),(0,A.jsx)("span",{"aria-hidden":!0,className:"leftline pointer-events-none absolute left-0 -top-[2px] h-[calc(100%+4px)] w-[2px] origin-bottom rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(0deg, #A7F3D0, #34D399, #059669)",transform:"scaleY(0)"}}),(0,A.jsxs)("div",{className:"flex items-start gap-4 p-5",children:[(0,A.jsx)("div",{className:"bg-emerald-50 rounded-md p-2 text-emerald-800",children:s.icon}),(0,A.jsxs)("div",{className:"flex-1",children:[(0,A.jsx)("h3",{className:"text-md font-semibold text-emerald-800 group-hover:text-emerald-900",children:s.label}),(0,A.jsx)("p",{className:"text-sm text-slate-600 workspace-tile-desc",children:s.description})]}),(0,A.jsx)("div",(0,r.A)((0,r.A)({},e.dragHandleProps),{},{title:"Drag to re-order",className:"ml-2 rounded p-1 text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",onClick:e=>e.stopPropagation(),children:(0,A.jsx)(p.A,{size:16})}))]}),(0,A.jsxs)("div",{className:"px-5 py-3 border-t border-gray-200 flex items-center justify-between bg-gray-50",children:[(0,A.jsxs)("button",{onClick:n,className:"text-sm text-gray-700 font-medium flex items-center gap-1 hover:text-gray-900",children:[s.allowed?s.action:"Request access",(0,A.jsx)(m.A,{size:18})]}),(0,A.jsxs)("div",{className:"flex items-center gap-3",children:[(0,A.jsx)("button",{onClick:e=>((e,s)=>{e.stopPropagation();const a=j.includes(s)?j.filter((e=>e!==s)):[...j,s];S(a),localStorage.setItem("admin-pinned",JSON.stringify(a))})(e,s.id),title:j.includes(s.id)?"Unpin":"Pin this",children:(0,A.jsx)(u.A,{size:18,className:j.includes(s.id)?"text-red-600":"text-gray-400 hover:text-red-500"})}),(0,A.jsx)("button",{onClick:e=>((e,s)=>{e.stopPropagation();const a=k.includes(s)?k.filter((e=>e!==s)):[...k,s];E(a),localStorage.setItem("admin-archived",JSON.stringify(a))})(e,s.id),title:"Archive this",children:(0,A.jsx)(h.A,{size:18,className:k.includes(s.id)?"text-indigo-600":"text-gray-400 hover:text-indigo-500"})})]})]})]}))},s.id)})),s.placeholder]}))})})]})}}}]);
//# sourceMappingURL=492.7b4a9e45.chunk.js.map