/*! For license information please see 774.01e291a2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkxbytechat_ui=self.webpackChunkxbytechat_ui||[]).push([[774],{70774:(e,t,a)=>{a.r(t),a.d(t,{default:()=>A});var r=a(89379);const s=(0,a(77784).A)("circle-user-round",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var i=a(22925),n=a(66797),o=a(3572),l=a(81685),c=a(76996),d=a(37719),m=a(75686),p=a(81007),h=a(63961),g=a(5244),x=a(73216),u=a(65043),f=a(8927),b=a(65086),y=a(63610),v=a(74961),j=a(70579);const w={contacts:[v.FK.CRM_CONTACT_VIEW],tags:[v.FK.CRM_TAGS_VIEW],reminders:[v.FK.CRM_REMINDERS_VIEW],timeline:[v.FK.CRM_TIMELINE_VIEW],notes:[v.FK.CRM_NOTES_VIEW],attributes:v.FK.CRM_ATTRIBUTE_VIEW},N=[{id:"contacts",label:"Contacts",description:"Central place to manage leads, customers, and their details.",path:"/app/crm/contacts",icon:(0,j.jsx)(s,{size:22}),action:"Open Contacts"},{id:"tags",label:"Tags",description:"Organize and filter contacts using color-coded tags.",path:"/app/crm/tags",icon:(0,j.jsx)(i.A,{size:22}),action:"Manage Tags"},{id:"attributes",label:"Attribute",description:"Create and manage custom attributes for contacts (dynamic fields).",path:"/app/crm/attributes",icon:(0,j.jsx)(n.A,{size:22}),action:"Open Attributes"},{id:"reminders",label:"Reminders",description:"Schedule follow-ups and set alerts to never miss a lead.",path:"/app/crm/reminders",icon:(0,j.jsx)(o.A,{size:22}),action:"View Reminders"},{id:"timeline",label:"Timeline",description:"Track every interaction and touchpoint with each contact.",path:"/app/crm/timeline",icon:(0,j.jsx)(l.A,{size:22}),action:"View Timeline"},{id:"notes",label:"Notes",description:"Capture notes and key details for each contact.",path:"/app/crm/notes",icon:(0,j.jsx)(c.A,{size:22}),action:"Open Notes"}];function A(){const e=(0,x.Zp)(),t=(0,x.zy)(),{isLoading:a,entLoading:s,hasAllAccess:i,can:n}=(0,b.h)(),o="1"===new URLSearchParams(t.search||"").get("flyout"),[l,c]=(0,u.useState)(JSON.parse(localStorage.getItem("crm-pinned")||"[]")),[v,A]=(0,u.useState)(JSON.parse(localStorage.getItem("crm-archived")||"[]")),k=(0,u.useMemo)((()=>N.map((e=>e.id))),[]),C=JSON.parse(localStorage.getItem("crm-order")||"null")||[],S=(0,u.useMemo)((()=>{if(!Array.isArray(C)||0===C.length)return k;const e=C.filter((e=>k.includes(e))),t=k.filter((t=>!e.includes(t)));return[...e,...t]}),[k]),[R,I]=(0,u.useState)(S),[M,z]=(0,u.useState)(!1),D=R.map((e=>N.find((t=>t.id===e)))).filter(Boolean).filter((e=>!!M||!v.includes(e.id))).map((e=>{const t=w[e.id]||[],a=Array.isArray(t)?t:[t].filter(Boolean),s=i||a.length>0&&"function"===typeof n&&a.some((e=>n(e)));return(0,r.A)((0,r.A)({},e),{},{allowed:s,primaryCode:a[0]||null})})),E=D.length>0,T=D.some((e=>e.allowed));return a||s?(0,j.jsx)("div",{className:"p-10 text-center text-lg text-gray-500",children:"Loading CRM features\u2026"}):o?(0,j.jsx)("div",{className:"p-6 bg-[#f5f6f7] min-h-[calc(100vh-80px)]","data-test-id":"crm-root"}):(0,j.jsxs)("div",{className:"p-6 bg-[#f5f6f7] min-h-[calc(100vh-80px)]","data-test-id":"crm-root",children:[(0,j.jsx)("style",{children:"\n        @keyframes drawRight { from { transform: scaleX(0) } to { transform: scaleX(1) } }\n        @keyframes drawDown  { from { transform: scaleY(0) } to { transform: scaleY(1) } }\n        @keyframes drawLeft  { from { transform: scaleX(0) } to { transform: scaleX(1) } }\n        @keyframes drawUp    { from { transform: scaleY(0) } to { transform: scaleY(1) } }\n\n        .tile:hover .topline    { animation: drawRight .9s ease forwards; }\n        .tile:hover .rightline  { animation: drawDown  .9s ease .18s forwards; }\n        .tile:hover .bottomline { animation: drawLeft  .9s ease .36s forwards; }\n        .tile:hover .leftline   { animation: drawUp    .9s ease .54s forwards; }\n      "}),(0,j.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,j.jsx)("h2",{className:"text-2xl font-bold text-emerald-800",children:"\ud83d\udcc7 CRM Workspace"}),(0,j.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,j.jsx)("input",{type:"checkbox",checked:M,onChange:()=>z(!M),className:"accent-emerald-600"}),"Show Archived"]})]}),(0,j.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Manage contacts, tags, reminders, and interaction timelines in one place."}),E&&!T&&(0,j.jsxs)("div",{className:"bg-amber-50 text-amber-800 p-4 border-l-4 border-amber-500 rounded-md mb-6 shadow-sm flex items-start gap-3",children:[(0,j.jsx)(d.A,{size:22,className:"mt-1"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{children:"Locked CRM tools:"})," Your current plan doesn't include these CRM features.",(0,j.jsx)("div",{className:"text-sm mt-1 text-gray-600",children:"Try opening a tile to see upgrade options, or contact your administrator."})]})]}),E&&(0,j.jsx)(f.JY,{onDragEnd:e=>{if(!e.destination)return;const t=Array.from(R),[a]=t.splice(e.source.index,1);t.splice(e.destination.index,0,a),I(t),localStorage.setItem("crm-order",JSON.stringify(t))},children:(0,j.jsx)(f.gL,{droppableId:"crm-blocks",direction:"horizontal",children:t=>(0,j.jsxs)("div",(0,r.A)((0,r.A)({className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",ref:t.innerRef},t.droppableProps),{},{children:[D.map(((t,a)=>{const s="tile group relative overflow-hidden rounded-md border bg-white shadow-sm transition duration-200 hover:-translate-y-0.5 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-emerald-300 cursor-pointer",i=t.allowed?s:"".concat(s," ").concat("opacity-70 border-dashed cursor-not-allowed hover:-translate-y-0 hover:shadow-sm"),n=()=>{t.allowed?e(t.path):t.primaryCode&&(0,y.Y)({reason:"feature",code:t.primaryCode,source:"crm.workspace.tile"})},o=a=>{a.stopPropagation(),t.allowed?e(t.path):t.primaryCode&&(0,y.Y)({reason:"feature",code:t.primaryCode,source:"crm.workspace.action"})};return(0,j.jsx)(f.sx,{draggableId:t.id,index:a,children:e=>(0,j.jsxs)("div",(0,r.A)((0,r.A)({ref:e.innerRef},e.draggableProps),{},{role:"button",tabIndex:0,"aria-label":"".concat(t.label,": ").concat(t.action),onKeyDown:e=>{"Enter"===e.key&&n()},onClick:n,className:i,style:{userSelect:"none"},children:[!t.allowed&&(0,j.jsx)("span",{className:"pointer-events-none absolute top-3 right-3 inline-flex items-center gap-1 rounded-full border border-dashed border-amber-500 bg-amber-50 px-2 py-0.5 text-[11px] font-semibold text-amber-700",children:"\ud83d\udd12 Upgrade"}),(0,j.jsx)("span",{"aria-hidden":!0,className:"topline pointer-events-none absolute left-0 -top-[2px] h-[2px] w-full origin-left rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(90deg, #A7F3D0, #34D399, #059669)",transform:"scaleX(0)"}}),(0,j.jsx)("span",{"aria-hidden":!0,className:"rightline pointer-events-none absolute right-0 -top-[2px] h-[calc(100%+4px)] w-[2px] origin-top rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(180deg, #A7F3D0, #34D399, #059669)",transform:"scaleY(0)"}}),(0,j.jsx)("span",{"aria-hidden":!0,className:"bottomline pointer-events-none absolute left-0 -bottom-[2px] h-[2px] w-full origin-right rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(270deg, #A7F3D0, #34D399, #059669)",transform:"scaleX(0)"}}),(0,j.jsx)("span",{"aria-hidden":!0,className:"leftline pointer-events-none absolute left-0 -top-[2px] h-[calc(100%+4px)] w-[2px] origin-bottom rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(0deg, #A7F3D0, #34D399, #059669)",transform:"scaleY(0)"}}),(0,j.jsxs)("div",{className:"flex items-start gap-4 p-5",children:[(0,j.jsx)("div",{className:"bg-emerald-50 rounded-md p-2 text-emerald-800",children:t.icon}),(0,j.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,j.jsx)("h3",{className:"text-md font-semibold text-emerald-800 truncate group-hover:text-emerald-900",children:t.label}),(0,j.jsx)("p",{className:"text-sm text-slate-600 workspace-tile-desc",children:t.description})]}),(0,j.jsx)("div",(0,r.A)((0,r.A)({},e.dragHandleProps),{},{title:"Drag to re-order",className:"ml-2 rounded p-1 text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",onClick:e=>e.stopPropagation(),children:(0,j.jsx)(m.A,{size:16})}))]}),(0,j.jsxs)("div",{className:"px-5 py-3 border-t border-gray-200 flex items-center justify-between bg-gray-50",children:[(0,j.jsxs)("button",{onClick:o,className:"text-sm text-gray-700 font-medium flex items-center gap-1 hover:text-gray-900",children:[t.allowed?t.action:"Upgrade to unlock",(0,j.jsx)(p.A,{size:18})]}),(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("button",{onClick:e=>((e,t)=>{e.stopPropagation();const a=l.includes(t)?l.filter((e=>e!==t)):[...l,t];c(a),localStorage.setItem("crm-pinned",JSON.stringify(a))})(e,t.id),title:l.includes(t.id)?"Unpin":"Pin",children:(0,j.jsx)(h.A,{size:18,className:l.includes(t.id)?"text-red-600":"text-gray-400 hover:text-red-500"})}),(0,j.jsx)("button",{onClick:e=>((e,t)=>{e.stopPropagation();const a=v.includes(t)?v.filter((e=>e!==t)):[...v,t];A(a),localStorage.setItem("crm-archived",JSON.stringify(a))})(e,t.id),title:"Archive this",children:(0,j.jsx)(g.A,{size:18,className:v.includes(t.id)?"text-indigo-600":"text-gray-400 hover:text-indigo-500"})})]})]})]}))},t.id)})),t.placeholder]}))})}),!E&&(0,j.jsxs)("div",{className:"bg-red-100 text-red-700 p-4 border-l-4 border-red-500 rounded-md mt-4 shadow-sm flex items-start gap-3",children:[(0,j.jsx)(d.A,{size:22,className:"mt-1"}),(0,j.jsxs)("div",{children:[(0,j.jsx)("strong",{children:"No CRM tiles:"})," All CRM tools are archived or hidden.",(0,j.jsx)("div",{className:"text-sm mt-1 text-gray-600",children:"Un-archive some tiles to see them here."})]})]})]})}}}]);
//# sourceMappingURL=774.01e291a2.chunk.js.map