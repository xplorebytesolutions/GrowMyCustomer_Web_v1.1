/*! For license information please see 473.b6461a2e.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkxbytechat_ui=self.webpackChunkxbytechat_ui||[]).push([[473],{35327:(e,s,l)=>{l.d(s,{A:()=>t});const t=(0,l(77784).A)("mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},97473:(e,s,l)=>{l.r(s),l.d(s,{default:()=>b});var t=l(65043),a=l(73216),i=l(35870),d=l(57488),n=l(65469),o=l(91286),c=l(35327),r=l(75088),x=l(14459),m=l(29350),u=l(40614),v=l(19233),h=l(76996),p=l(34537),j=l(70579);function N(e){if(!e)return"-";try{return new Date(e).toLocaleString()}catch(s){return String(e)}}function b(){var e,s,l,b,f,g,y,w,A,S;const{contactId:C}=(0,a.g)(),k=(0,a.Zp)(),[R,M]=(0,t.useState)(null),[I,T]=(0,t.useState)(!1),[F,L]=(0,t.useState)(null),[D,E]=(0,t.useState)([]),[U,O]=(0,t.useState)([]);(0,t.useEffect)((()=>{if(!C)return;let e=!1;return(async()=>{try{var s,l;T(!0),L(null);const t=await i.default.get("/crm/contact-summary/".concat(C)),a=null!==(s=null===(l=t.data)||void 0===l?void 0:l.data)&&void 0!==s?s:t.data;e||M(a||null)}catch(c){var t,a,n,o;if(console.error("\u274c Failed to load contact 360 summary:",c),!e)L((null===c||void 0===c||null===(t=c.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to load contact 360 summary."),d.oR.error((null===c||void 0===c||null===(n=c.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.message)||"Failed to load contact 360 summary.")}finally{e||T(!1)}})(),()=>{e=!0}}),[C]);const B=(null===R||void 0===R?void 0:R.name)||(null===R||void 0===R?void 0:R.fullName)||(null===R||void 0===R?void 0:R.contactName)||(null===R||void 0===R||null===(e=R.basic)||void 0===e?void 0:e.name)||"Unknown contact",_=(null===R||void 0===R?void 0:R.phone)||(null===R||void 0===R?void 0:R.phoneNumber)||(null===R||void 0===R?void 0:R.contactPhone)||(null===R||void 0===R||null===(s=R.basic)||void 0===s?void 0:s.phone)||"-",H=(null===R||void 0===R?void 0:R.email)||(null===R||void 0===R?void 0:R.contactEmail)||(null===R||void 0===R||null===(l=R.basic)||void 0===l?void 0:l.email)||null,P=(null===R||void 0===R?void 0:R.company)||(null===R||void 0===R?void 0:R.companyName)||(null===R||void 0===R||null===(b=R.basic)||void 0===b?void 0:b.company)||null,W=(null===R||void 0===R?void 0:R.leadSource)||(null===R||void 0===R?void 0:R.source)||(null===R||void 0===R||null===(f=R.basic)||void 0===f?void 0:f.leadSource)||null,Y=(0,t.useMemo)((()=>{var e,s,l,t,a;const i=null!==(e=null!==(s=null!==(l=null!==(t=null===R||void 0===R?void 0:R.tags)&&void 0!==t?t:null===R||void 0===R?void 0:R.contactTags)&&void 0!==l?l:null===R||void 0===R?void 0:R.contactTagsDto)&&void 0!==s?s:null===R||void 0===R||null===(a=R.basic)||void 0===a?void 0:a.tags)&&void 0!==e?e:[];return Array.isArray(i)?i:[]}),[R]);(0,t.useEffect)((()=>{E(Y)}),[Y]);const Z=null!==(g=null===R||void 0===R?void 0:R.recentNotes)&&void 0!==g?g:[],q=null!==(y=null===R||void 0===R?void 0:R.nextReminder)&&void 0!==y?y:null,z=null!==(w=null===R||void 0===R?void 0:R.recentTimeline)&&void 0!==w?w:[],G=(0,t.useMemo)((()=>{var e,s,l,t,a,i,d,n,o;return{firstSeen:(null===R||void 0===R?void 0:R.firstSeenAt)||(null===R||void 0===R||null===(e=R.basic)||void 0===e?void 0:e.firstSeenAt)||null,lastInbound:(null===R||void 0===R?void 0:R.lastInboundAt)||(null===R||void 0===R||null===(s=R.basic)||void 0===s?void 0:s.lastInboundAt)||null,lastOutbound:(null===R||void 0===R?void 0:R.lastOutboundAt)||(null===R||void 0===R||null===(l=R.basic)||void 0===l?void 0:l.lastOutboundAt)||null,totalMessages:null!==(t=null!==(a=null===R||void 0===R?void 0:R.totalMessages)&&void 0!==a?a:null===R||void 0===R||null===(i=R.metrics)||void 0===i?void 0:i.totalMessages)&&void 0!==t?t:void 0,totalCampaigns:null!==(d=null!==(n=null===R||void 0===R?void 0:R.totalCampaigns)&&void 0!==n?n:null===R||void 0===R||null===(o=R.metrics)||void 0===o?void 0:o.totalCampaigns)&&void 0!==d?d:void 0}}),[R]);return(0,j.jsxs)("div",{className:"h-full flex flex-col bg-[#f5f6f7]",children:[(0,j.jsxs)("div",{className:"h-[60px] border-b border-slate-200 bg-white flex items-center justify-between px-4",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsxs)("button",{onClick:()=>k(-1),className:"inline-flex items-center gap-1 text-xs text-slate-500 hover:text-slate-800",children:[(0,j.jsx)(n.A,{className:"w-4 h-4"}),"Back"]}),(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("div",{className:"w-9 h-9 rounded-full bg-emerald-100 flex items-center justify-center text-xs font-semibold text-emerald-700",children:null!==(A=null===(S=String(B).trim()[0])||void 0===S?void 0:S.toUpperCase())&&void 0!==A?A:"?"}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"text-sm font-semibold text-slate-900",children:B}),P&&(0,j.jsxs)("span",{className:"text-[11px] text-slate-500",children:["\u2022 ",P]})]}),(0,j.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-[11px] text-slate-500 mt-0.5",children:[(0,j.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,j.jsx)(o.A,{className:"w-3 h-3"}),_]}),H&&(0,j.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,j.jsx)(c.A,{className:"w-3 h-3"}),H]}),W&&(0,j.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,j.jsx)(r.A,{className:"w-3 h-3"}),"Lead source: ",W]})]})]})]})]}),(0,j.jsx)("div",{className:"text-[11px] text-slate-500",children:"Contact 360 \u2022 CRM Workspace"})]}),(0,j.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[I&&(0,j.jsx)("div",{className:"h-full flex items-center justify-center text-xs text-slate-400",children:"Loading contact 360\u2026"}),!I&&F&&(0,j.jsx)("div",{className:"max-w-xl mx-auto bg-rose-50 border border-rose-100 text-rose-700 text-xs rounded-lg p-3",children:F}),!I&&!F&&(0,j.jsxs)("div",{className:"max-w-6xl mx-auto grid grid-cols-3 gap-4",children:[(0,j.jsxs)("div",{className:"col-span-1 space-y-3",children:[(0,j.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-3 shadow-sm",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,j.jsx)(x.A,{className:"w-4 h-4 text-slate-500"}),(0,j.jsx)("span",{className:"text-xs font-semibold text-slate-800",children:"Interaction stats"})]}),(0,j.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-[11px]",children:[(0,j.jsxs)("div",{className:"bg-slate-50 rounded-md p-2",children:[(0,j.jsx)("div",{className:"text-slate-400",children:"First seen"}),(0,j.jsx)("div",{className:"font-medium",children:N(G.firstSeen)})]}),(0,j.jsxs)("div",{className:"bg-slate-50 rounded-md p-2",children:[(0,j.jsx)("div",{className:"text-slate-400",children:"Last inbound"}),(0,j.jsx)("div",{className:"font-medium",children:N(G.lastInbound)})]}),(0,j.jsxs)("div",{className:"bg-slate-50 rounded-md p-2",children:[(0,j.jsx)("div",{className:"text-slate-400",children:"Last outbound"}),(0,j.jsx)("div",{className:"font-medium",children:N(G.lastOutbound)})]}),"number"===typeof G.totalMessages&&(0,j.jsxs)("div",{className:"bg-slate-50 rounded-md p-2",children:[(0,j.jsx)("div",{className:"text-slate-400",children:"Total messages"}),(0,j.jsx)("div",{className:"font-medium",children:G.totalMessages})]})]})]}),(0,j.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-3 shadow-sm",children:[(0,j.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(m.A,{className:"w-4 h-4 text-slate-500"}),(0,j.jsx)("span",{className:"text-xs font-semibold text-slate-800",children:"Tags"})]})}),(0,j.jsx)("div",{className:"flex flex-wrap gap-1.5",children:D&&D.length>0?D.map(((e,s)=>{const l=e.id||e.tagId,t=U.includes(l);return(0,j.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[10px] rounded-full font-medium border border-slate-200",style:{backgroundColor:e.colorHex||"#EEF2FF"},children:[e.tagName||e.name||"Tag",l&&(0,j.jsx)("button",{type:"button",onClick:()=>(async e=>{if(e&&C){O((s=>s.includes(e)?s:[...s,e]));try{await i.default.delete("/contacts/".concat(C,"/tags/").concat(e)),E((s=>s.filter((s=>(s.id||s.tagId)!==e)))),d.oR.success("Tag removed.")}catch(a){var s,l,t;404===(null===a||void 0===a||null===(s=a.response)||void 0===s?void 0:s.status)?(E((s=>s.filter((s=>(s.id||s.tagId)!==e)))),d.oR.info("Already removed.")):d.oR.error((null===a||void 0===a||null===(l=a.response)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.message)||"Failed to remove tag.")}finally{O((s=>s.filter((s=>s!==e))))}}})(l),disabled:t,className:"ml-1 text-slate-500 hover:text-slate-700 disabled:opacity-50","aria-label":"Remove tag",children:(0,j.jsx)(u.A,{className:"w-3 h-3"})})]},e.id||e.tagId||s)})):(0,j.jsx)("span",{className:"text-[11px] text-slate-400",children:"No tags yet. Use CRM > Tags to segment this contact."})})]}),(0,j.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-3 shadow-sm",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,j.jsx)(v.A,{className:"w-4 h-4 text-slate-500"}),(0,j.jsx)("span",{className:"text-xs font-semibold text-slate-800",children:"Next reminder"})]}),q?(0,j.jsxs)("div",{className:"bg-amber-50 border border-amber-100 rounded-md p-2 text-[11px] text-amber-900",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,j.jsx)("span",{className:"font-semibold",children:q.title}),(0,j.jsx)("span",{className:"text-[10px]",children:N(q.dueAt)})]}),q.description&&(0,j.jsx)("div",{className:"mt-0.5",children:q.description}),q.status&&(0,j.jsxs)("div",{className:"mt-0.5 text-[10px]",children:["Status: ",q.status]})]}):(0,j.jsx)("span",{className:"text-[11px] text-slate-400",children:"No upcoming reminder. Use CRM > Reminders to schedule a follow-up."})]})]}),(0,j.jsxs)("div",{className:"col-span-2 space-y-3",children:[(0,j.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-3 shadow-sm",children:[(0,j.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(h.A,{className:"w-4 h-4 text-slate-500"}),(0,j.jsx)("span",{className:"text-xs font-semibold text-slate-800",children:"Recent notes"})]})}),Z&&Z.length>0?(0,j.jsx)("div",{className:"space-y-1.5",children:Z.map((e=>(0,j.jsxs)("div",{className:"bg-slate-50 border border-slate-100 rounded-md p-2 text-[11px]",children:[(0,j.jsx)("div",{className:"text-slate-800",children:e.content||e.text||"(no content)"}),(0,j.jsxs)("div",{className:"mt-0.5 text-[10px] text-slate-400 flex justify-between",children:[(0,j.jsx)("span",{children:e.createdByName||e.createdBy||"Agent"}),(0,j.jsx)("span",{children:e.createdAt?new Date(e.createdAt).toLocaleString():""})]})]},e.id)))}):(0,j.jsx)("div",{className:"text-[11px] text-slate-400",children:"No notes yet. Use CRM > Notes to document this lead\u2019s context."})]}),(0,j.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-3 shadow-sm",children:[(0,j.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(p.A,{className:"w-4 h-4 text-slate-500"}),(0,j.jsx)("span",{className:"text-xs font-semibold text-slate-800",children:"Recent activity"})]})}),z&&z.length>0?(0,j.jsx)("div",{className:"space-y-1.5 text-[11px]",children:z.map((e=>(0,j.jsxs)("div",{className:"flex gap-2 items-start",children:[(0,j.jsx)("div",{className:"mt-1 w-1 h-1 rounded-full bg-slate-400"}),(0,j.jsxs)("div",{className:"flex-1",children:[(0,j.jsx)("div",{className:"text-slate-800",children:e.title||e.shortDescription||e.description||"Activity"}),(0,j.jsxs)("div",{className:"mt-0.5 text-[10px] text-slate-400 flex justify-between",children:[(0,j.jsx)("span",{children:e.source||e.category||e.eventType||""}),(0,j.jsx)("span",{children:e.createdAt?new Date(e.createdAt).toLocaleString():""})]})]})]},e.id)))}):(0,j.jsx)("div",{className:"text-[11px] text-slate-400",children:"No timeline entries yet. Your future CTA flows, campaigns and reminders will populate this stream."})]})]})]})]})]})}}}]);
//# sourceMappingURL=473.b6461a2e.chunk.js.map