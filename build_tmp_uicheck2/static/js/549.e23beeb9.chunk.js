/*! For license information please see 549.e23beeb9.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkxbytechat_ui=self.webpackChunkxbytechat_ui||[]).push([[549],{54549:(e,a,t)=>{t.r(a),t.d(a,{default:()=>U});var l=t(89379),s=t(65043),r=t(35870),n=t(57488),d=t(70579);function i(e){var a;let{businessName:t="XploreByte",templateBody:l="",parameters:s=[],imageUrl:r="",buttonParams:n=[],width:i=320}=e;const o=(l||"").replace(/{{(\d+)}}/g,((e,a)=>{var t;const l=null!==(t=s[Number(a)-1])&&void 0!==t?t:"";return""!==l?l:"{{".concat(a,"}}")}));return(0,d.jsx)("div",{className:"flex justify-center",children:(0,d.jsxs)("div",{className:"relative bg-gray-900 rounded-[2.5rem] shadow-2xl p-2",style:{width:"".concat(i,"px"),height:"600px"},children:[(0,d.jsx)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-20 h-6 bg-gray-900 rounded-b-2xl z-10"}),(0,d.jsxs)("div",{className:"w-full h-full bg-white rounded-[2rem] overflow-hidden relative",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between px-6 pt-2 pb-1 text-black text-sm font-semibold",children:[(0,d.jsx)("span",{children:"9:41"}),(0,d.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,d.jsxs)("div",{className:"flex space-x-1",children:[(0,d.jsx)("div",{className:"w-1 h-1 bg-black rounded-full"}),(0,d.jsx)("div",{className:"w-1 h-1 bg-black rounded-full"}),(0,d.jsx)("div",{className:"w-1 h-1 bg-black rounded-full"}),(0,d.jsx)("div",{className:"w-1 h-1 bg-black rounded-full"})]}),(0,d.jsx)("div",{className:"w-6 h-3 border border-black rounded-sm relative",children:(0,d.jsx)("div",{className:"w-4 h-2 bg-green-500 rounded-sm absolute top-0.5 left-0.5"})})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 bg-[#075e54] text-white",children:[(0,d.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center font-bold text-white",children:(null===t||void 0===t||null===(a=t.charAt(0))||void 0===a?void 0:a.toUpperCase())||"Y"}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("div",{className:"font-semibold text-base",children:"XploreByte"}),(0,d.jsx)("div",{className:"text-xs text-green-200",children:"online"})]}),(0,d.jsxs)("div",{className:"flex space-x-3",children:[(0,d.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),(0,d.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})})]})]}),(0,d.jsx)("div",{className:"p-4 overflow-y-auto relative bg-[#e5ddd5]",style:{height:"460px",backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d1f2eb' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3Cg fill='%23a8dadc' fill-opacity='0.1'%3E%3Cpath d='M30 30c0-11.046-8.954-20-20-20s-20 8.954-20 20 8.954 20 20 20 20-8.954 20-20zm-20-18c9.941 0 18 8.059 18 18s-8.059 18-18 18S-8 39.941-8 30s8.059-18 18-18z'/%3E%3C/g%3E%3Cg fill='%23e5ddd5' fill-opacity='0.3'%3E%3Cpath d='M50 50c0-5.523-4.477-10-10-10s-10 4.477-10 10 4.477 10 10 10 10-4.477 10-10zm-10-8c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")",backgroundRepeat:"repeat"},children:(0,d.jsx)("div",{className:"flex justify-start mb-4",children:(0,d.jsxs)("div",{className:"relative max-w-[85%]",children:[(0,d.jsxs)("div",{className:"bg-white rounded-2xl rounded-tl-sm p-3 shadow-sm",children:[r?(0,d.jsx)("div",{className:"mb-3 -m-3 -mt-3",children:r.startsWith("handle:")?(0,d.jsxs)("div",{className:"w-full h-40 bg-slate-100 flex flex-col items-center justify-center gap-2 text-slate-400 rounded-t-2xl",children:[(0,d.jsx)("svg",{className:"w-8 h-8 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,d.jsx)("span",{className:"text-[10px] font-medium uppercase tracking-tight",children:"Media Uploaded (Meta Handle)"})]}):(0,d.jsx)("img",{src:r,alt:"Header",className:"w-full h-40 object-cover rounded-t-2xl",onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='\n                              <div class="w-full h-40 bg-slate-100 flex flex-col items-center justify-center gap-2 text-slate-400">\n                                <span class="text-[10px] font-medium uppercase tracking-tight">Media Preview Unavailable</span>\n                              </div>\n                            '}})}):(0,d.jsx)("div",{className:"mb-3 -m-3 -mt-3 w-full h-40 bg-slate-50 flex items-center justify-center border-b border-gray-100 rounded-t-2xl",children:(0,d.jsx)("span",{className:"text-[10px] text-gray-400 italic",children:"No media selected"})}),(0,d.jsx)("div",{className:"text-gray-800 text-sm leading-relaxed whitespace-pre-wrap",children:o}),Array.isArray(n)&&n.length>0&&(0,d.jsx)("div",{className:"mt-3 -mx-3 -mb-3",children:n.map(((e,a)=>(0,d.jsxs)("div",{className:"flex items-center justify-center gap-3 px-4 py-3 text-blue-500 hover:bg-gray-50 cursor-pointer ".concat(a>0?"border-t border-gray-100":""),children:[(0,d.jsx)("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:"url"===(null===e||void 0===e?void 0:e.subType)||"url"===(null===e||void 0===e?void 0:e.type)?(0,d.jsx)("path",{d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"}):"copy_code"===(null===e||void 0===e?void 0:e.subType)||"copy_code"===(null===e||void 0===e?void 0:e.type)?(0,d.jsx)("path",{d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"}):(0,d.jsx)("path",{d:"M10 17l5-5-5-5v10z"})}),(0,d.jsx)("span",{className:"text-sm font-medium truncate",children:(null===e||void 0===e?void 0:e.text)||"Button"})]},a)))}),(0,d.jsx)("div",{className:"text-right mt-2",children:(0,d.jsx)("span",{className:"text-xs text-gray-500",children:"9:41 AM"})})]}),(0,d.jsx)("div",{className:"absolute -left-2 top-0 w-0 h-0 border-t-[8px] border-t-transparent border-r-[12px] border-r-white border-b-[8px] border-b-transparent"})]})})})]})]})})}var o=t(73216),c=t(65086),u=t(54373),m=t(4717),x=t(50516),p=t(40614),h=t(57856),v=t(20073),g=t(35746),b=t(28646);const f=(0,t(77784).A)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);var j=t(22024),y=t(50797),N=t(76833),w=t(77819),C=t(21363);function S(e){let{mediaType:a="IMAGE",handle:t,onUploaded:l,onPreview:r}=e;const[n,i]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null);return(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsxs)("label",{className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-indigo-200 bg-indigo-50 text-indigo-700 cursor-pointer hover:bg-indigo-100 transition-all shadow-sm active:scale-[0.98]",children:[n?(0,d.jsx)(j.A,{className:"animate-spin",size:16}):(0,d.jsx)(y.A,{size:16}),(0,d.jsx)("span",{className:"text-sm font-semibold",children:n?"Uploading...":"Upload File"}),(0,d.jsx)("input",{type:"file",className:"hidden",accept:"IMAGE"===a?"image/*":"VIDEO"===a?"video/*":".pdf,application/pdf",onChange:e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];e.target.value="",(async e=>{if(e){if(r){const a=URL.createObjectURL(e);r(a)}c(null),i(!0);try{const t=await(0,C.H)({mediaType:a,file:e});null!==t&&void 0!==t&&t.handle?(null===l||void 0===l||l("handle:".concat(t.handle)),c({type:"success",message:"Media uploaded successfully."})):c({type:"error",message:"Upload succeeded but no handle returned."})}catch(n){var t,s;console.error(n),c({type:"error",message:(null===n||void 0===n||null===(t=n.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Upload failed. Please try again."})}finally{i(!1)}}})(s)},disabled:n})]}),(0,d.jsx)("div",{className:"text-xs text-gray-500",children:null!==t&&void 0!==t&&t.startsWith("handle:")?(0,d.jsxs)("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-emerald-50 text-emerald-700 rounded-md border border-emerald-100 animate-in fade-in duration-300",children:[(0,d.jsx)(N.A,{size:12}),(0,d.jsx)("span",{className:"font-bold uppercase tracking-wider text-[10px]",children:"Ready to Send"})]}):(0,d.jsx)("span",{className:"italic text-[10px] text-slate-400",children:"Direct upload for better reliability"})})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1.5 text-slate-400",children:[(0,d.jsx)(h.A,{size:12}),(0,d.jsx)("span",{className:"text-[10px] font-medium uppercase tracking-tight",children:"IMAGE"===a?"JPG, PNG, WEBP \u2022 Max 10MB":"VIDEO"===a?"MP4, 3GP \u2022 Max 16MB":"PDF \u2022 Max 16MB"})]}),o&&(0,d.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-lg border text-[11px] font-medium animate-in slide-in-from-top-1 duration-200 ".concat("success"===o.type?"bg-emerald-50 border-emerald-100 text-emerald-700":"bg-red-50 border-red-100 text-red-600"),children:["success"===o.type?(0,d.jsx)(N.A,{size:14}):(0,d.jsx)(w.A,{size:14}),(0,d.jsx)("span",{children:o.message})]})]})]})}const A=e=>"templates/sync/".concat(e),k=20,I=200,M=e=>!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e),P=Object.freeze({None:"none",Text:"text",Image:"image",Video:"video",Document:"document"}),T=e=>e===P.Image||e===P.Video||e===P.Document;function U(){const{businessId:e}=(0,c.h)(),[a,t]=(0,s.useState)([]),[j,y]=(0,s.useState)(!1),[N,w]=(0,s.useState)(!1),[C,U]=(0,s.useState)(""),[R,V]=(0,s.useState)("created_desc"),[B,E]=(0,s.useState)("all"),[z,H]=(0,s.useState)(1),[L,D]=(0,s.useState)(0),[_,F]=(0,s.useState)(0),[K,O]=(0,s.useState)(!1),[W,q]=(0,s.useState)(null),G=(0,s.useRef)(null),J=(0,s.useRef)(0),Z=(0,s.useRef)(!1),[X,Y]=(0,s.useState)(null),[$,Q]=(0,s.useState)([]),[ee,ae]=(0,s.useState)([]),[te,le]=(0,s.useState)(""),[se,re]=(0,s.useState)(""),[ne,de]=(0,s.useState)(""),[ie,oe]=(0,s.useState)(!1),[ce,ue]=(0,s.useState)(""),[me,xe]=(0,s.useState)(!1),[pe,he]=(0,s.useState)(!1),[ve,ge]=(0,s.useState)([]),[be,fe]=(0,s.useState)(!1),[je,ye]=(0,s.useState)(""),[Ne,we]=(0,s.useState)([]),[Ce,Se]=(0,s.useState)(""),[Ae,ke]=(0,s.useState)(!0),[Ie,Me]=(0,s.useState)("now"),Pe=(0,s.useMemo)((()=>e||localStorage.getItem("businessId")||null),[e]),Te=M(Pe),Ue=(0,s.useMemo)((()=>Te?"campaignBuilder.selectedTemplate.".concat(Pe):null),[Pe,Te]),Re=localStorage.getItem("userId"),Ve=(0,o.Zp)(),Be=async e=>{if(de(""),null!==e&&void 0!==e&&e.trim()&&Te)try{oe(!0);const{data:a}=await r.default.get("campaign/check-name",{params:{name:e}});!1===(null===a||void 0===a?void 0:a.available)?de("Name already exists."):de("")}catch(a){de("")}finally{oe(!1)}},Ee=(0,s.useMemo)((()=>{switch(R){case"name_asc":return{sortKey:"name",sortDir:"asc"};case"name_desc":return{sortKey:"name",sortDir:"desc"};case"created_asc":return{sortKey:"createdAt",sortDir:"asc"};default:return{sortKey:"createdAt",sortDir:"desc"}}}),[R]),ze=e=>{const a=String(e||"").trim().toLowerCase();return a&&"all"!==a?"pdf"===a||"doc"===a?"document":"image"===a||"video"===a||"document"===a||"text"===a?a:"all":"all"},He=e=>{const a=String(e||"").trim().toLowerCase();return"image"===a?"Image":"video"===a?"Video":"document"===a?"Document":"location"===a?"Location":"Text"},Le=async function(){let{page:e=1,append:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Te)return;const s="all"===ze(B)&&("name_asc"===R||"name_desc"===R)&&!(C||"").trim().length,d=(C||"").trim(),i=ze(B),o=s?I:k,c={status:"APPROVED",q:d.length?d:void 0,media:"all"!==i?i:void 0,page:e,pageSize:o,sortKey:Ee.sortKey,sortDir:Ee.sortDir};a?O(!0):y(!0);try{var u;const d=++J.current,i=await r.default.get("templates/".concat(Pe),{params:c});if(null!==i&&void 0!==i&&null!==(u=i.data)&&void 0!==u&&u.success){const n=Array.isArray(i.data.templates)?i.data.templates:[];t((e=>a?[...e,...n]:n));const u=i.data.page||e,x=i.data.totalPages||0,p=i.data.totalCount||0;if(H(u),D(x),F(p),!a&&s&&x>1){O(!0);try{for(let e=2;e<=x;e++){var m;if(J.current!==d)break;const a=await r.default.get("templates/".concat(Pe),{params:(0,l.A)((0,l.A)({},c),{},{page:e,pageSize:o})});if(J.current!==d)break;const s=Array.isArray(null===a||void 0===a||null===(m=a.data)||void 0===m?void 0:m.templates)?a.data.templates:[];s.length&&t((e=>[...e,...s]))}}finally{J.current===d&&O(!1)}}}else{var x;a||t([]),n.oR.error((null===i||void 0===i||null===(x=i.data)||void 0===x?void 0:x.message)||"\u274c Failed to load templates.")}}catch(p){a||t([]),n.oR.error("\u274c Error loading templates.")}finally{a?O(!1):y(!1)}};(0,s.useEffect)((()=>{if(Te)return G.current&&clearTimeout(G.current),G.current=setTimeout((()=>{Le({page:1,append:!1})}),250),()=>{G.current&&clearTimeout(G.current)}}),[Pe,Te,C,B,R,Ee.sortKey,Ee.sortDir]),(0,s.useEffect)((()=>{if(!pe||!Te)return;if(ve.length>0)return;(async()=>{fe(!0);try{var e;const a=await r.default.get("campaign/list/".concat(Pe,"?onlyPublished=true")),t=(Array.isArray(null===(e=a.data)||void 0===e?void 0:e.items)?a.data.items:[]).map((e=>{var a,t,l,s;return{id:null!==(a=e.id)&&void 0!==a?a:e.Id,name:null!==(t=e.flowName)&&void 0!==t?t:e.FlowName,isPublished:null===(l=null!==(s=e.isPublished)&&void 0!==s?s:e.IsPublished)||void 0===l||l}})).filter((e=>e.id&&e.name));ge(t)}catch(a){n.oR.error("\u274c Error loading flows.")}finally{fe(!1)}})()}),[pe,Te,Pe]),(0,s.useEffect)((()=>{Te&&(async()=>{try{var e;const a=await r.default.get("WhatsAppSettings/senders/".concat(Pe)),t=(Array.isArray(a.data)?a.data:(null===(e=a.data)||void 0===e?void 0:e.items)||[]).map((e=>{var a,t,l,s,r,n,d,i,o,c;const u=String(e.provider||e.Provider||"").toUpperCase(),m=null!==(a=e.phoneNumberId)&&void 0!==a?a:e.PhoneNumberId,x=null!==(t=null!==(l=null!==(s=null!==(r=null!==(n=null!==(d=null!==(i=e.whatsAppBusinessNumber)&&void 0!==i?i:e.whatsappBusinessNumber)&&void 0!==d?d:e.displayNumber)&&void 0!==n?n:e.phoneNumber)&&void 0!==r?r:e.WhatsAppBusinessNumber)&&void 0!==s?s:e.PhoneNumber)&&void 0!==l?l:e.phoneNumberId)&&void 0!==t?t:e.PhoneNumberId;return{id:null!==(o=null!==(c=e.id)&&void 0!==c?c:e.Id)&&void 0!==o?o:"".concat(u,"|").concat(m),provider:u,phoneNumberId:m,whatsAppNumber:x}}));we(t),1===t.length&&Se(t[0].id)}catch(a){n.oR.error("\u274c Failed to load WhatsApp senders."),we([])}})()}),[Te,Pe]);const De=async e=>{const a="string"===typeof e?e:null===e||void 0===e?void 0:e.name,t="string"===typeof e?null:null===e||void 0===e?void 0:e.languageCode;if(!a)return Y(null),q(null),Q([]),ae([]),void le("");try{var l,s,d,i,o,c,u,m,x,p,h,v,g,b,f,j;const e=t&&String(t).trim().length?"?language=".concat(encodeURIComponent(String(t).trim())):"",w=await r.default.get("templates/".concat(Pe,"/").concat(encodeURIComponent(a)).concat(e)),C=(null===w||void 0===w||null===(l=w.data)||void 0===l?void 0:l.template)||(null===w||void 0===w?void 0:w.data)||null;if((null===C||void 0===C||!C.name)&&(null===C||void 0===C||!C.Name))return void n.oR.error("Could not load template details.");const S=null!==(s=null!==(d=null!==(i=C.buttonsJson)&&void 0!==i?i:C.buttons)&&void 0!==d?d:C.urlButtons)&&void 0!==s?s:null;let A=[];if(Array.isArray(S))A=S;else if("string"===typeof S&&S.trim().startsWith("["))try{A=JSON.parse(S)}catch(N){A=[]}const k=(e=>{const a=(e.headerKind||e.HeaderKind||"").toString().toLowerCase();return a===P.Image||a===P.Video||a===P.Document||a===P.Text||a===P.None?a:e.hasImageHeader||e.HasImageHeader?P.Image:P.None})(C),I=!0===C.requiresHeaderMediaUrl||!0===C.RequiresMediaHeader||T(k),M={name:null!==(o=C.name)&&void 0!==o?o:C.Name,language:null!==(c=null!==(u=null!==(m=null!==(x=C.language)&&void 0!==x?x:C.Language)&&void 0!==m?m:C.languageCode)&&void 0!==u?u:C.LanguageCode)&&void 0!==c?c:"en_US",body:null!==(p=null!==(h=C.body)&&void 0!==h?h:C.Body)&&void 0!==p?p:"",headerKind:k,requiresHeaderMediaUrl:I,hasImageHeader:null!==(v=null!==(g=C.hasImageHeader)&&void 0!==g?g:C.HasImageHeader)&&void 0!==v&&v,parametersCount:((null!==(b=null!==(f=C.body)&&void 0!==f?f:C.Body)&&void 0!==b?b:"").match(/{{[0-9]+}}/g)||[]).length,buttonParams:(y=A,Array.isArray(y)?y:[])};Y(M),Q(Array(M.parametersCount).fill(""));const U=(null===(j=M.buttonParams)||void 0===j?void 0:j.map((e=>{const a=(null===e||void 0===e?void 0:e.ParameterValue)||(null===e||void 0===e?void 0:e.parameterValue)||"",t=((null===e||void 0===e?void 0:e.SubType)||(null===e||void 0===e?void 0:e.subType)||"").toLowerCase();return["url","copy_code","flow"].includes(t)||a.includes("{{1}}")?"":null})))||[];ae(U),le("")}catch(w){n.oR.error("Error loading template details.")}var y};(0,s.useEffect)((()=>{if(Ue)try{if(!W)return void sessionStorage.removeItem(Ue);const e={name:W.name,languageCode:W.languageCode};sessionStorage.setItem(Ue,JSON.stringify(e))}catch(e){}}),[W,Ue]),(0,s.useEffect)((()=>{if(Te&&Ue&&!Z.current){Z.current=!0;try{const e=sessionStorage.getItem(Ue);if(!e)return;const a=JSON.parse(e),t=null===a||void 0===a?void 0:a.name,l=(null===a||void 0===a?void 0:a.languageCode)||"en_US";if(!t)return;const s={value:"".concat(t,"::").concat(l),label:t,name:t,languageCode:l};q(s),De({name:t,languageCode:l})}catch(e){}}}),[Te,Ue]);const _e=(0,s.useMemo)((()=>a.map((e=>{var a,t,l,s,r,n,d,i,o,c,u,m,x;const p=null!==(a=e.name)&&void 0!==a?a:e.Name,h=null!==(t=null!==(l=e.languageCode)&&void 0!==l?l:e.LanguageCode)&&void 0!==t?t:"en_US";if(!p)return null;const v=null!==(s=null!==(r=e.headerKind)&&void 0!==r?r:e.HeaderKind)&&void 0!==s?s:"none",g=null!==(n=null!==(d=e.createdAt)&&void 0!==d?d:e.CreatedAt)&&void 0!==n?n:null;return{value:"".concat(p,"::").concat(h),label:p,name:p,languageCode:h,category:null!==(i=null!==(o=e.category)&&void 0!==o?o:e.Category)&&void 0!==i?i:"",bodyVarCount:null!==(c=null!==(u=e.bodyVarCount)&&void 0!==u?u:e.BodyVarCount)&&void 0!==c?c:0,headerKind:v,media:He(v),createdAt:g,updatedAt:null!==(m=null!==(x=e.updatedAt)&&void 0!==x?x:e.UpdatedAt)&&void 0!==m?m:null}})).filter(Boolean)),[a]),Fe=(0,s.useMemo)((()=>{if(!W)return _e;const e=W.value,a=_e.filter((a=>(null===a||void 0===a?void 0:a.value)!==e));return[W,...a]}),[W,_e]),Ke="all"===ze(B)&&("name_asc"===R||"name_desc"===R)&&!(C||"").trim().length;return(0,d.jsxs)("div",{className:"min-h-screen bg-[#f5f6f7] pb-20",children:[(0,d.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 py-8",children:[(0,d.jsx)("div",{className:"mb-5 flex items-center justify-between",children:(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-emerald-600 shadow-sm shadow-emerald-200",children:(0,d.jsx)(m.A,{className:"h-5 w-5 text-white"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-xl font-bold text-slate-900",children:"New Campaign"}),(0,d.jsx)("p",{className:"text-xs text-slate-500",children:"Design and schedule your WhatsApp broadcast."})]})]})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-5 items-start",children:[(0,d.jsx)("div",{className:"lg:col-span-7 xl:col-span-8",children:(0,d.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:(0,d.jsxs)("div",{className:"p-5 space-y-5",children:[(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"block text-xs font-semibold text-slate-700 mb-1",children:["Campaign Name ",(0,d.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,d.jsx)("input",{type:"text",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none ring-offset-1 focus:ring-2 ".concat(ne?"border-red-300 focus:ring-red-200 bg-red-50":"border-slate-300 focus:border-emerald-500 focus:ring-emerald-100"),placeholder:"e.g. Diwali Sale",value:se,onChange:e=>{re(e.target.value),de("")},onBlur:()=>Be(se)}),ne&&(0,d.jsx)("p",{className:"mt-1 text-xs font-medium text-red-600",children:ne})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"block text-xs font-semibold text-slate-700 mb-1",children:["Sender (From) ",(0,d.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,d.jsxs)("select",{value:Ce,onChange:e=>Se(e.target.value),className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm outline-none ring-offset-1 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100",children:[(0,d.jsx)("option",{value:"",disabled:!0,children:"-- Select Number --"}),Ne.map((e=>(0,d.jsxs)("option",{value:e.id,children:[e.whatsAppNumber," (",e.provider,")"]},e.id)))]})]})]})}),(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsxs)("label",{className:"block text-xs font-semibold text-slate-700 mb-1",children:["Select Template ",(0,d.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)(u.Ay,{inputId:"approvedTemplateSelect",className:"react-select-container",classNamePrefix:"react-select",isClearable:!0,isLoading:j||K,options:Fe,value:W,getOptionValue:e=>e.value,getOptionLabel:e=>e.label,placeholder:"Search approved templates\u2026",menuPortalTarget:document.body,menuPosition:"fixed",menuPlacement:"auto",maxMenuHeight:320,noOptionsMessage:()=>j?"Loading\u2026":"No templates found. Try a different search.",onChange:e=>{q(e),De(e?{name:e.name,languageCode:e.languageCode}:null)},onInputChange:(e,a)=>{"input-change"===a.action&&U(e)},onMenuScrollToBottom:()=>{if(Ke)return;!(z<L)||K||j||Le({page:z+1,append:!0})},formatOptionLabel:(e,a)=>{let{context:t}=a;const l=(e=>{if(!e)return null;const a=new Date(e);if(Number.isNaN(a.getTime()))return null;try{return new Intl.DateTimeFormat(void 0,{month:"short",day:"2-digit",year:"numeric"}).format(a)}catch(t){return a.toISOString().slice(0,10)}})(e.createdAt),s=[e.languageCode?String(e.languageCode).toUpperCase():null,e.category?String(e.category).toUpperCase():null,e.media?String(e.media).toUpperCase():null,"number"===typeof e.bodyVarCount?"".concat(e.bodyVarCount," vars"):null,l?"Created ".concat(l):null].filter(Boolean).join(" \u2022 ");return"value"===t?(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"truncate",children:e.label}),e.languageCode?(0,d.jsxs)("span",{className:"text-xs text-slate-500",children:["(",String(e.languageCode).toUpperCase(),")"]}):null]}):(0,d.jsxs)("div",{className:"py-0.5",children:[(0,d.jsx)("div",{className:"text-sm font-medium",children:e.label}),s?(0,d.jsx)("div",{className:"text-[11px] leading-tight opacity-80",children:s}):null]})},styles:{control:(e,a)=>(0,l.A)((0,l.A)({},e),{},{minHeight:38,borderRadius:10,borderColor:a.isFocused?"#10b981":"#cbd5e1",boxShadow:a.isFocused?"0 0 0 4px rgba(16,185,129,0.12)":"none","&:hover":{borderColor:a.isFocused?"#10b981":"#cbd5e1"}}),valueContainer:e=>(0,l.A)((0,l.A)({},e),{},{padding:"0 10px"}),input:e=>(0,l.A)((0,l.A)({},e),{},{margin:0,padding:0}),indicatorsContainer:e=>(0,l.A)((0,l.A)({},e),{},{height:38}),placeholder:e=>(0,l.A)((0,l.A)({},e),{},{color:"#64748b"}),singleValue:e=>(0,l.A)((0,l.A)({},e),{},{color:"#0f172a"}),clearIndicator:e=>(0,l.A)((0,l.A)({},e),{},{color:"#64748b",":hover":{color:"#0f172a"}}),dropdownIndicator:e=>(0,l.A)((0,l.A)({},e),{},{color:"#64748b",":hover":{color:"#0f172a"}}),option:(e,a)=>(0,l.A)((0,l.A)({},e),{},{backgroundColor:a.isSelected?"#0f766e":a.isFocused?"rgba(16,185,129,0.10)":"white",color:a.isSelected?"white":"#0f172a",":active":(0,l.A)((0,l.A)({},e[":active"]),{},{backgroundColor:a.isSelected?"#115e59":"rgba(16,185,129,0.18)"})}),menu:e=>(0,l.A)((0,l.A)({},e),{},{zIndex:30}),menuPortal:e=>(0,l.A)((0,l.A)({},e),{},{zIndex:9999})}}),(0,d.jsx)("div",{className:"mt-1 text-[11px] text-slate-500",children:_?"Showing ".concat(Math.min(a.length,_)," of ").concat(_," approved templates."):"Type to search. Scroll to load more."})]}),(0,d.jsxs)("select",{value:R,onChange:e=>V(e.target.value),className:"h-[38px] w-[140px] rounded-lg border border-slate-200 bg-white px-2 text-xs text-slate-700 outline-none hover:bg-slate-50 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100",title:"Sort templates",children:[(0,d.jsx)("option",{value:"created_desc",children:"Newest"}),(0,d.jsx)("option",{value:"created_asc",children:"Oldest"}),(0,d.jsx)("option",{value:"name_asc",children:"Name A\u2013Z"}),(0,d.jsx)("option",{value:"name_desc",children:"Name Z\u2013A"})]}),(0,d.jsxs)("select",{value:B,onChange:e=>E(e.target.value),className:"h-[38px] w-[140px] rounded-lg border border-slate-200 bg-white px-2 text-xs text-slate-700 outline-none hover:bg-slate-50 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100",title:"Filter by media type",children:[(0,d.jsx)("option",{value:"all",children:"All Media"}),(0,d.jsx)("option",{value:"text",children:"Text"}),(0,d.jsx)("option",{value:"image",children:"Image"}),(0,d.jsx)("option",{value:"video",children:"Video"}),(0,d.jsx)("option",{value:"document",children:"Document (PDF)"})]}),(0,d.jsx)("button",{type:"button",onClick:async()=>{if(Te){w(!0);try{var e;const a=await r.default.post(A(Pe));null!==a&&void 0!==a&&null!==(e=a.data)&&void 0!==e&&e.success||200===(null===a||void 0===a?void 0:a.status)?(n.oR.success("Templates synced!"),await Le({page:1,append:!1})):n.oR.error("Sync failed.")}catch(a){n.oR.error("Error syncing templates.")}finally{w(!1)}}},disabled:N,className:"flex items-center justify-center h-[38px] w-[38px] rounded-lg border border-slate-200 bg-white text-slate-600 hover:bg-slate-50 hover:text-emerald-600 hover:border-emerald-200 transition-colors disabled:opacity-50",title:"Sync Templates from Meta",children:(0,d.jsx)(x.A,{className:"h-4 w-4 ".concat(N?"animate-spin":"")})})]})]}),X&&(0,d.jsx)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300 space-y-5",children:(0,d.jsxs)("div",{className:"rounded-lg bg-slate-50 border border-slate-200 p-4 space-y-3",children:[X.requiresHeaderMediaUrl&&(0,d.jsx)("div",{className:"space-y-4",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"block text-xs font-semibold text-slate-700 mb-1",children:[He(X.headerKind)," ",(0,d.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("input",{type:"text",className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500",placeholder:"Enter HTTPS URL or upload below...",value:te.startsWith("handle:")?"":te,onChange:e=>le(e.target.value),disabled:te.startsWith("handle:")}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,d.jsx)("span",{className:"w-full border-t border-slate-200"})}),(0,d.jsx)("div",{className:"relative flex justify-center text-[10px] uppercase",children:(0,d.jsx)("span",{className:"bg-white px-2 text-slate-400 font-medium tracking-wider",children:"Or Upload File"})})]}),(0,d.jsx)(S,{mediaType:X.headerKind.toUpperCase(),handle:te,onUploaded:e=>le(e)}),te.startsWith("handle:")&&(0,d.jsxs)("button",{type:"button",onClick:()=>le(""),className:"text-[10px] text-red-500 hover:text-red-700 font-medium flex items-center gap-1 mt-1",children:[(0,d.jsx)(p.A,{size:10}),"Remove uploaded media"]})]})]})}),(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)("div",{className:"flex h-5 items-center",children:(0,d.jsx)("input",{id:"useCsv",type:"checkbox",checked:Ae,onChange:e=>ke(e.target.checked),className:"h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500"})}),(0,d.jsxs)("div",{className:"text-sm",children:[(0,d.jsx)("label",{htmlFor:"useCsv",className:"font-medium text-slate-900",children:"Use CSV for personalization"}),(0,d.jsxs)("p",{className:"text-slate-500 text-xs text-slate-600",children:["If checked, you'll upload a CSV in the next step to fill ","{{}}"," variables."]})]})]}),Ae&&X&&(e=>{const a=X.parametersCount>0,t=(null===(e=X.buttonParams)||void 0===e?void 0:e.filter((e=>{const a=((null===e||void 0===e?void 0:e.type)||(null===e||void 0===e?void 0:e.Type)||"").toLowerCase(),t=(null===e||void 0===e?void 0:e.url)||(null===e||void 0===e?void 0:e.Url)||"";return["url","copy_code"].includes(a)||t.includes("{{1}}")})))||[];return a||0!==t.length?(0,d.jsx)("div",{className:"mt-2 rounded-md bg-blue-50 border border-blue-100 p-3",children:(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(h.A,{className:"h-4 w-4 text-blue-500 mt-0.5"}),(0,d.jsxs)("div",{className:"text-xs text-blue-700 space-y-2",children:[(0,d.jsx)("p",{className:"font-semibold",children:"Required CSV Columns for this template:"}),(0,d.jsxs)("div",{className:"space-y-3 mt-1",children:[a&&(0,d.jsxs)("div",{children:[(0,d.jsxs)("h4",{className:"font-bold text-blue-800 mb-1 flex items-center gap-1.5",children:[(0,d.jsx)("span",{className:"bg-blue-200 text-blue-800 w-4 h-4 rounded-full flex items-center justify-center text-[10px]",children:"1"}),"Message Body"]}),(0,d.jsxs)("div",{className:"ml-6 text-slate-700",children:["Requires columns for"," ",Array.from({length:X.parametersCount},((e,a)=>(0,d.jsxs)("code",{className:"bg-white border border-blue-200 px-1.5 py-0.5 rounded mx-0.5 font-mono text-blue-600 font-semibold",children:["{{",a+1,"}}"]},a)))]})]}),t.length>0&&(0,d.jsxs)("div",{children:[(0,d.jsxs)("h4",{className:"font-bold text-blue-800 mb-1 flex items-center gap-1.5",children:[(0,d.jsx)("span",{className:"bg-blue-200 text-blue-800 w-4 h-4 rounded-full flex items-center justify-center text-[10px]",children:a?"2":"1"}),"Buttons"]}),(0,d.jsx)("ul",{className:"ml-6 list-disc pl-4 space-y-1 text-slate-700",children:t.map(((e,a)=>{const t=(null===e||void 0===e?void 0:e.text)||(null===e||void 0===e?void 0:e.Text)||"Button",l=((null===e||void 0===e?void 0:e.type)||(null===e||void 0===e?void 0:e.Type)||"").toLowerCase();return(0,d.jsxs)("li",{children:[(0,d.jsx)("strong",{children:t}),": Requires value for"," ","url"===l&&(0,d.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"URL"}),"copy_code"===l&&(0,d.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"Coupon Code"})]},a)}))})]})]})]})]})}):null})(),!Ae&&$.length>0&&(0,d.jsx)("div",{className:"grid gap-3 pt-2",children:$.map(((e,a)=>(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:["Body Parameter ","{{",a+1,"}}"]}),(0,d.jsx)("input",{type:"text",className:"w-full rounded-md border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500",value:e,onChange:e=>{const t=[...$];t[a]=e.target.value,Q(t)},placeholder:"Value for {{".concat(a+1,"}}")})]},a)))})]})})]})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"mb-3 border-b border-slate-100 pb-2 mt-2"}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg border border-slate-100",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:"p-1.5 bg-white rounded-md shadow-sm border border-slate-200",children:(0,d.jsx)(v.A,{className:"h-4 w-4 text-amber-500"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"block text-sm font-semibold text-slate-700",children:"Attach Flow"}),(0,d.jsx)("span",{className:"text-xs text-slate-500 block",children:"Trigger automation when user replies"})]})]}),(0,d.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,d.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:pe,onChange:e=>{he(e.target.checked),e.target.checked||ye("")}}),(0,d.jsx)("div",{className:"w-9 h-5 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-emerald-600"})]})]}),pe&&(0,d.jsxs)("div",{className:"animate-in fade-in slide-in-from-top-1 duration-200",children:[(0,d.jsx)("label",{className:"block text-xs font-semibold text-slate-700 mb-1",children:"Select Flow"}),(0,d.jsxs)("select",{value:je,onChange:e=>ye(e.target.value),className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500",children:[(0,d.jsx)("option",{value:"",children:"-- Select Flow --"}),ve.map((e=>(0,d.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,d.jsx)("div",{className:"h-px bg-slate-100"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"mb-2",children:(0,d.jsx)("span",{className:"block text-sm font-semibold text-slate-700",children:"Schedule"})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,d.jsxs)("label",{className:"relative flex cursor-pointer rounded-lg border p-3 shadow-sm focus:outline-none transition-all ".concat("now"===Ie?"border-emerald-600 bg-emerald-50 ring-1 ring-emerald-600":"border-slate-200 bg-white hover:bg-slate-50"),children:[(0,d.jsx)("input",{type:"radio",name:"schedule",value:"now",className:"sr-only",checked:"now"===Ie,onChange:()=>Me("now")}),(0,d.jsx)("span",{className:"flex flex-1",children:(0,d.jsxs)("span",{className:"flex flex-col",children:[(0,d.jsx)("span",{className:"block text-sm font-medium text-slate-900",children:"Send Immediately"}),(0,d.jsx)("span",{className:"mt-0.5 flex items-center text-[11px] text-slate-500",children:"Run as soon as assigned."})]})}),(0,d.jsx)(g.A,{className:"h-4 w-4 ".concat("now"===Ie?"text-emerald-600":"text-slate-300")})]}),(0,d.jsxs)("label",{className:"relative flex cursor-pointer rounded-lg border p-3 shadow-sm focus:outline-none transition-all ".concat("later"===Ie?"border-emerald-600 bg-emerald-50 ring-1 ring-emerald-600":"border-slate-200 bg-white hover:bg-slate-50"),children:[(0,d.jsx)("input",{type:"radio",name:"schedule",value:"later",className:"sr-only",checked:"later"===Ie,onChange:()=>Me("later")}),(0,d.jsx)("span",{className:"flex flex-1",children:(0,d.jsxs)("span",{className:"flex flex-col",children:[(0,d.jsx)("span",{className:"block text-sm font-medium text-slate-900",children:"Schedule for Later"}),(0,d.jsx)("span",{className:"mt-0.5 flex items-center text-[11px] text-slate-500",children:"Pick a date and time."})]})}),(0,d.jsx)(b.A,{className:"h-4 w-4 ".concat("later"===Ie?"text-emerald-600":"text-slate-300")})]})]}),"later"===Ie&&(0,d.jsx)("div",{className:"mt-3 animate-in fade-in slide-in-from-top-1",children:(0,d.jsx)("input",{type:"datetime-local",className:"block w-full rounded-md border border-slate-300 py-2 px-3 text-sm focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500",value:ce,onChange:e=>ue(e.target.value),min:(new Date).toISOString().slice(0,16)})})]})]})]})]})})}),(0,d.jsx)("div",{className:"lg:col-span-5 xl:col-span-4 sticky top-6",children:(0,d.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:[(0,d.jsxs)("div",{className:"border-b border-slate-100 bg-slate-50/50 px-4 py-3 flex items-center justify-between",children:[(0,d.jsx)("h3",{className:"text-xs font-bold uppercase tracking-wide text-slate-500",children:"Preview"}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-slate-400",children:[(0,d.jsx)(f,{className:"h-3.5 w-3.5"}),(0,d.jsx)("span",{children:"Mobile View"})]})]}),(0,d.jsx)("div",{className:"p-4 bg-slate-100 min-h-[500px] flex items-center justify-center",children:X?(0,d.jsx)("div",{className:"scale-[0.85] origin-top",children:(0,d.jsx)(i,{templateBody:X.body||"",imageUrl:te,parameters:$,buttonParams:X.buttonParams})}):(0,d.jsxs)("div",{className:"text-center text-slate-400",children:[(0,d.jsx)("div",{className:"mx-auto h-16 w-16 rounded-full bg-slate-200 flex items-center justify-center mb-4",children:(0,d.jsx)(m.A,{className:"h-8 w-8 text-slate-400"})}),(0,d.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"No Template Selected"}),(0,d.jsx)("p",{className:"text-xs mt-1",children:"Choose a template from the left to see a preview."})]})})]})})]})]}),(0,d.jsx)("div",{className:"fixed bottom-0 left-0 right-0 border-t border-slate-200 bg-white p-4 shadow-lg z-10",children:(0,d.jsxs)("div",{className:"mx-auto max-w-7xl flex items-center justify-between px-4 sm:px-6",children:[(0,d.jsx)("div",{className:"text-sm text-slate-500",children:"later"===Ie&&ce?(0,d.jsxs)("span",{children:["Scheduled for: ",(0,d.jsx)("strong",{children:new Date(ce).toLocaleString()})]}):null}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)("button",{onClick:()=>Ve(-1),className:"px-5 py-2.5 rounded-lg border border-slate-300 text-sm font-semibold text-slate-700 hover:bg-slate-50 transition-colors",children:"Cancel"}),(0,d.jsx)("button",{onClick:async()=>{var e;if(!Te)return;if(!se||!X)return void n.oR.warn("Please fill campaign name and choose a template.");if(ie)return;if(ne)return void n.oR.warn("Please fix the campaign name.");if(!Ae&&$.some((e=>""===e)))return void n.oR.warn("Please fill all template parameters or enable CSV.");if(pe&&!je)return void n.oR.warn("Please select a flow or disable Flow Integration.");const a=Ne.find((e=>e.id===Ce));if(!a||!a.phoneNumberId)return void n.oR.warn("Please choose a Sender (number).");const t=(null===X||void 0===X?void 0:X.headerKind)||P.None;if(T(t)&&!te)return void n.oR.warn("Please provide a ".concat(He(t),"."));xe(!0);const l=(null===(e=X.buttonParams)||void 0===e?void 0:e.map(((e,a)=>{const t=(null===e||void 0===e?void 0:e.ParameterValue)||(null===e||void 0===e?void 0:e.parameterValue)||"",l=((null===e||void 0===e?void 0:e.SubType)||(null===e||void 0===e?void 0:e.subType)||"").toLowerCase(),s=["url","copy_code","flow"].includes(l)||t.includes("{{1}}");return{text:(null===e||void 0===e?void 0:e.Text)||(null===e||void 0===e?void 0:e.text)||"Button",type:(null===e||void 0===e?void 0:e.Type)||(null===e||void 0===e?void 0:e.type)||"",value:s?Ae?"":ee[a]||"":t,position:a+1}})))||[],s=t===P.Image?"image":t===P.Video?"video":"text",d="later"===Ie&&ce?new Date(ce).toISOString():null,i={name:se,messageTemplate:(X.body||"").trim(),templateId:X.name,templateLanguage:X.language||void 0,buttonParams:l,campaignType:s,imageUrl:t===P.Image?te:null,videoUrl:t===P.Video?te:null,documentUrl:t===P.Document?te:null,headerMediaUrl:T(t)?te:null,headerKind:t,scheduledAt:d,createdBy:Re,businessId:Pe,templateParameters:Ae?[]:$,useCsvPersonalization:Ae,ctaFlowConfigId:pe?je:null,provider:String(a.provider||"").toUpperCase(),phoneNumberId:a.phoneNumberId};try{var o,c;if(await Be(se),ne)return void xe(!1);const e=await r.default.post("campaign/create-text-campaign",i);null!==(o=e.data)&&void 0!==o&&o.success&&null!==(c=e.data)&&void 0!==c&&c.campaignId?(n.oR.success("Campaign created successfully."),Ve("/app/campaigns/image-campaigns/assign-contacts/".concat(e.data.campaignId))):n.oR.error("Failed to create campaign.")}catch(x){var u,m;n.oR.error((null===x||void 0===x||null===(u=x.response)||void 0===u||null===(m=u.data)||void 0===m?void 0:m.message)||"Failed to create campaign.")}finally{xe(!1)}},disabled:me,className:"px-8 py-2.5 rounded-lg bg-emerald-600 text-sm font-semibold text-white shadow-sm shadow-emerald-200 hover:bg-emerald-700 hover:shadow-emerald-300 transition-all disabled:opacity-70 disabled:cursor-not-allowed",children:me?"Creating...":"Create Campaign"})]})]})})]})}}}]);
//# sourceMappingURL=549.e23beeb9.chunk.js.map