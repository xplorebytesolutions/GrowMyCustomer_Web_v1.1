"use strict";(self.webpackChunkxbytechat_ui=self.webpackChunkxbytechat_ui||[]).push([[394],{2394:(e,s,a)=>{a.r(s),a.d(s,{default:()=>w});var t=a(89379),r=a(35746),n=a(41680),o=a(27033),i=a(37719),l=a(75686),d=a(81007),c=a(63961),m=a(5244),g=a(73216),p=a(65043),x=a(8927),h=a(65086),u=a(74961),f=a(63610),b=a(50480),y=a(70579);const v={"send-direct-text":[u.FK.MESSAGING_SEND_TEXT],"send-template-message":[u.FK.MESSAGING_SEND_TEMPLATE],"view-messaging-reports":[u.FK.MESSAGING_REPORT_VIEW]},j=[{id:"send-direct-text",label:"Send Non-Template Message",description:"Send non-template messages to one or multiple contacts.",path:"/app/messaging/send-direct-text",icon:(0,y.jsx)(r.A,{size:22}),action:"Send Non-Template"},{id:"send-template-message",label:"Send Template Message",description:"Use approved WhatsApp templates for consistent, scalable messaging.",path:"/app/messaging/send-template-message",icon:(0,y.jsx)(n.A,{size:22}),action:"Coming Soon"},{id:"view-messaging-reports",label:"Messaging Reports & Analytics",description:"Track delivery, reads, and performance of your WhatsApp campaigns.",path:"/app/messaging/reports",icon:(0,y.jsx)(o.A,{size:22}),action:"Coming Soon"}];function N(){var e;const s=(0,b.ag)("MESSAGES_PER_MONTH");if(!s)return null;const a=(s.quotaKey||s.QuotaKey||s.key||s.Key||"MESSAGES_PER_MONTH")+"",t=(s.period||s.Period||"Monthly"||"Monthly").toLowerCase(),r="number"===typeof s.consumed?s.consumed:"number"===typeof s.Consumed?s.Consumed:0,n="number"===typeof s.limit?s.limit:"number"===typeof s.Limit?s.Limit:null,o="number"===typeof s.remaining?s.remaining:"number"===typeof s.Remaining?s.Remaining:null;let i=null;n&&n>0&&(i=Math.min(100,Math.round(r/n*100)));const l=null!=n,d=!(!l||null==o)&&o<=Math.max(100,.1*n);return(0,y.jsxs)("div",{className:"mb-4 rounded-xl border border-emerald-100 bg-emerald-50 p-4 flex items-center justify-between gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:"text-sm font-semibold text-emerald-800",children:["Messages \u2013 current ",t]}),l?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"text-sm text-emerald-900 mt-1",children:[(0,y.jsx)("span",{className:"font-semibold",children:r.toLocaleString("en-IN")})," ","used"," ",(0,y.jsxs)("span",{className:"text-xs text-emerald-700",children:["/ ",n.toLocaleString("en-IN")," total"]})]}),(0,y.jsxs)("div",{className:"mt-2",children:[(0,y.jsx)("div",{className:"h-2 w-full rounded-full bg-emerald-100 overflow-hidden",children:(0,y.jsx)("div",{className:"h-2 bg-emerald-600",style:{width:"".concat(null!==(e=i)&&void 0!==e?e:0,"%")}})}),null!=o&&(0,y.jsxs)("div",{className:"mt-1 text-[11px] text-emerald-700",children:[o.toLocaleString("en-IN")," messages remaining this"," ",t,"."]})]})]}):(0,y.jsxs)("div",{className:"text-xs text-emerald-700 mt-1",children:["Your current plan has"," ",(0,y.jsx)("span",{className:"font-semibold",children:"no hard message limit"}),"."]})]}),l&&d&&(0,y.jsx)("button",{type:"button",className:"text-xs px-3 py-2 rounded-lg bg-white border border-emerald-300 text-emerald-800 shadow-sm hover:bg-emerald-50",onClick:()=>(0,f.Y)({reason:"quota",quotaKey:a.toUpperCase(),source:"messaging.workspace.quota_banner"}),children:"Upgrade plan"})]})}function w(){const e=(0,g.Zp)(),s=(0,g.zy)(),{isLoading:a,can:r,hasAllAccess:n,entLoading:o}=(0,h.h)(),u="1"===new URLSearchParams(s.search||"").get("flyout"),[b,w]=(0,p.useState)(JSON.parse(localStorage.getItem("messaging-pinned")||"[]")),[S,A]=(0,p.useState)(JSON.parse(localStorage.getItem("messaging-archived")||"[]")),[k,C]=(0,p.useState)(JSON.parse(localStorage.getItem("messaging-order"))||j.map((e=>e.id))),E=k.map((e=>j.find((s=>s.id===e)))).filter(Boolean).filter((e=>!S.includes(e.id))).map((e=>{const s=v[e.id]||[],a=n||Array.isArray(s)&&s.some((e=>r(e)));return(0,t.A)((0,t.A)({},e),{},{allowed:a,primaryCode:s[0]||null})}));if(a||o)return(0,y.jsx)("div",{className:"p-10 text-center text-lg text-gray-500",children:"Loading messaging features\u2026"});const M=E.length>0,I=E.some((e=>e.allowed));return u?(0,y.jsx)("div",{className:"p-6 bg-[#f5f6f7] min-h-[calc(100vh-80px)]","data-test-id":"messaging-root"}):(0,y.jsxs)("div",{className:"p-6 bg-[#f5f6f7] min-h-[calc(100vh-80px)]","data-test-id":"messaging-root",children:[(0,y.jsx)("style",{children:"\n        @keyframes drawRight { from { transform: scaleX(0) } to { transform: scaleX(1) } }\n        @keyframes drawDown  { from { transform: scaleY(0) } to { transform: scaleY(1) } }\n        @keyframes drawLeft  { from { transform: scaleX(0) } to { transform: scaleX(1) } }\n        @keyframes drawUp    { from { transform: scaleY(0) } to { transform: scaleY(1) } }\n\n        .tile:hover .topline    { animation: drawRight .9s ease forwards; }\n        .tile:hover .rightline  { animation: drawDown  .9s ease .18s forwards; }\n        .tile:hover .bottomline { animation: drawLeft  .9s ease .36s forwards; }\n        .tile:hover .leftline   { animation: drawUp    .9s ease .54s forwards; }\n      "}),(0,y.jsx)("h2",{className:"text-2xl font-bold text-emerald-800 mb-1",children:"\ud83d\udcac Messaging Workspace"}),(0,y.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Send one-off and template messages, and analyse messaging performance."}),(0,y.jsx)(N,{}),M&&!I&&(0,y.jsxs)("div",{className:"bg-amber-50 text-amber-800 p-4 border-l-4 border-amber-500 rounded-md mb-6 shadow-sm flex items-start gap-3",children:[(0,y.jsx)(i.A,{size:22,className:"mt-1"}),(0,y.jsxs)("div",{children:[(0,y.jsx)("strong",{children:"Locked messaging tools:"})," Your current plan doesn't include these messaging features.",(0,y.jsx)("div",{className:"text-sm mt-1 text-gray-600",children:"Try opening a tile to see upgrade options, or contact your administrator."})]})]}),M&&(0,y.jsx)(x.JY,{onDragEnd:e=>{if(!e.destination)return;const s=Array.from(k),[a]=s.splice(e.source.index,1);s.splice(e.destination.index,0,a),C(s),localStorage.setItem("messaging-order",JSON.stringify(s))},children:(0,y.jsx)(x.gL,{droppableId:"messaging-blocks",direction:"horizontal",children:s=>(0,y.jsxs)("div",(0,t.A)((0,t.A)({className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",ref:s.innerRef},s.droppableProps),{},{children:[E.map(((s,a)=>{const r="tile group relative overflow-hidden rounded-md border bg-white shadow-sm transition transform hover:-translate-y-0.5 hover:shadow-md duration-200 focus:outline-none focus:ring-2 focus:ring-emerald-300 cursor-pointer",n=s.allowed?r:"".concat(r," ").concat("opacity-70 border-dashed cursor-not-allowed hover:-translate-y-0 hover:shadow-sm"),o=()=>{s.allowed?e(s.path):s.primaryCode&&(0,f.Y)({reason:"feature",code:s.primaryCode,source:"messaging.workspace.tile"})},i=a=>{a.stopPropagation(),s.allowed?e(s.path):s.primaryCode&&(0,f.Y)({reason:"feature",code:s.primaryCode,source:"messaging.workspace.action"})};return(0,y.jsx)(x.sx,{draggableId:s.id,index:a,children:e=>(0,y.jsxs)("div",(0,t.A)((0,t.A)({ref:e.innerRef},e.draggableProps),{},{role:"button",tabIndex:0,"aria-label":"".concat(s.label,": ").concat(s.action),onKeyDown:e=>{"Enter"===e.key&&o()},onClick:o,className:n,style:{userSelect:"none"},children:[!s.allowed&&(0,y.jsx)("span",{className:"pointer-events-none absolute top-3 right-3 inline-flex items-center gap-1 rounded-full border border-dashed border-amber-500 bg-amber-50 px-2 py-0.5 text-[11px] font-semibold text-amber-700",children:"\ud83d\udd12 Upgrade"}),(0,y.jsx)("span",{"aria-hidden":!0,className:"topline pointer-events-none absolute left-0 -top-[2px] h-[2px] w-full origin-left rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(90deg, #A7F3D0, #34D399, #059669)",transform:"scaleX(0)"}}),(0,y.jsx)("span",{"aria-hidden":!0,className:"rightline pointer-events-none absolute right-0 -top-[2px] h-[calc(100%+4px)] w-[2px] origin-top rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(180deg, #A7F3D0, #34D399, #059669)",transform:"scaleY(0)"}}),(0,y.jsx)("span",{"aria-hidden":!0,className:"bottomline pointer-events-none absolute left-0 -bottom-[2px] h-[2px] w-full origin-right rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(270deg, #A7F3D0, #34D399, #059669)",transform:"scaleX(0)"}}),(0,y.jsx)("span",{"aria-hidden":!0,className:"leftline pointer-events-none absolute left-0 -top-[2px] h-[calc(100%+4px)] w-[2px] origin-bottom rounded opacity-0 group-hover:opacity-100",style:{background:"linear-gradient(0deg, #A7F3D0, #34D399, #059669)",transform:"scaleY(0)"}}),(0,y.jsxs)("div",{className:"flex items-start gap-4 p-5",children:[(0,y.jsx)("div",{className:"bg-emerald-50 rounded-md p-2 text-emerald-800",children:s.icon}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("h3",{className:"text-md font-semibold text-emerald-800 group-hover:text-emerald-900",children:s.label}),(0,y.jsx)("p",{className:"text-sm text-slate-600 workspace-tile-desc",children:s.description})]}),(0,y.jsx)("div",(0,t.A)((0,t.A)({},e.dragHandleProps),{},{title:"Drag to re-order",className:"ml-2 rounded p-1 text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",onClick:e=>e.stopPropagation(),children:(0,y.jsx)(l.A,{size:16})}))]}),(0,y.jsxs)("div",{className:"px-5 py-3 border-t border-gray-200 flex items-center justify-between bg-gray-50",children:[(0,y.jsxs)("button",{onClick:i,className:"text-sm text-gray-700 font-medium flex items-center gap-1 hover:text-gray-900",children:[s.allowed?s.action:"Upgrade to unlock",(0,y.jsx)(d.A,{size:18})]}),(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("button",{onClick:e=>((e,s)=>{e.stopPropagation();const a=b.includes(s)?b.filter((e=>e!==s)):[...b,s];w(a),localStorage.setItem("messaging-pinned",JSON.stringify(a))})(e,s.id),title:b.includes(s.id)?"Unpin":"Pin",children:(0,y.jsx)(c.A,{size:18,className:b.includes(s.id)?"text-red-600":"text-gray-400 hover:text-red-500"})}),(0,y.jsx)("button",{onClick:e=>((e,s)=>{e.stopPropagation();const a=S.includes(s)?S.filter((e=>e!==s)):[...S,s];A(a),localStorage.setItem("messaging-archived",JSON.stringify(a))})(e,s.id),title:"Archive this",children:(0,y.jsx)(m.A,{size:18,className:S.includes(s.id)?"text-indigo-600":"text-gray-400 hover:text-indigo-500"})})]})]})]}))},s.id)})),s.placeholder]}))})}),!M&&(0,y.jsxs)("div",{className:"bg-red-100 text-red-700 p-4 border-l-4 border-red-500 rounded-md mt-4 shadow-sm flex items-start gap-3",children:[(0,y.jsx)(i.A,{size:22,className:"mt-1"}),(0,y.jsxs)("div",{children:[(0,y.jsx)("strong",{children:"No messaging tiles:"})," All messaging tools are archived or hidden.",(0,y.jsx)("div",{className:"text-sm mt-1 text-gray-600",children:"Un-archive some tiles to see them here."})]})]})]})}}}]);
//# sourceMappingURL=394.e2857bc3.chunk.js.map